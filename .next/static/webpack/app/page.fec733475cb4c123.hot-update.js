"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./components/ai-chat/index.tsx":
/*!**************************************!*\
  !*** ./components/ai-chat/index.tsx ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ AIChat; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_ui_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/components/ui/button */ \"(app-pages-browser)/./components/ui/button.tsx\");\n/* harmony import */ var _components_ui_input__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/ui/input */ \"(app-pages-browser)/./components/ui/input.tsx\");\n/* harmony import */ var _components_ui_scroll_area__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/components/ui/scroll-area */ \"(app-pages-browser)/./components/ui/scroll-area.tsx\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/sparkles.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/refresh-cw.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/x.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/image.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/loader-circle.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/send.js\");\n/* harmony import */ var _features_editor_store_use_data_state__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/features/editor/store/use-data-state */ \"(app-pages-browser)/./features/editor/store/use-data-state.ts\");\n/* harmony import */ var _features_editor_hooks_state_manager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @/features/editor/hooks/state-manager */ \"(app-pages-browser)/./features/editor/hooks/state-manager.tsx\");\n/* harmony import */ var _ai_video_commands__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ai-video-commands */ \"(app-pages-browser)/./components/ai-chat/ai-video-commands.ts\");\n/* harmony import */ var _utils_upload__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @/utils/upload */ \"(app-pages-browser)/./utils/upload.ts\");\n/* harmony import */ var _features_editor_services_command_executor_service__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @/features/editor/services/command-executor-service */ \"(app-pages-browser)/./features/editor/services/command-executor-service.ts\");\n/* harmony import */ var _features_editor_store_use_store__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @/features/editor/store/use-store */ \"(app-pages-browser)/./features/editor/store/use-store.ts\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$(), _s1 = $RefreshSig$();\n\n\n\n\n\n\n\n\n\n\n\n// Función para extraer tiempos de inicio y fin de una imagen a partir del mensaje\nfunction extractImageTimesFromMessage(messageContent) {\n    let startTime = 0;\n    let endTime = 5;\n    if (!messageContent) return {\n        startTime,\n        endTime\n    };\n    // Buscar referencias al tiempo inicial\n    const startTimePatterns = [\n        /en el segundo (\\d+)/i,\n        /desde el segundo (\\d+)/i,\n        /a partir del segundo (\\d+)/i,\n        /comenzando en el segundo (\\d+)/i,\n        /desde el minuto (\\d+)/i,\n        /en el minuto (\\d+)/i,\n        /entre los segundos (\\d+) y/i,\n        /del segundo (\\d+) al/i,\n        /empezando en (\\d+)/i,\n        /segundo (\\d+)/i,\n        /en (\\d+) segundos/i,\n        /en el (\\d+)/i\n    ];\n    // Buscar referencias al tiempo final\n    const endTimePatterns = [\n        /hasta el segundo (\\d+)/i,\n        /al segundo (\\d+)/i,\n        /terminando en el segundo (\\d+)/i,\n        /hasta el minuto (\\d+)/i,\n        /entre los segundos \\d+ y (\\d+)/i,\n        /del segundo \\d+ al (\\d+)/i,\n        /por (\\d+) segundos/i,\n        /durante (\\d+) segundos/i\n    ];\n    // Buscar palabras clave especiales\n    const isAtStart = /\\b(al inicio|al principio|al comienzo)\\b/i.test(messageContent);\n    const isAtEnd = /\\b(al final|al término|al acabar)\\b/i.test(messageContent);\n    // Procesar patrones de tiempo inicial\n    for (const pattern of startTimePatterns){\n        const match = messageContent.match(pattern);\n        if (match && match[1]) {\n            // Si es referencia a minutos, convertir a segundos\n            startTime = pattern.toString().includes(\"minuto\") ? parseInt(match[1]) * 60 : parseInt(match[1]);\n            break;\n        }\n    }\n    // Procesar patrones de tiempo final\n    for (const pattern of endTimePatterns){\n        const match = messageContent.match(pattern);\n        if (match && match[1]) {\n            if (pattern.toString().includes(\"por\") || pattern.toString().includes(\"durante\")) {\n                // Es una duración relativa, sumar al tiempo inicial\n                endTime = startTime + parseInt(match[1]);\n            } else {\n                // Es un tiempo absoluto\n                endTime = pattern.toString().includes(\"minuto\") ? parseInt(match[1]) * 60 : parseInt(match[1]);\n            }\n            break;\n        }\n    }\n    // Si se menciona \"al inicio\", establecer tiempo a 0\n    if (isAtStart) {\n        startTime = 0;\n        endTime = 5; // Por defecto 5 segundos de duración\n    }\n    // Si se menciona \"al final\", establecer valores relativos al final\n    // Nota: El valor real se ajustará en el cliente según la duración\n    if (isAtEnd) {\n        startTime = -1; // Código especial para \"final - 5 segundos\"\n        endTime = -1; // Código especial para \"final\"\n    }\n    // Si no se detectó tiempo final pero sí inicial, establecer una duración predeterminada\n    if (startTime > 0 && endTime === 5 && startTime !== 0) {\n        endTime = startTime + 5;\n    }\n    return {\n        startTime,\n        endTime\n    };\n}\n// Componente para renderizar opciones de música como botones clickables\nconst MusicOptions = (param)=>{\n    let { options, onSelectMusic } = param;\n    if (!Array.isArray(options) || options.length === 0) {\n        return null;\n    }\n    // Función para convertir el nombre del archivo a un nombre amigable\n    const getFriendlyName = (musicPath)=>{\n        const filename = musicPath.split(\"/\").pop() || musicPath;\n        // Mapear nombres de archivos a nombres amigables\n        if (filename === \"song1.mp3\") return \"M\\xfasica Energ\\xe9tica\";\n        if (filename === \"song2.mp3\") return \"Melod\\xeda Relajante\";\n        // Si no hay mapeo específico, devolver el nombre del archivo\n        return filename;\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex flex-col gap-3 mt-3\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"flex flex-wrap gap-2\",\n            children: options.map((musicPath, index)=>{\n                const musicName = getFriendlyName(musicPath);\n                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                    onClick: ()=>onSelectMusic(musicPath),\n                    className: \"px-4 py-2 text-sm bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white rounded-lg transition-all shadow-md hover:shadow-lg flex items-center gap-2 font-medium\",\n                    children: [\n                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                            xmlns: \"http://www.w3.org/2000/svg\",\n                            viewBox: \"0 0 24 24\",\n                            fill: \"currentColor\",\n                            className: \"w-5 h-5\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"path\", {\n                                d: \"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 9l12-3\",\n                                strokeWidth: \"2\",\n                                stroke: \"currentColor\",\n                                fill: \"none\",\n                                strokeLinecap: \"round\",\n                                strokeLinejoin: \"round\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 145,\n                                columnNumber: 17\n                            }, undefined)\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 144,\n                            columnNumber: 15\n                        }, undefined),\n                        musicName\n                    ]\n                }, index, true, {\n                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                    lineNumber: 139,\n                    columnNumber: 13\n                }, undefined);\n            })\n        }, void 0, false, {\n            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n            lineNumber: 135,\n            columnNumber: 7\n        }, undefined)\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n        lineNumber: 134,\n        columnNumber: 5\n    }, undefined);\n};\n_c = MusicOptions;\n// Función para procesar elementos detectados por la IA\nconst processDetectedElement = async (elementData, commandExecutor, finalResponseRef, timeline, lastUploadedImageUrl, currentImageUrlForThisRequest)=>{\n    let elementAdded = false;\n    let finalResponse = finalResponseRef.current;\n    try {\n        // Si se detectó un elemento para agregar con confianza suficiente\n        if (elementData && elementData.detected === true && typeof elementData.confidence === \"number\" && elementData.confidence > 0.7 && elementData.element) {\n            const element = elementData.element;\n            // Procesar según el tipo de elemento\n            if (element.type === \"text\" && element.content) {\n                // Configurar opciones para el texto\n                const textOptions = {\n                    startTime: typeof element.startTime === \"number\" ? element.startTime : 0,\n                    endTime: typeof element.endTime === \"number\" ? element.endTime : typeof element.startTime === \"number\" ? element.startTime + 5 : 5\n                };\n                // Asignar color si está disponible\n                if (element.color) {\n                    textOptions.color = element.color.toLowerCase() === \"blanco\" ? \"#FFFFFF\" : element.color.toLowerCase() === \"negro\" ? \"#000000\" : element.color.toLowerCase() === \"rojo\" ? \"#FF0000\" : element.color.toLowerCase() === \"azul\" ? \"#0000FF\" : element.color.toLowerCase() === \"verde\" ? \"#00FF00\" : element.color.toLowerCase() === \"amarillo\" ? \"#FFFF00\" : element.color;\n                }\n                // Añadir el texto\n                commandExecutor.current.addText(element.content, textOptions);\n                // Actualizar respuesta\n                finalResponse += '\\n\\n[He agregado el texto \"'.concat(element.content, '\" ').concat(element.color ? \"con color \".concat(element.color, \" \") : \"\", \"desde el segundo \").concat(textOptions.startTime, \" hasta el segundo \").concat(textOptions.endTime, \"]\");\n                elementAdded = true;\n            } else if (element.type === \"image\") {\n                // Configurar opciones para la imagen\n                const imageOptions = {\n                    startTime: typeof element.startTime === \"number\" ? element.startTime : 0,\n                    endTime: typeof element.endTime === \"number\" ? element.endTime : typeof element.startTime === \"number\" ? element.startTime + 5 : 5,\n                    // Posición centrada por defecto\n                    position: {\n                        x: 0.5,\n                        y: 0.5\n                    }\n                };\n                // Registrar tiempos específicos para depuración\n                console.log(\"Tiempos de imagen recibidos de la API: startTime=\".concat(element.startTime, \", endTime=\").concat(element.endTime));\n                // Manejar casos especiales para \"al final\" del video\n                if (element.startTime === -1 || element.endTime === -1) {\n                    // Calcular la duración del video en segundos\n                    const videoDuration = (timeline === null || timeline === void 0 ? void 0 : timeline.duration) ? Math.floor(timeline.duration / 1000) : 30; // Valor predeterminado si no hay duración\n                    console.log(\"Duraci\\xf3n del video: \".concat(videoDuration, \"s\"));\n                    if (element.startTime === -1 && element.endTime === -1) {\n                        // Si ambos son -1, colocar en los últimos 5 segundos\n                        imageOptions.startTime = Math.max(0, videoDuration - 5);\n                        imageOptions.endTime = videoDuration;\n                        console.log('Ajustando para \"al final\": startTime='.concat(imageOptions.startTime, \", endTime=\").concat(imageOptions.endTime));\n                    } else if (element.startTime === -1) {\n                        // Solo startTime es -1\n                        imageOptions.startTime = Math.max(0, videoDuration - 5);\n                    } else if (element.endTime === -1) {\n                        // Solo endTime es -1\n                        imageOptions.endTime = videoDuration;\n                    }\n                }\n                console.log(\"Tiempos de imagen a aplicar: startTime=\".concat(imageOptions.startTime, \", endTime=\").concat(imageOptions.endTime));\n                // Determinar la URL de la imagen a usar\n                const isGenericUrl = element.url === \"imagen_adjunta_por_el_usuario.jpg\";\n                const isLocalImage = lastUploadedImageUrl && lastUploadedImageUrl.startsWith(\"data:\");\n                let imageUrl;\n                // PRIORIDAD 1: Usar la imagen que acaba de subirse en este mensaje específico\n                if (currentImageUrlForThisRequest) {\n                    imageUrl = currentImageUrlForThisRequest;\n                    console.log(\"Usando la imagen reci\\xe9n subida para esta solicitud espec\\xedfica\");\n                } else if (element.url && !isGenericUrl && !element.url.includes(\"/url_de_la_imagen\")) {\n                    imageUrl = element.url;\n                    console.log(\"Usando URL espec\\xedfica del elemento\");\n                } else if (isGenericUrl && lastUploadedImageUrl) {\n                    imageUrl = lastUploadedImageUrl;\n                    console.log(\"Usando la \\xfaltima imagen subida guardada\");\n                } else {\n                    // Si todo lo demás falla, usar una imagen de ejemplo\n                    imageUrl = \"https://ik.imagekit.io/wombo/images/img2.jpg\";\n                    console.log(\"Usando imagen de ejemplo como fallback\");\n                }\n                // Añadir la imagen\n                commandExecutor.current.addImage(imageUrl, imageOptions);\n                // Actualizar respuesta\n                finalResponse += \"\\n\\n[He agregado la imagen desde el segundo \".concat(imageOptions.startTime, \" hasta el segundo \").concat(imageOptions.endTime, \"]\");\n                elementAdded = true;\n            } else if (element.type === \"video\") {\n                // Configurar opciones para el video\n                const videoOptions = {\n                    startTime: typeof element.startTime === \"number\" ? element.startTime : 0,\n                    endTime: typeof element.endTime === \"number\" ? element.endTime : typeof element.startTime === \"number\" ? element.startTime + 10 : 10\n                };\n                // URL de video de ejemplo (en producción esto sería dinámico)\n                const videoUrl = \"https://cdn.designcombo.dev/videos/demo-video-4.mp4\";\n                // Añadir el video\n                commandExecutor.current.addVideo(videoUrl, videoOptions);\n                // Actualizar respuesta\n                finalResponse += \"\\n\\n[He agregado el video desde el segundo \".concat(videoOptions.startTime, \" hasta el segundo \").concat(videoOptions.endTime, \"]\");\n                elementAdded = true;\n            } else if (element.type === \"subtitles\") {\n                // Configurar opciones para los subtítulos\n                const subtitleOptions = {\n                    groupWords: element.groupWords !== undefined ? element.groupWords : true\n                };\n                // Añadir tiempos si se especificaron\n                if (typeof element.startTime === \"number\") {\n                    subtitleOptions.startTime = element.startTime;\n                }\n                if (typeof element.endTime === \"number\") {\n                    subtitleOptions.endTime = element.endTime;\n                }\n                // Añadir los subtítulos\n                commandExecutor.current.addSubtitles(subtitleOptions);\n                // Actualizar respuesta silenciosa (se maneja en otro lado)\n                elementAdded = true;\n            } else if (element.type === \"segments\" && Array.isArray(element.segments) && element.segments.length > 0) {\n                // Configurar los segmentos a eliminar\n                const segments = element.segments.map((segment)=>({\n                        startTime: typeof segment.startTime === \"number\" ? segment.startTime : 0,\n                        endTime: typeof segment.endTime === \"number\" ? segment.endTime : typeof segment.startTime === \"number\" ? segment.startTime + 5 : 5\n                    }));\n                console.log(\"Eliminando \".concat(segments.length, \" segmentos:\"), segments);\n                // Ejemplo de formato de segmentos a mostrar\n                const segmentsFormatted = segments.map((s)=>\"\".concat(s.startTime, \"-\").concat(s.endTime, \"s\")).join(\", \");\n                try {\n                    // Ejecutar la eliminación de segmentos\n                    const result = await commandExecutor.current.removeSegments(segments);\n                    if (result) {\n                        finalResponse += \"\\n\\n[He eliminado los segmentos solicitados: \".concat(segmentsFormatted, \"]\");\n                    } else {\n                        finalResponse += \"\\n\\n[No pude eliminar los segmentos solicitados. Aseg\\xfarate de que hay un elemento seleccionado en la timeline.]\";\n                    }\n                    elementAdded = true;\n                } catch (error) {\n                    console.error(\"Error al eliminar segmentos:\", error);\n                    finalResponse += \"\\n\\n[Error al intentar eliminar los segmentos: \".concat(error.message || \"Error desconocido\", \"]\");\n                }\n            } else if (element.type === \"compact\") {\n                // Ejecutar la compactación del timeline\n                console.log(\"Compactando timeline por solicitud del usuario\");\n                try {\n                    // Iniciar la compactación\n                    const result = await commandExecutor.current.compactTimeline();\n                    if (result) {\n                        finalResponse += \"\\n\\n[He compactado el timeline eliminando los espacios vac\\xedos entre elementos]\";\n                    } else {\n                        finalResponse += \"\\n\\n[No fue posible compactar el timeline. Puede que no haya elementos o espacios vac\\xedos que compactar]\";\n                    }\n                    elementAdded = true;\n                } catch (error) {\n                    console.error(\"Error al compactar el timeline:\", error);\n                    finalResponse += \"\\n\\n[Error al intentar compactar el timeline: \".concat(error.message || \"Error desconocido\", \"]\");\n                }\n            } else if (element.type === \"smartTrim\") {\n                // Ejecutar el recorte inteligente\n                console.log(\"Iniciando recorte inteligente por solicitud del usuario\");\n                try {\n                    // Mostrar mensaje de análisis en curso\n                    finalResponse += \"\\n\\n[Analizando el video para identificar las partes a eliminar...]\";\n                    // Iniciar el recorte inteligente\n                    const result = await commandExecutor.current.smartTrim();\n                    if (result) {\n                        finalResponse += \"\\n\\n[He realizado un recorte inteligente del video, eliminando las partes innecesarias y compactando el timeline]\";\n                    } else {\n                        finalResponse += \"\\n\\n[No fue posible realizar el recorte inteligente. Verifica que el video tenga una transcripci\\xf3n]\";\n                    }\n                    elementAdded = true;\n                } catch (error) {\n                    console.error(\"Error al realizar el recorte inteligente:\", error);\n                    finalResponse += \"\\n\\n[Error al intentar realizar el recorte inteligente: \".concat(error.message || \"Error desconocido\", \"]\");\n                }\n            } else if (element.type === \"music\" && Array.isArray(element.options) && element.options.length > 0) {\n                // Respuesta más corta para música\n                finalResponse = \"\\xbfCu\\xe1l de estas opciones te gustar\\xeda a\\xf1adir?\";\n                elementAdded = true;\n            }\n        }\n    } catch (error) {\n        console.error(\"Error al procesar elemento detectado:\", error);\n        finalResponse += \"\\n\\n[No pude procesar la solicitud debido a un error.]\";\n    }\n    return {\n        finalResponse,\n        elementAdded\n    };\n};\n// Componente para mostrar la animación de \"pensando\"\nconst ThinkingAnimation = ()=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex flex-col items-start animate-fadeIn\",\n        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n            className: \"max-w-[85%] rounded-md px-4 py-2 bg-[rgb(40,20,60)] text-zinc-200\",\n            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex items-center gap-2\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex gap-1\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                className: \"h-2 w-2 bg-purple-400 rounded-full animate-pulse\",\n                                style: {\n                                    animationDelay: \"0ms\"\n                                }\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 393,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                className: \"h-2 w-2 bg-purple-400 rounded-full animate-pulse\",\n                                style: {\n                                    animationDelay: \"300ms\"\n                                }\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 394,\n                                columnNumber: 11\n                            }, undefined),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                                className: \"h-2 w-2 bg-purple-400 rounded-full animate-pulse\",\n                                style: {\n                                    animationDelay: \"600ms\"\n                                }\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 395,\n                                columnNumber: 11\n                            }, undefined)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 392,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                        className: \"text-xs text-zinc-400\",\n                        children: \"Pensando...\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 397,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 391,\n                columnNumber: 7\n            }, undefined)\n        }, void 0, false, {\n            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n            lineNumber: 390,\n            columnNumber: 5\n        }, undefined)\n    }, void 0, false, {\n        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n        lineNumber: 389,\n        columnNumber: 3\n    }, undefined);\n_c1 = ThinkingAnimation;\n// Componente para mostrar el razonamiento desplegable\nconst ReasoningSection = (param)=>{\n    let { reasoning } = param;\n    _s();\n    const [isOpen, setIsOpen] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"mt-2 text-xs border-t border-purple-800/30 pt-2\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                onClick: ()=>setIsOpen(!isOpen),\n                className: \"flex items-center gap-1 text-purple-400 hover:text-purple-300 transition-colors\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"svg\", {\n                        xmlns: \"http://www.w3.org/2000/svg\",\n                        width: \"14\",\n                        height: \"14\",\n                        viewBox: \"0 0 24 24\",\n                        fill: \"none\",\n                        stroke: \"currentColor\",\n                        strokeWidth: \"2\",\n                        strokeLinecap: \"round\",\n                        strokeLinejoin: \"round\",\n                        className: \"transition-transform \".concat(isOpen ? \"rotate-180\" : \"\"),\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"polyline\", {\n                            points: \"6 9 12 15 18 9\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 425,\n                            columnNumber: 11\n                        }, undefined)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 413,\n                        columnNumber: 9\n                    }, undefined),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"span\", {\n                        children: \"Ver razonamiento\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 427,\n                        columnNumber: 9\n                    }, undefined)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 409,\n                columnNumber: 7\n            }, undefined),\n            isOpen && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"mt-2 p-2 bg-[rgb(30,15,45)] rounded text-zinc-400 whitespace-pre-wrap\",\n                children: reasoning\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 431,\n                columnNumber: 9\n            }, undefined)\n        ]\n    }, void 0, true, {\n        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n        lineNumber: 408,\n        columnNumber: 5\n    }, undefined);\n};\n_s(ReasoningSection, \"+sus0Lb0ewKHdwiUhiTAJFoFyQ0=\");\n_c2 = ReasoningSection;\nfunction AIChat() {\n    _s1();\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([\n        {\n            id: \"1\",\n            content: \"Hola, soy tu asistente de edici\\xf3n de video. \\xbfEn qu\\xe9 puedo ayudarte?\",\n            role: \"assistant\",\n            timestamp: new Date()\n        }\n    ]);\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [imageFile, setImageFile] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [imagePreview, setImagePreview] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [isUploading, setIsUploading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [lastUploadedImageUrl, setLastUploadedImageUrl] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const fileInputRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const stateManager = (0,_features_editor_hooks_state_manager__WEBPACK_IMPORTED_MODULE_6__.useStateManager)();\n    const { timeline, scenes, playerRef } = (0,_features_editor_store_use_data_state__WEBPACK_IMPORTED_MODULE_5__[\"default\"])();\n    const { duration } = (0,_features_editor_store_use_store__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(); // Obtener la duración del store\n    const commandExecutor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)((0,_ai_video_commands__WEBPACK_IMPORTED_MODULE_7__.createVideoCommandExecutor)(stateManager));\n    // Añadir estado para el modo (chat o agente)\n    const [mode, setMode] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"chat\");\n    // Estado para rastrear si el agente está ejecutando múltiples acciones\n    const [isAutoExecuting, setIsAutoExecuting] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [actionsQueue, setActionsQueue] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([]);\n    // Inicializar el CommandExecutorService con el executor actual\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (commandExecutor.current) {\n            _features_editor_services_command_executor_service__WEBPACK_IMPORTED_MODULE_9__[\"default\"].setExecutor(commandExecutor.current);\n            console.log(\"CommandExecutorService inicializado con \\xe9xito\");\n        }\n    }, [\n        commandExecutor.current\n    ]);\n    // Función para reiniciar el chat\n    const resetChat = ()=>{\n        setMessages([\n            {\n                id: Date.now().toString(),\n                content: mode === \"chat\" ? \"Hola, soy tu asistente de edici\\xf3n de video. \\xbfEn qu\\xe9 puedo ayudarte?\" : \"Hola, soy tu asistente aut\\xf3nomo de edici\\xf3n de video. Dime qu\\xe9 quieres hacer con tu video y lo har\\xe9 autom\\xe1ticamente por ti. Puedo editar, recortar, a\\xf1adir textos, im\\xe1genes, m\\xfasica y m\\xe1s.\",\n                role: \"assistant\",\n                timestamp: new Date(),\n                isInitial: true\n            }\n        ]);\n        setInput(\"\");\n        setImageFile(null);\n        setImagePreview(null);\n        setLastUploadedImageUrl(\"\");\n        setActionsQueue([]);\n        setIsAutoExecuting(false);\n    };\n    // Scroll al último mensaje\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        var _messagesEndRef_current;\n        (_messagesEndRef_current = messagesEndRef.current) === null || _messagesEndRef_current === void 0 ? void 0 : _messagesEndRef_current.scrollIntoView({\n            behavior: \"smooth\"\n        });\n    }, [\n        messages,\n        isLoading\n    ]);\n    // Actualizar el ejecutor de comandos cuando cambie el stateManager\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        commandExecutor.current = (0,_ai_video_commands__WEBPACK_IMPORTED_MODULE_7__.createVideoCommandExecutor)(stateManager);\n        // Actualizar el servicio con la nueva instancia del ejecutor\n        _features_editor_services_command_executor_service__WEBPACK_IMPORTED_MODULE_9__[\"default\"].setExecutor(commandExecutor.current);\n        console.log(\"CommandExecutorService actualizado con una nueva instancia del ejecutor\");\n    }, [\n        stateManager\n    ]);\n    // Manejar click en el botón de imagen\n    const handleImageClick = ()=>{\n        var _fileInputRef_current;\n        (_fileInputRef_current = fileInputRef.current) === null || _fileInputRef_current === void 0 ? void 0 : _fileInputRef_current.click();\n    };\n    // Manejar selección de archivo de imagen\n    const handleFileChange = (e)=>{\n        var _e_target_files;\n        const file = (_e_target_files = e.target.files) === null || _e_target_files === void 0 ? void 0 : _e_target_files[0];\n        if (file) {\n            setImageFile(file);\n            const previewUrl = URL.createObjectURL(file);\n            setImagePreview(previewUrl);\n        }\n    };\n    // Eliminar la imagen seleccionada\n    const handleRemoveImage = ()=>{\n        setImageFile(null);\n        setImagePreview(null);\n        if (fileInputRef.current) fileInputRef.current.value = \"\";\n    };\n    // Subir imagen al servidor\n    const uploadImage = async (file)=>{\n        try {\n            setIsUploading(true);\n            // Obtener URL firmada para subir la imagen\n            const uploadDetails = await (0,_utils_upload__WEBPACK_IMPORTED_MODULE_8__.createUploadsDetails)(file.name, file);\n            // Si no es un mock local, proceder con la carga\n            if (uploadDetails.uploadUrl !== \"local-mock\") {\n                // Subir la imagen\n                await fetch(uploadDetails.uploadUrl, {\n                    method: \"PUT\",\n                    body: file,\n                    headers: {\n                        \"Content-Type\": file.type\n                    }\n                });\n            }\n            // No se necesita hacer fetch si es un mock local (dataURL)\n            // Retornar la URL pública de la imagen\n            return uploadDetails.url;\n        } catch (error) {\n            console.error(\"Error al subir la imagen:\", error);\n            throw new Error(\"No se pudo subir la imagen. Int\\xe9ntalo de nuevo.\");\n        } finally{\n            setIsUploading(false);\n        }\n    };\n    // Función para procesar automáticamente acciones reconocidas\n    const processAutoActions = async (userMessage, elementData)=>{\n        if (!elementData || !elementData.detected || !elementData.element) return null;\n        // Crear un objeto para las acciones detectadas\n        const actionsList = [];\n        const primaryAction = {\n            type: elementData.element.type,\n            data: elementData.element,\n            executed: false,\n            confidence: elementData.confidence\n        };\n        actionsList.push(primaryAction);\n        // Verificar si hay acciones adicionales en el payload\n        if (elementData.additionalActions && Array.isArray(elementData.additionalActions)) {\n            elementData.additionalActions.forEach((action)=>{\n                if (action && action.type) {\n                    actionsList.push({\n                        type: action.type,\n                        data: action,\n                        executed: false,\n                        confidence: action.confidence || 0.8\n                    });\n                }\n            });\n        }\n        if (actionsList.length === 0) return null;\n        console.log(\"Modo AGENTE: Detectadas \".concat(actionsList.length, \" acciones a procesar autom\\xe1ticamente\"));\n        // Añadir las acciones a la cola y comenzar procesamiento\n        setActionsQueue(actionsList);\n        setIsAutoExecuting(true);\n        return actionsList;\n    };\n    // Función para ejecutar la siguiente acción en la cola\n    const executeNextAction = async ()=>{\n        if (!isAutoExecuting || actionsQueue.length === 0) {\n            setIsAutoExecuting(false);\n            return;\n        }\n        // Obtener la primera acción no ejecutada\n        const actionIndex = actionsQueue.findIndex((a)=>!a.executed);\n        if (actionIndex === -1) {\n            setIsAutoExecuting(false);\n            return;\n        }\n        const action = actionsQueue[actionIndex];\n        const finalResponseRef = {\n            current: \"\"\n        };\n        // Simular un elemento de datos para procesar\n        const mockElementData = {\n            detected: true,\n            confidence: action.confidence || 0.8,\n            element: action.data\n        };\n        try {\n            console.log(\"Ejecutando acci\\xf3n \".concat(action.type, \":\"), action.data);\n            const result = await processDetectedElement(mockElementData, commandExecutor, finalResponseRef, timeline, lastUploadedImageUrl, \"\");\n            // Marcar como ejecutada\n            const updatedQueue = [\n                ...actionsQueue\n            ];\n            updatedQueue[actionIndex].executed = true;\n            updatedQueue[actionIndex].result = result;\n            setActionsQueue(updatedQueue);\n            // Añadir mensaje de confirmación solo si es una acción relevante\n            if (result.elementAdded) {\n                setMessages((prev)=>[\n                        ...prev,\n                        {\n                            id: Date.now().toString(),\n                            content: \"✓ \".concat(finalResponseRef.current),\n                            role: \"assistant\",\n                            timestamp: new Date()\n                        }\n                    ]);\n            }\n            // Procesar la siguiente acción después de un breve retraso\n            setTimeout(()=>executeNextAction(), 500);\n        } catch (error) {\n            console.error(\"Error al ejecutar acci\\xf3n:\", error);\n            const updatedQueue = [\n                ...actionsQueue\n            ];\n            updatedQueue[actionIndex].executed = true;\n            updatedQueue[actionIndex].error = error.message || \"Error desconocido\";\n            setActionsQueue(updatedQueue);\n            // Continuar con la siguiente acción a pesar del error\n            setTimeout(()=>executeNextAction(), 500);\n        }\n    };\n    // Efecto para ejecutar acciones en cola\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        if (isAutoExecuting && actionsQueue.length > 0) {\n            executeNextAction();\n        }\n    }, [\n        isAutoExecuting,\n        actionsQueue\n    ]);\n    // Función para enviar mensaje\n    const handleSendMessage = async ()=>{\n        if (!input.trim() && !imageFile || isLoading) return;\n        let userMessage = {\n            id: Date.now().toString(),\n            content: input,\n            role: \"user\",\n            timestamp: new Date()\n        };\n        let uploadedImageUrl = \"\";\n        // Variable para rastrear la URL de la imagen actual para esta solicitud específica\n        let currentImageUrlForThisRequest = \"\";\n        // Si hay una imagen para subir, procesarla\n        if (imageFile) {\n            try {\n                uploadedImageUrl = await uploadImage(imageFile);\n                userMessage.imageUrl = uploadedImageUrl;\n                // Guardar la URL de la imagen para posibles referencias futuras\n                setLastUploadedImageUrl(uploadedImageUrl);\n                // Importante: Guardar la URL actual para esta solicitud específica\n                currentImageUrlForThisRequest = uploadedImageUrl;\n                console.log(\"Imagen subida exitosamente:\", uploadedImageUrl.substring(0, 100) + \"...\");\n            } catch (error) {\n                console.error(\"Error en la subida de imagen:\", error);\n                setMessages((prev)=>[\n                        ...prev,\n                        {\n                            id: (Date.now() + 1).toString(),\n                            content: \"Error al subir la imagen. Por favor, int\\xe9ntalo de nuevo. Detalles: \" + (error instanceof Error ? error.message : \"Error desconocido\"),\n                            role: \"assistant\",\n                            timestamp: new Date()\n                        }\n                    ]);\n                setIsLoading(false);\n                return;\n            }\n        }\n        // Añadir mensaje del usuario\n        setMessages((prev)=>[\n                ...prev,\n                userMessage\n            ]);\n        setInput(\"\");\n        setImageFile(null);\n        setImagePreview(null);\n        if (fileInputRef.current) fileInputRef.current.value = \"\";\n        setIsLoading(true);\n        try {\n            var _playerRef_current, _timeline_canvas_getObjects, _timeline_canvas, _timeline_canvas_getObjects1, _timeline_canvas1;\n            // Enviar a la API para procesamiento en lenguaje natural\n            const apiMessages = messages.concat(userMessage).map((msg)=>{\n                // Si el mensaje tiene una imagen, crear un formato especial para el contenido\n                if (msg.imageUrl) {\n                    // Si es una URL de datos (comienza con data:), usar un marcador especial\n                    const isDataUrl = msg.imageUrl.startsWith(\"data:\");\n                    const imageUrlToSend = isDataUrl ? \"[IMAGEN_ADJUNTA]\" : \"[IMAGEN: \".concat(msg.imageUrl, \"]\");\n                    return {\n                        role: msg.role,\n                        content: \"\".concat(msg.content || \"\", \" \").concat(imageUrlToSend)\n                    };\n                }\n                return {\n                    role: msg.role,\n                    content: msg.content\n                };\n            });\n            // Modificar el mensaje de contexto según el modo\n            const modeInstructions = mode === \"chat\" ? \"El usuario puede expresar en lenguaje natural la necesidad de agregar elementos al video.\" : \"El usuario espera que ejecutes autom\\xe1ticamente las acciones que solicite. Identifica todas las acciones posibles de edici\\xf3n de video en el mensaje y EJECUTA cada una secuencialmente sin pedir confirmaci\\xf3n.\";\n            // Añadir contexto del editor para la IA externa\n            const contextMessage = {\n                role: \"system\",\n                content: \"\\nContexto actual del editor de video:\\n- Posici\\xf3n actual (segundos): \".concat((playerRef === null || playerRef === void 0 ? void 0 : (_playerRef_current = playerRef.current) === null || _playerRef_current === void 0 ? void 0 : _playerRef_current.getCurrentTime) ? Math.floor((playerRef.current.getCurrentTime() || 0) * 100) / 100 : 0, \"\\n- Duraci\\xf3n del proyecto (segundos): \").concat((timeline === null || timeline === void 0 ? void 0 : timeline.duration) ? Math.floor(timeline.duration / 1000) : 0, \"\\n- N\\xfamero de escenas: \").concat((scenes === null || scenes === void 0 ? void 0 : scenes.length) || 0, \"\\n- N\\xfamero de elementos en el timeline: \").concat(((timeline === null || timeline === void 0 ? void 0 : (_timeline_canvas = timeline.canvas) === null || _timeline_canvas === void 0 ? void 0 : (_timeline_canvas_getObjects = _timeline_canvas.getObjects) === null || _timeline_canvas_getObjects === void 0 ? void 0 : _timeline_canvas_getObjects.call(_timeline_canvas)) || []).length - 1 > 0 ? ((timeline === null || timeline === void 0 ? void 0 : (_timeline_canvas1 = timeline.canvas) === null || _timeline_canvas1 === void 0 ? void 0 : (_timeline_canvas_getObjects1 = _timeline_canvas1.getObjects) === null || _timeline_canvas_getObjects1 === void 0 ? void 0 : _timeline_canvas_getObjects1.call(_timeline_canvas1)) || []).length - 1 : 0, \"\\n\").concat(lastUploadedImageUrl ? \"- \\xdaltima imagen compartida por el usuario disponible para usar\" : \"\", \"\\n\\n\").concat(modeInstructions, '\\nEjemplos:\\n- \"Pon un t\\xedtulo que diga \\'Bienvenidos\\' al inicio\"\\n- \"Quiero un texto blanco que diga \\'Fin\\' al final del video\"\\n- \"Necesito una imagen en el segundo 10\"\\n- \"Coloca un video de introducci\\xf3n al principio\"\\n\\nSi el usuario adjunta una imagen en el mensaje, la URL estar\\xe1 en formato [IMAGEN: url_de_la_imagen].\\nDebes detectar si quiere agregar esta imagen al video y en qu\\xe9 momento temporal.\\n')\n            };\n            try {\n                var _data_message;\n                const response = await fetch(\"/api/ai-chat\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        messages: [\n                            contextMessage,\n                            ...apiMessages\n                        ],\n                        // Usar la URL de la imagen actual para esta solicitud si existe,\n                        // de lo contrario usar la última URL guardada\n                        lastImageUrl: currentImageUrlForThisRequest || lastUploadedImageUrl || \"\",\n                        // Indicar si estamos en modo agente\n                        isAgentMode: mode === \"agent\"\n                    }),\n                    // Agregar timeout para evitar esperas infinitas\n                    signal: AbortSignal.timeout(15000) // 15 segundos máximo\n                });\n                if (!response.ok) {\n                    throw new Error(\"Error de API: \".concat(response.status, \" \").concat(response.statusText));\n                }\n                const data = await response.json();\n                // Asegurarse de que data.message.content existe\n                const aiResponse = (data === null || data === void 0 ? void 0 : (_data_message = data.message) === null || _data_message === void 0 ? void 0 : _data_message.content) || \"Lo siento, no pude entender tu solicitud.\";\n                // Obtener los datos del elemento si existen (con verificación segura)\n                const elementData = data === null || data === void 0 ? void 0 : data.elementData;\n                // Personalizar comportamiento según el modo\n                if (mode === \"agent\" && elementData && elementData.detected) {\n                    // En modo agente, procesar automáticamente las acciones detectadas\n                    const actions = await processAutoActions(userMessage.content, elementData);\n                    // Crear mensaje inicial del agente (solo se mostrará esto inicialmente)\n                    const agentMessage = {\n                        id: Date.now().toString(),\n                        content: aiResponse,\n                        role: \"assistant\",\n                        timestamp: new Date()\n                    };\n                    // Añadir mensaje inicial del agente\n                    setMessages((prev)=>[\n                            ...prev,\n                            agentMessage\n                        ]);\n                } else {\n                    var _elementData_element;\n                    // En modo chat, comportamiento normal\n                    // Variable para la respuesta final\n                    let finalResponse = aiResponse;\n                    // Crear una referencia a la respuesta final para que sea accesible en la función procesadora\n                    const finalResponseRef = {\n                        current: finalResponse\n                    };\n                    let elementAdded = false;\n                    // Usar la función de procesamiento de elementos\n                    const processResult = await processDetectedElement(elementData, commandExecutor, finalResponseRef, timeline, lastUploadedImageUrl, currentImageUrlForThisRequest);\n                    finalResponse = processResult.finalResponse;\n                    elementAdded = processResult.elementAdded;\n                    // Crear mensaje con los detalles completos\n                    const newMessage = {\n                        id: Date.now().toString(),\n                        content: finalResponse || data.message.content,\n                        role: \"assistant\",\n                        timestamp: new Date()\n                    };\n                    // Si se detectó un elemento de música, agregar las opciones al mensaje\n                    if ((elementData === null || elementData === void 0 ? void 0 : elementData.detected) && ((_elementData_element = elementData.element) === null || _elementData_element === void 0 ? void 0 : _elementData_element.type) === \"music\" && Array.isArray(elementData.element.options)) {\n                        newMessage.musicOptions = elementData.element.options;\n                        console.log(\"Opciones de m\\xfasica agregadas al mensaje:\", newMessage.musicOptions);\n                    }\n                    // Actualizar mensajes\n                    setMessages((prev)=>[\n                            ...prev,\n                            newMessage\n                        ]);\n                }\n            } catch (apiError) {\n                console.error(\"Error en la comunicaci\\xf3n con la API:\", apiError);\n                // Mensaje de error específico de API\n                setMessages((prev)=>[\n                        ...prev,\n                        {\n                            id: (Date.now() + 1).toString(),\n                            content: \"Lo siento, ha ocurrido un error al comunicarse con el servicio de IA. Por favor, intenta de nuevo en unos momentos.\",\n                            role: \"assistant\",\n                            timestamp: new Date()\n                        }\n                    ]);\n            }\n        } catch (error) {\n            console.error(\"Error al procesar el mensaje:\", error);\n            // Determinar mensaje de error apropiado\n            let errorMessage = \"Lo siento, ha ocurrido un error al procesar tu mensaje.\";\n            if (error instanceof Error) {\n                if (error.message.includes(\"timeout\") || error.message.includes(\"abort\")) {\n                    errorMessage = \"La solicitud ha tardado demasiado. Prueba con un mensaje m\\xe1s corto.\";\n                } else if (error.message.includes(\"network\") || error.message.includes(\"fetch\")) {\n                    errorMessage = \"Parece que hay un problema de conexi\\xf3n. Verifica tu conexi\\xf3n a internet e intenta de nuevo.\";\n                }\n            }\n            // Mensaje de error\n            setMessages((prev)=>[\n                    ...prev,\n                    {\n                        id: (Date.now() + 1).toString(),\n                        content: errorMessage,\n                        role: \"assistant\",\n                        timestamp: new Date()\n                    }\n                ]);\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    // Función para manejar la selección de música\n    const handleMusicSelect = async (musicPath)=>{\n        try {\n            console.log(\"Usuario seleccion\\xf3 m\\xfasica: \".concat(musicPath));\n            // Calcular la duración del video en segundos usando el duration del store\n            const videoDuration = duration ? Math.floor(duration / 1000) : 300; // 5 minutos por defecto\n            console.log(\"Duraci\\xf3n del video (desde useStore): \".concat(videoDuration, \" segundos\"));\n            // Configuración de opciones para la música\n            const musicOptions = {\n                startTime: 0,\n                endTime: videoDuration,\n                volume: 80,\n                fadeIn: true,\n                fadeOut: true,\n                respectNativeDuration: true // Respetar la duración natural de la música\n            };\n            // Añadir la música al timeline (respetará la duración natural si es más corta que el video)\n            commandExecutor.current.addMusic(musicPath, musicOptions);\n            // Obtener un nombre amigable para la música\n            const getMusicFriendlyName = (path)=>{\n                const filename = path.split(\"/\").pop() || path;\n                if (filename === \"song1.mp3\") return \"M\\xfasica Energ\\xe9tica\";\n                if (filename === \"song2.mp3\") return \"Melod\\xeda Relajante\";\n                return filename;\n            };\n            // Añadir un mensaje de confirmación\n            const musicName = getMusicFriendlyName(musicPath);\n            const confirmationMsg = {\n                id: Date.now().toString(),\n                content: 'He a\\xf1adido \"'.concat(musicName, '\" a tu video. La m\\xfasica se adaptar\\xe1 autom\\xe1ticamente: si es m\\xe1s corta que el video, mantendr\\xe1 su duraci\\xf3n natural; si es m\\xe1s larga, se ajustar\\xe1 a la duraci\\xf3n del video (').concat(videoDuration, \" segundos).\"),\n                role: \"assistant\",\n                timestamp: new Date()\n            };\n            setMessages((prev)=>[\n                    ...prev,\n                    confirmationMsg\n                ]);\n        } catch (error) {\n            console.error(\"Error al a\\xf1adir m\\xfasica:\", error);\n            // Mensaje de error\n            const errorMsg = {\n                id: Date.now().toString(),\n                content: \"No se pudo a\\xf1adir la m\\xfasica. Error: \".concat(error.message || \"Error desconocido\"),\n                role: \"assistant\",\n                timestamp: new Date()\n            };\n            setMessages((prev)=>[\n                    ...prev,\n                    errorMsg\n                ]);\n        }\n    };\n    // Manejar cambio de modo\n    const handleModeChange = (newMode)=>{\n        // Si el modo es diferente, cambiar y reiniciar la conversación\n        if (newMode !== mode) {\n            setMode(newMode);\n            // Mensaje inicial específico según el modo\n            const initialMessage = newMode === \"chat\" ? \"Hola, soy tu asistente de edici\\xf3n de video. \\xbfEn qu\\xe9 puedo ayudarte?\" : '\\xa1Hola! Soy el asistente aut\\xf3nomo de edici\\xf3n. A diferencia del modo chat, ejecutar\\xe9 directamente las acciones que me pidas sin necesidad de confirmaci\\xf3n. Puedo realizar varias acciones en secuencia, como:\\n\\n• \"Agrega un t\\xedtulo al inicio y subt\\xedtulos en todo el video\"\\n• \"Pon un texto de bienvenida, a\\xf1ade m\\xfasica y recorta las partes innecesarias\"\\n\\nSolo dime qu\\xe9 necesitas y lo har\\xe9 autom\\xe1ticamente.';\n            // Reiniciar la conversación con el mensaje apropiado\n            setMessages([\n                {\n                    id: Date.now().toString(),\n                    content: initialMessage,\n                    role: \"assistant\",\n                    timestamp: new Date(),\n                    // Marcar el mensaje como inicial para evitar mostrar razonamiento\n                    isInitial: true\n                }\n            ]);\n            // Limpiar otros estados\n            setInput(\"\");\n            setImageFile(null);\n            setImagePreview(null);\n            setLastUploadedImageUrl(\"\");\n            setActionsQueue([]);\n            setIsAutoExecuting(false);\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex h-full flex-col bg-[rgb(20,10,30)] border-l border-purple-800/30\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-[rgb(30,15,45)] p-3 flex justify-between items-center border-b border-purple-800/30\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-2\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"h-7 w-7 rounded flex items-center justify-center bg-purple-700\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_11__[\"default\"], {\n                                    className: \"h-3.5 w-3.5 text-white\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 1005,\n                                    columnNumber: 13\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1004,\n                                columnNumber: 11\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                                className: \"font-medium text-white text-sm\",\n                                children: \"Asistente IA\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1007,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1003,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center bg-[rgb(40,20,60)] rounded-full p-0.5 mx-auto\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: ()=>handleModeChange(\"chat\"),\n                                className: \"px-3 py-1 text-xs rounded-full transition-all \".concat(mode === \"chat\" ? \"bg-purple-700 text-white font-medium\" : \"text-purple-300 hover:text-white\"),\n                                children: \"Chat\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1012,\n                                columnNumber: 11\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"button\", {\n                                onClick: ()=>handleModeChange(\"agent\"),\n                                className: \"px-3 py-1 text-xs rounded-full transition-all \".concat(mode === \"agent\" ? \"bg-purple-700 text-white font-medium\" : \"text-purple-300 hover:text-white\"),\n                                children: \"Agente\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1022,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1011,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-1\",\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                            variant: \"ghost\",\n                            size: \"icon\",\n                            className: \"h-7 w-7 rounded hover:bg-purple-800/20\",\n                            onClick: resetChat,\n                            title: \"Reiniciar conversaci\\xf3n\",\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_12__[\"default\"], {\n                                className: \"h-3.5 w-3.5 text-zinc-300\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1042,\n                                columnNumber: 13\n                            }, this)\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 1035,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1034,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 1002,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex-1 overflow-hidden relative max-h-[calc(100%-120px)]\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_scroll_area__WEBPACK_IMPORTED_MODULE_4__.ScrollArea, {\n                    className: \"h-full pr-2 chat-scrollbar absolute inset-0\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"p-3 space-y-3\",\n                        children: [\n                            messages.map((message)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                    className: \"flex flex-col animate-fadeIn \".concat(message.role === \"assistant\" ? \"items-start\" : \"items-end\"),\n                                    children: [\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"max-w-[85%] rounded-md px-4 py-2 \".concat(message.role === \"assistant\" ? \"bg-[rgb(40,20,60)] text-zinc-200\" : \"bg-purple-700 text-white\"),\n                                            children: [\n                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"whitespace-pre-wrap text-sm\",\n                                                    children: message.content\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                                    lineNumber: 1065,\n                                                    columnNumber: 19\n                                                }, this),\n                                                message.imageUrl && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                                    className: \"mt-2 rounded overflow-hidden\",\n                                                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                                        src: message.imageUrl,\n                                                        alt: \"Imagen adjunta\",\n                                                        className: \"max-h-48 max-w-full object-contain\"\n                                                    }, void 0, false, {\n                                                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                                        lineNumber: 1068,\n                                                        columnNumber: 23\n                                                    }, this)\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                                    lineNumber: 1067,\n                                                    columnNumber: 21\n                                                }, this),\n                                                message.musicOptions && message.musicOptions.length > 0 && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(MusicOptions, {\n                                                    options: message.musicOptions,\n                                                    onSelectMusic: handleMusicSelect\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                                    lineNumber: 1076,\n                                                    columnNumber: 21\n                                                }, this),\n                                                mode === \"agent\" && message.role === \"assistant\" && !message.isInitial && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ReasoningSection, {\n                                                    reasoning: generateReasoning(message.content)\n                                                }, void 0, false, {\n                                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                                    lineNumber: 1084,\n                                                    columnNumber: 21\n                                                }, this)\n                                            ]\n                                        }, void 0, true, {\n                                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                            lineNumber: 1058,\n                                            columnNumber: 17\n                                        }, this),\n                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                            className: \"text-[10px] mt-0.5 px-1 \".concat(message.role === \"assistant\" ? \"text-zinc-500\" : \"text-purple-300\"),\n                                            children: message.timestamp.toLocaleTimeString([], {\n                                                hour: \"2-digit\",\n                                                minute: \"2-digit\"\n                                            })\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                            lineNumber: 1087,\n                                            columnNumber: 17\n                                        }, this)\n                                    ]\n                                }, message.id, true, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 1052,\n                                    columnNumber: 15\n                                }, this)),\n                            isLoading && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(ThinkingAnimation, {}, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1092,\n                                columnNumber: 27\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                ref: messagesEndRef,\n                                className: \"h-2\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1093,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1050,\n                        columnNumber: 11\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                    lineNumber: 1049,\n                    columnNumber: 9\n                }, this)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 1048,\n                columnNumber: 7\n            }, this),\n            imagePreview && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"relative mx-3 mt-1 mb-2 h-24 bg-[rgb(30,15,45)] p-2 flex items-center justify-center rounded border border-purple-800/30\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                        variant: \"ghost\",\n                        size: \"icon\",\n                        className: \"absolute right-1 top-1 z-10 h-5 w-5 rounded-full bg-black/50\",\n                        onClick: handleRemoveImage,\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_13__[\"default\"], {\n                            className: \"h-3 w-3 text-white\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 1107,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1101,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                        src: imagePreview,\n                        alt: \"Vista previa\",\n                        className: \"max-h-full max-w-full object-contain\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1109,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 1100,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-[rgb(30,15,45)] p-3 border-t border-purple-800/30\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex rounded overflow-hidden border border-purple-900/50 flex-1 bg-[rgb(25,12,40)]\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                                variant: \"ghost\",\n                                size: \"icon\",\n                                className: \"h-9 w-9 bg-transparent hover:bg-purple-800/20\",\n                                onClick: handleImageClick,\n                                disabled: isLoading,\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_14__[\"default\"], {\n                                    className: \"h-4 w-4 text-zinc-400\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 1128,\n                                    columnNumber: 15\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1121,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_input__WEBPACK_IMPORTED_MODULE_3__.Input, {\n                                value: input,\n                                onChange: (e)=>setInput(e.target.value),\n                                onKeyDown: (e)=>{\n                                    if (e.key === \"Enter\" && !e.shiftKey) {\n                                        e.preventDefault();\n                                        handleSendMessage();\n                                    }\n                                },\n                                placeholder: \"Escribe tu mensaje...\",\n                                disabled: isLoading,\n                                className: \"flex-1 border-0 bg-transparent h-9 focus:ring-0 focus-visible:ring-0 text-zinc-200\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1131,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                                onClick: handleSendMessage,\n                                disabled: !input.trim() && !imageFile || isLoading,\n                                className: \"h-9 px-3 rounded-none \".concat(!input.trim() && !imageFile || isLoading ? \"bg-purple-900/50 cursor-not-allowed text-purple-300/50\" : \"bg-purple-700 hover:bg-purple-600 text-white\"),\n                                children: isLoading || isUploading ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_15__[\"default\"], {\n                                    className: \"h-4 w-4 animate-spin\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 1155,\n                                    columnNumber: 17\n                                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_16__[\"default\"], {\n                                    className: \"h-3.5 w-3.5\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 1157,\n                                    columnNumber: 17\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 1145,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 1120,\n                        columnNumber: 11\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                    lineNumber: 1119,\n                    columnNumber: 9\n                }, this)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 1118,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                type: \"file\",\n                ref: fileInputRef,\n                onChange: handleFileChange,\n                accept: \"image/*\",\n                className: \"hidden\",\n                disabled: isLoading\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 1164,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n        lineNumber: 1000,\n        columnNumber: 5\n    }, this);\n}\n_s1(AIChat, \"Oc8vVXOrpwU8d7N3GwzWwYkiju0=\", false, function() {\n    return [\n        _features_editor_hooks_state_manager__WEBPACK_IMPORTED_MODULE_6__.useStateManager,\n        _features_editor_store_use_data_state__WEBPACK_IMPORTED_MODULE_5__[\"default\"],\n        _features_editor_store_use_store__WEBPACK_IMPORTED_MODULE_10__[\"default\"]\n    ];\n});\n_c3 = AIChat;\n// Función para generar razonamiento ficticio basado en el contenido del mensaje\nfunction generateReasoning(content) {\n    // Si estamos en modo agente autónomo, mostrar un razonamiento más orientado a la acción\n    if (content.includes(\"[He \") || content.includes(\"✓\")) {\n        return \"PROCESO DE EJECUCI\\xd3N:\\n1. Analizar solicitud del usuario\\n2. Identificar acciones requeridas\\n3. Ejecutar secuencialmente las acciones\\n4. Confirmar resultado\\n\\nEVALUACI\\xd3N:\\n→ Acci\\xf3n completada con \\xe9xito\\n→ Resultado visible en la l\\xednea de tiempo\";\n    }\n    // Por defecto, devolver el razonamiento estándar\n    return \"AN\\xc1LISIS:\\n• Tipo: Solicitud de edici\\xf3n\\n• Contexto: Timeline del video\\n• Prioridad: Alta\\n\\nPROCESO:\\n1. Identificar intenci\\xf3n → Modificaci\\xf3n de video\\n2. Extraer par\\xe1metros → Posici\\xf3n, duraci\\xf3n, contenido\\n3. Seleccionar herramientas → Editor apropiado\\n4. Ejecutar acci\\xf3n → Aplicar cambios\\n\\nRESULTADO:\\n→ Acci\\xf3n completada\\n→ Verificaci\\xf3n visual requerida\";\n}\nvar _c, _c1, _c2, _c3;\n$RefreshReg$(_c, \"MusicOptions\");\n$RefreshReg$(_c1, \"ThinkingAnimation\");\n$RefreshReg$(_c2, \"ReasoningSection\");\n$RefreshReg$(_c3, \"AIChat\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2NvbXBvbmVudHMvYWktY2hhdC9pbmRleC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRW9EO0FBQ0o7QUFDRjtBQUNXO0FBQ3VCO0FBQ2Q7QUFDTTtBQUNlO0FBQ2pDO0FBQ21DO0FBQ2hDO0FBRXpELGtGQUFrRjtBQUNsRixTQUFTa0IsNkJBQTZCQyxjQUFzQjtJQUMxRCxJQUFJQyxZQUFZO0lBQ2hCLElBQUlDLFVBQVU7SUFFZCxJQUFJLENBQUNGLGdCQUFnQixPQUFPO1FBQUVDO1FBQVdDO0lBQVE7SUFFakQsdUNBQXVDO0lBQ3ZDLE1BQU1DLG9CQUFvQjtRQUN4QjtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUVELHFDQUFxQztJQUNyQyxNQUFNQyxrQkFBa0I7UUFDdEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtLQUNEO0lBRUQsbUNBQW1DO0lBQ25DLE1BQU1DLFlBQVksNENBQTRDQyxJQUFJLENBQUNOO0lBQ25FLE1BQU1PLFVBQVUsdUNBQXVDRCxJQUFJLENBQUNOO0lBRTVELHNDQUFzQztJQUN0QyxLQUFLLE1BQU1RLFdBQVdMLGtCQUFtQjtRQUN2QyxNQUFNTSxRQUFRVCxlQUFlUyxLQUFLLENBQUNEO1FBQ25DLElBQUlDLFNBQVNBLEtBQUssQ0FBQyxFQUFFLEVBQUU7WUFDckIsbURBQW1EO1lBQ25EUixZQUFZTyxRQUFRRSxRQUFRLEdBQUdDLFFBQVEsQ0FBQyxZQUNwQ0MsU0FBU0gsS0FBSyxDQUFDLEVBQUUsSUFBSSxLQUNyQkcsU0FBU0gsS0FBSyxDQUFDLEVBQUU7WUFDckI7UUFDRjtJQUNGO0lBRUEsb0NBQW9DO0lBQ3BDLEtBQUssTUFBTUQsV0FBV0osZ0JBQWlCO1FBQ3JDLE1BQU1LLFFBQVFULGVBQWVTLEtBQUssQ0FBQ0Q7UUFDbkMsSUFBSUMsU0FBU0EsS0FBSyxDQUFDLEVB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O2dDQUN4Q3dGLFdBQVcsQ0FBQ2hHO29DQUNWLElBQUlBLEVBQUVpRyxHQUFHLEtBQUssV0FBVyxDQUFDakcsRUFBRWtHLFFBQVEsRUFBRTt3Q0FDcENsRyxFQUFFbUcsY0FBYzt3Q0FDaEIvRDtvQ0FDRjtnQ0FDRjtnQ0FDQWdFLGFBQVk7Z0NBQ1pOLFVBQVUzSDtnQ0FDVjNGLFdBQVU7Ozs7OzswQ0FHWiw4REFBQ3pDLHlEQUFNQTtnQ0FDTDhDLFNBQVN1SjtnQ0FDVDBELFVBQVUsQ0FBRTdILE1BQU1vRSxJQUFJLE1BQU0sQ0FBQ2hFLGFBQWNGO2dDQUMzQzNGLFdBQVcseUJBSVYsT0FIQyxDQUFFeUYsTUFBTW9FLElBQUksTUFBTSxDQUFDaEUsYUFBY0YsWUFDN0IsMkRBQ0E7MENBR0xBLGFBQWFNLDRCQUNaLDhEQUFDdEksd0hBQU9BO29DQUFDcUMsV0FBVTs7Ozs7eURBRW5CLDhEQUFDdEMsd0hBQUlBO29DQUFDc0MsV0FBVTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQU8xQiw4REFBQ3lGO2dCQUNDNUQsTUFBSztnQkFDTHdMLEtBQUtqSDtnQkFDTG1ILFVBQVVoRztnQkFDVnNHLFFBQU87Z0JBQ1A3TixXQUFVO2dCQUNWc04sVUFBVTNIOzs7Ozs7Ozs7Ozs7QUFJbEI7SUEvdEJ3QlQ7O1FBa0JEakgsaUZBQWVBO1FBQ0lELDZFQUFZQTtRQUMvQksseUVBQVFBOzs7TUFwQlA2RztBQWl1QnhCLGdGQUFnRjtBQUNoRixTQUFTK0gsa0JBQWtCbkwsT0FBZTtJQUN4Qyx3RkFBd0Y7SUFDeEYsSUFBSUEsUUFBUTVDLFFBQVEsQ0FBQyxXQUFXNEMsUUFBUTVDLFFBQVEsQ0FBQyxNQUFNO1FBQ3JELE9BQVE7SUFTVjtJQUVBLGlEQUFpRDtJQUNqRCxPQUFRO0FBY1YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vY29tcG9uZW50cy9haS1jaGF0L2luZGV4LnRzeD80Yjk3Il0sInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgeyB1c2VTdGF0ZSwgdXNlUmVmLCB1c2VFZmZlY3QgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvYnV0dG9uXCI7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvaW5wdXRcIjtcbmltcG9ydCB7IFNjcm9sbEFyZWEgfSBmcm9tIFwiQC9jb21wb25lbnRzL3VpL3Njcm9sbC1hcmVhXCI7XG5pbXBvcnQgeyBTZW5kLCBMb2FkZXIyLCBJbWFnZUljb24sIFgsIFNwYXJrbGVzLCBSZWZyZXNoQ3cgfSBmcm9tIFwibHVjaWRlLXJlYWN0XCI7XG5pbXBvcnQgdXNlRGF0YVN0YXRlIGZyb20gXCJAL2ZlYXR1cmVzL2VkaXRvci9zdG9yZS91c2UtZGF0YS1zdGF0ZVwiO1xuaW1wb3J0IHsgdXNlU3RhdGVNYW5hZ2VyIH0gZnJvbSBcIkAvZmVhdHVyZXMvZWRpdG9yL2hvb2tzL3N0YXRlLW1hbmFnZXJcIjtcbmltcG9ydCB7IGNyZWF0ZVZpZGVvQ29tbWFuZEV4ZWN1dG9yLCBWaWRlb0NvbW1hbmRFeGVjdXRvciB9IGZyb20gXCIuL2FpLXZpZGVvLWNvbW1hbmRzXCI7XG5pbXBvcnQgeyBjcmVhdGVVcGxvYWRzRGV0YWlscyB9IGZyb20gXCJAL3V0aWxzL3VwbG9hZFwiO1xuaW1wb3J0IENvbW1hbmRFeGVjdXRvclNlcnZpY2UgZnJvbSBcIkAvZmVhdHVyZXMvZWRpdG9yL3NlcnZpY2VzL2NvbW1hbmQtZXhlY3V0b3Itc2VydmljZVwiO1xuaW1wb3J0IHVzZVN0b3JlIGZyb20gXCJAL2ZlYXR1cmVzL2VkaXRvci9zdG9yZS91c2Utc3RvcmVcIjtcblxuLy8gRnVuY2nDs24gcGFyYSBleHRyYWVyIHRpZW1wb3MgZGUgaW5pY2lvIHkgZmluIGRlIHVuYSBpbWFnZW4gYSBwYXJ0aXIgZGVsIG1lbnNhamVcbmZ1bmN0aW9uIGV4dHJhY3RJbWFnZVRpbWVzRnJvbU1lc3NhZ2UobWVzc2FnZUNvbnRlbnQ6IHN0cmluZyk6IHsgc3RhcnRUaW1lOiBudW1iZXIsIGVuZFRpbWU6IG51bWJlciB9IHtcbiAgbGV0IHN0YXJ0VGltZSA9IDA7XG4gIGxldCBlbmRUaW1lID0gNTtcblxuICBpZiAoIW1lc3NhZ2VDb250ZW50KSByZXR1cm4geyBzdGFydFRpbWUsIGVuZFRpbWUgfTtcblxuICAvLyBCdXNjYXIgcmVmZXJlbmNpYXMgYWwgdGllbXBvIGluaWNpYWxcbiAgY29uc3Qgc3RhcnRUaW1lUGF0dGVybnMgPSBbXG4gICAgL2VuIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2Rlc2RlIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2EgcGFydGlyIGRlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9jb21lbnphbmRvIGVuIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2Rlc2RlIGVsIG1pbnV0byAoXFxkKykvaSwgLy8gQ29udmVydGlyIG1pbnV0b3MgYSBzZWd1bmRvc1xuICAgIC9lbiBlbCBtaW51dG8gKFxcZCspL2ksICAgIC8vIENvbnZlcnRpciBtaW51dG9zIGEgc2VndW5kb3NcbiAgICAvZW50cmUgbG9zIHNlZ3VuZG9zIChcXGQrKSB5L2ksIC8vIENhcHR1cmEgZWwgcHJpbWVyIG7Dum1lcm8gZW4gXCJlbnRyZSBYIHkgWVwiXG4gICAgL2RlbCBzZWd1bmRvIChcXGQrKSBhbC9pLFxuICAgIC9lbXBlemFuZG8gZW4gKFxcZCspL2ksXG4gICAgL3NlZ3VuZG8gKFxcZCspL2ksICAgICAvLyBQYXRyw7NuIG3DoXMgZ2VuZXJhbCBwYXJhIGNhcHR1cmFyIFwic2VndW5kbyBYXCJcbiAgICAvZW4gKFxcZCspIHNlZ3VuZG9zL2ksIC8vIFwiZW4gWCBzZWd1bmRvc1wiXG4gICAgL2VuIGVsIChcXGQrKS9pLCAgICAgICAvLyBcImVuIGVsIFhcIiAoY3VhbmRvIHNlIHJlZmllcmUgYSBzZWd1bmRvcylcbiAgXTtcblxuICAvLyBCdXNjYXIgcmVmZXJlbmNpYXMgYWwgdGllbXBvIGZpbmFsXG4gIGNvbnN0IGVuZFRpbWVQYXR0ZXJucyA9IFtcbiAgICAvaGFzdGEgZWwgc2VndW5kbyAoXFxkKykvaSxcbiAgICAvYWwgc2VndW5kbyAoXFxkKykvaSxcbiAgICAvdGVybWluYW5kbyBlbiBlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9oYXN0YSBlbCBtaW51dG8gKFxcZCspL2ksIC8vIENvbnZlcnRpciBtaW51dG9zIGEgc2VndW5kb3NcbiAgICAvZW50cmUgbG9zIHNlZ3VuZG9zIFxcZCsgeSAoXFxkKykvaSwgLy8gQ2FwdHVyYSBlbCBzZWd1bmRvIG7Dum1lcm8gZW4gXCJlbnRyZSBYIHkgWVwiXG4gICAgL2RlbCBzZWd1bmRvIFxcZCsgYWwgKFxcZCspL2ksXG4gICAgL3BvciAoXFxkKykgc2VndW5kb3MvaSwgLy8gRHVyYWNpw7NuIHJlbGF0aXZhXG4gICAgL2R1cmFudGUgKFxcZCspIHNlZ3VuZG9zL2ksIC8vIER1cmFjacOzbiByZWxhdGl2YVxuICBdO1xuXG4gIC8vIEJ1c2NhciBwYWxhYnJhcyBjbGF2ZSBlc3BlY2lhbGVzXG4gIGNvbnN0IGlzQXRTdGFydCA9IC9cXGIoYWwgaW5pY2lvfGFsIHByaW5jaXBpb3xhbCBjb21pZW56bylcXGIvaS50ZXN0KG1lc3NhZ2VDb250ZW50KTtcbiAgY29uc3QgaXNBdEVuZCA9IC9cXGIoYWwgZmluYWx8YWwgdMOpcm1pbm98YWwgYWNhYmFyKVxcYi9pLnRlc3QobWVzc2FnZUNvbnRlbnQpO1xuXG4gIC8vIFByb2Nlc2FyIHBhdHJvbmVzIGRlIHRpZW1wbyBpbmljaWFsXG4gIGZvciAoY29uc3QgcGF0dGVybiBvZiBzdGFydFRpbWVQYXR0ZXJucykge1xuICAgIGNvbnN0IG1hdGNoID0gbWVzc2FnZUNvbnRlbnQubWF0Y2gocGF0dGVybik7XG4gICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICAvLyBTaSBlcyByZWZlcmVuY2lhIGEgbWludXRvcywgY29udmVydGlyIGEgc2VndW5kb3NcbiAgICAgIHN0YXJ0VGltZSA9IHBhdHRlcm4udG9TdHJpbmcoKS5pbmNsdWRlcygnbWludXRvJylcbiAgICAgICAgPyBwYXJzZUludChtYXRjaFsxXSkgKiA2MFxuICAgICAgICA6IHBhcnNlSW50KG1hdGNoWzFdKTtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuXG4gIC8vIFByb2Nlc2FyIHBhdHJvbmVzIGRlIHRpZW1wbyBmaW5hbFxuICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZW5kVGltZVBhdHRlcm5zKSB7XG4gICAgY29uc3QgbWF0Y2ggPSBtZXNzYWdlQ29udGVudC5tYXRjaChwYXR0ZXJuKTtcbiAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgIGlmIChwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ3BvcicpIHx8IHBhdHRlcm4udG9TdHJpbmcoKS5pbmNsdWRlcygnZHVyYW50ZScpKSB7XG4gICAgICAgIC8vIEVzIHVuYSBkdXJhY2nDs24gcmVsYXRpdmEsIHN1bWFyIGFsIHRpZW1wbyBpbmljaWFsXG4gICAgICAgIGVuZFRpbWUgPSBzdGFydFRpbWUgKyBwYXJzZUludChtYXRjaFsxXSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBFcyB1biB0aWVtcG8gYWJzb2x1dG9cbiAgICAgICAgZW5kVGltZSA9IHBhdHRlcm4udG9TdHJpbmcoKS5pbmNsdWRlcygnbWludXRvJylcbiAgICAgICAgICA/IHBhcnNlSW50KG1hdGNoWzFdKSAqIDYwXG4gICAgICAgICAgOiBwYXJzZUludChtYXRjaFsxXSk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBTaSBzZSBtZW5jaW9uYSBcImFsIGluaWNpb1wiLCBlc3RhYmxlY2VyIHRpZW1wbyBhIDBcbiAgaWYgKGlzQXRTdGFydCkge1xuICAgIHN0YXJ0VGltZSA9IDA7XG4gICAgZW5kVGltZSA9IDU7IC8vIFBvciBkZWZlY3RvIDUgc2VndW5kb3MgZGUgZHVyYWNpw7NuXG4gIH1cblxuICAvLyBTaSBzZSBtZW5jaW9uYSBcImFsIGZpbmFsXCIsIGVzdGFibGVjZXIgdmFsb3JlcyByZWxhdGl2b3MgYWwgZmluYWxcbiAgLy8gTm90YTogRWwgdmFsb3IgcmVhbCBzZSBhanVzdGFyw6EgZW4gZWwgY2xpZW50ZSBzZWfDum4gbGEgZHVyYWNpw7NuXG4gIGlmIChpc0F0RW5kKSB7XG4gICAgc3RhcnRUaW1lID0gLTE7IC8vIEPDs2RpZ28gZXNwZWNpYWwgcGFyYSBcImZpbmFsIC0gNSBzZWd1bmRvc1wiXG4gICAgZW5kVGltZSA9IC0xOyAgIC8vIEPDs2RpZ28gZXNwZWNpYWwgcGFyYSBcImZpbmFsXCJcbiAgfVxuXG4gIC8vIFNpIG5vIHNlIGRldGVjdMOzIHRpZW1wbyBmaW5hbCBwZXJvIHPDrSBpbmljaWFsLCBlc3RhYmxlY2VyIHVuYSBkdXJhY2nDs24gcHJlZGV0ZXJtaW5hZGFcbiAgaWYgKHN0YXJ0VGltZSA+IDAgJiYgZW5kVGltZSA9PT0gNSAmJiBzdGFydFRpbWUgIT09IDApIHtcbiAgICBlbmRUaW1lID0gc3RhcnRUaW1lICsgNTtcbiAgfVxuXG4gIHJldHVybiB7IHN0YXJ0VGltZSwgZW5kVGltZSB9O1xufVxuXG4vLyBUaXBvIHBhcmEgbG9zIG1lbnNhamVzXG50eXBlIE1lc3NhZ2UgPSB7XG4gIGlkOiBzdHJpbmc7XG4gIGNvbnRlbnQ6IHN0cmluZztcbiAgcm9sZTogXCJhc3Npc3RhbnRcIiB8IFwidXNlclwiO1xuICB0aW1lc3RhbXA6IERhdGU7XG4gIGltYWdlVXJsPzogc3RyaW5nOyAvLyBQcm9waWVkYWQgcGFyYSBVUkxzIGRlIGltYWdlblxuICBtdXNpY09wdGlvbnM/OiBzdHJpbmdbXTsgLy8gUHJvcGllZGFkIHBhcmEgb3BjaW9uZXMgZGUgbcO6c2ljYVxuICBpc0luaXRpYWw/OiBib29sZWFuOyAvLyBQcm9waWVkYWQgcGFyYSBtYXJjYXIgbWVuc2FqZXMgaW5pY2lhbGVzXG59O1xuXG4vLyBDb21wb25lbnRlIHBhcmEgcmVuZGVyaXphciBvcGNpb25lcyBkZSBtw7pzaWNhIGNvbW8gYm90b25lcyBjbGlja2FibGVzXG5jb25zdCBNdXNpY09wdGlvbnMgPSAoeyBvcHRpb25zLCBvblNlbGVjdE11c2ljIH0pID0+IHtcbiAgaWYgKCFBcnJheS5pc0FycmF5KG9wdGlvbnMpIHx8IG9wdGlvbnMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvLyBGdW5jacOzbiBwYXJhIGNvbnZlcnRpciBlbCBub21icmUgZGVsIGFyY2hpdm8gYSB1biBub21icmUgYW1pZ2FibGVcbiAgY29uc3QgZ2V0RnJpZW5kbHlOYW1lID0gKG11c2ljUGF0aCkgPT4ge1xuICAgIGNvbnN0IGZpbGVuYW1lID0gbXVzaWNQYXRoLnNwbGl0KCcvJykucG9wKCkgfHwgbXVzaWNQYXRoO1xuXG4gICAgLy8gTWFwZWFyIG5vbWJyZXMgZGUgYXJjaGl2b3MgYSBub21icmVzIGFtaWdhYmxlc1xuICAgIGlmIChmaWxlbmFtZSA9PT0gXCJzb25nMS5tcDNcIikgcmV0dXJuIFwiTcO6c2ljYSBFbmVyZ8OpdGljYVwiO1xuICAgIGlmIChmaWxlbmFtZSA9PT0gXCJzb25nMi5tcDNcIikgcmV0dXJuIFwiTWVsb2TDrWEgUmVsYWphbnRlXCI7XG5cbiAgICAvLyBTaSBubyBoYXkgbWFwZW8gZXNwZWPDrWZpY28sIGRldm9sdmVyIGVsIG5vbWJyZSBkZWwgYXJjaGl2b1xuICAgIHJldHVybiBmaWxlbmFtZTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBmbGV4LWNvbCBnYXAtMyBtdC0zXCI+XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZmxleC13cmFwIGdhcC0yXCI+XG4gICAgICAgIHtvcHRpb25zLm1hcCgobXVzaWNQYXRoLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGNvbnN0IG11c2ljTmFtZSA9IGdldEZyaWVuZGx5TmFtZShtdXNpY1BhdGgpO1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICAgIGtleT17aW5kZXh9XG4gICAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IG9uU2VsZWN0TXVzaWMobXVzaWNQYXRoKX1cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwicHgtNCBweS0yIHRleHQtc20gYmctZ3JhZGllbnQtdG8tciBmcm9tLXB1cnBsZS02MDAgdG8taW5kaWdvLTYwMCBob3Zlcjpmcm9tLXB1cnBsZS03MDAgaG92ZXI6dG8taW5kaWdvLTcwMCB0ZXh0LXdoaXRlIHJvdW5kZWQtbGcgdHJhbnNpdGlvbi1hbGwgc2hhZG93LW1kIGhvdmVyOnNoYWRvdy1sZyBmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMiBmb250LW1lZGl1bVwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwiY3VycmVudENvbG9yXCIgY2xhc3NOYW1lPVwidy01IGgtNVwiPlxuICAgICAgICAgICAgICAgIDxwYXRoIGQ9XCJNOSAxOVY2bDEyLTN2MTNNOSAxOWMwIDEuMTA1LTEuMzQzIDItMyAycy0zLS44OTUtMy0yIDEuMzQzLTIgMy0yIDMgLjg5NSAzIDJ6bTEyLTNjMCAxLjEwNS0xLjM0MyAyLTMgMnMtMy0uODk1LTMtMiAxLjM0My0yIDMtMiAzIC44OTUgMyAyek05IDlsMTItM1wiIHN0cm9rZVdpZHRoPVwiMlwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIGZpbGw9XCJub25lXCIgc3Ryb2tlTGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiLz5cbiAgICAgICAgICAgICAgPC9zdmc+XG4gICAgICAgICAgICAgIHttdXNpY05hbWV9XG4gICAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICApO1xuICAgICAgICB9KX1cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufTtcblxuLy8gRnVuY2nDs24gcGFyYSBwcm9jZXNhciBlbGVtZW50b3MgZGV0ZWN0YWRvcyBwb3IgbGEgSUFcbmNvbnN0IHByb2Nlc3NEZXRlY3RlZEVsZW1lbnQgPSBhc3luYyAoZWxlbWVudERhdGEsIGNvbW1hbmRFeGVjdXRvciwgZmluYWxSZXNwb25zZVJlZiwgdGltZWxpbmUsIGxhc3RVcGxvYWRlZEltYWdlVXJsLCBjdXJyZW50SW1hZ2VVcmxGb3JUaGlzUmVxdWVzdCkgPT4ge1xuICBsZXQgZWxlbWVudEFkZGVkID0gZmFsc2U7XG4gIGxldCBmaW5hbFJlc3BvbnNlID0gZmluYWxSZXNwb25zZVJlZi5jdXJyZW50O1xuXG4gIHRyeSB7XG4gICAgLy8gU2kgc2UgZGV0ZWN0w7MgdW4gZWxlbWVudG8gcGFyYSBhZ3JlZ2FyIGNvbiBjb25maWFuemEgc3VmaWNpZW50ZVxuICAgIGlmIChlbGVtZW50RGF0YSAmJlxuICAgICAgICBlbGVtZW50RGF0YS5kZXRlY3RlZCA9PT0gdHJ1ZSAmJlxuICAgICAgICB0eXBlb2YgZWxlbWVudERhdGEuY29uZmlkZW5jZSA9PT0gJ251bWJlcicgJiZcbiAgICAgICAgZWxlbWVudERhdGEuY29uZmlkZW5jZSA+IDAuNyAmJlxuICAgICAgICBlbGVtZW50RGF0YS5lbGVtZW50KSB7XG4gICAgICBjb25zdCBlbGVtZW50ID0gZWxlbWVudERhdGEuZWxlbWVudDtcblxuICAgICAgLy8gUHJvY2VzYXIgc2Vnw7puIGVsIHRpcG8gZGUgZWxlbWVudG9cbiAgICAgIGlmIChlbGVtZW50LnR5cGUgPT09IFwidGV4dFwiICYmIGVsZW1lbnQuY29udGVudCkge1xuICAgICAgICAvLyBDb25maWd1cmFyIG9wY2lvbmVzIHBhcmEgZWwgdGV4dG9cbiAgICAgICAgY29uc3QgdGV4dE9wdGlvbnM6IGFueSA9IHtcbiAgICAgICAgICBzdGFydFRpbWU6IHR5cGVvZiBlbGVtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicgPyBlbGVtZW50LnN0YXJ0VGltZSA6IDAsXG4gICAgICAgICAgZW5kVGltZTogdHlwZW9mIGVsZW1lbnQuZW5kVGltZSA9PT0gJ251bWJlcicgPyBlbGVtZW50LmVuZFRpbWUgOiAodHlwZW9mIGVsZW1lbnQuc3RhcnRUaW1lID09PSAnbnVtYmVyJyA/IGVsZW1lbnQuc3RhcnRUaW1lICsgNSA6IDUpLFxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIEFzaWduYXIgY29sb3Igc2kgZXN0w6EgZGlzcG9uaWJsZVxuICAgICAgICBpZiAoZWxlbWVudC5jb2xvcikge1xuICAgICAgICAgIHRleHRPcHRpb25zLmNvbG9yID0gZWxlbWVudC5jb2xvci50b0xvd2VyQ2FzZSgpID09PSBcImJsYW5jb1wiID8gXCIjRkZGRkZGXCIgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY29sb3IudG9Mb3dlckNhc2UoKSA9PT0gXCJuZWdyb1wiID8gXCIjMDAwMDAwXCIgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY29sb3IudG9Mb3dlckNhc2UoKSA9PT0gXCJyb2pvXCIgPyBcIiNGRjAwMDBcIiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jb2xvci50b0xvd2VyQ2FzZSgpID09PSBcImF6dWxcIiA/IFwiIzAwMDBGRlwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNvbG9yLnRvTG93ZXJDYXNlKCkgPT09IFwidmVyZGVcIiA/IFwiIzAwRkYwMFwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNvbG9yLnRvTG93ZXJDYXNlKCkgPT09IFwiYW1hcmlsbG9cIiA/IFwiI0ZGRkYwMFwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNvbG9yO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQcOxYWRpciBlbCB0ZXh0b1xuICAgICAgICBjb21tYW5kRXhlY3V0b3IuY3VycmVudC5hZGRUZXh0KGVsZW1lbnQuY29udGVudCwgdGV4dE9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEFjdHVhbGl6YXIgcmVzcHVlc3RhXG4gICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltIZSBhZ3JlZ2FkbyBlbCB0ZXh0byBcIiR7ZWxlbWVudC5jb250ZW50fVwiICR7ZWxlbWVudC5jb2xvciA/IGBjb24gY29sb3IgJHtlbGVtZW50LmNvbG9yfSBgIDogXCJcIn1kZXNkZSBlbCBzZWd1bmRvICR7dGV4dE9wdGlvbnMuc3RhcnRUaW1lfSBoYXN0YSBlbCBzZWd1bmRvICR7dGV4dE9wdGlvbnMuZW5kVGltZX1dYDtcbiAgICAgICAgZWxlbWVudEFkZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGVsZW1lbnQudHlwZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICAgIC8vIENvbmZpZ3VyYXIgb3BjaW9uZXMgcGFyYSBsYSBpbWFnZW5cbiAgICAgICAgY29uc3QgaW1hZ2VPcHRpb25zOiBhbnkgPSB7XG4gICAgICAgICAgc3RhcnRUaW1lOiB0eXBlb2YgZWxlbWVudC5zdGFydFRpbWUgPT09ICdudW1iZXInID8gZWxlbWVudC5zdGFydFRpbWUgOiAwLFxuICAgICAgICAgIGVuZFRpbWU6IHR5cGVvZiBlbGVtZW50LmVuZFRpbWUgPT09ICdudW1iZXInID8gZWxlbWVudC5lbmRUaW1lIDogKHR5cGVvZiBlbGVtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicgPyBlbGVtZW50LnN0YXJ0VGltZSArIDUgOiA1KSxcbiAgICAgICAgICAvLyBQb3NpY2nDs24gY2VudHJhZGEgcG9yIGRlZmVjdG9cbiAgICAgICAgICBwb3NpdGlvbjogeyB4OiAwLjUsIHk6IDAuNSB9XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gUmVnaXN0cmFyIHRpZW1wb3MgZXNwZWPDrWZpY29zIHBhcmEgZGVwdXJhY2nDs25cbiAgICAgICAgY29uc29sZS5sb2coYFRpZW1wb3MgZGUgaW1hZ2VuIHJlY2liaWRvcyBkZSBsYSBBUEk6IHN0YXJ0VGltZT0ke2VsZW1lbnQuc3RhcnRUaW1lfSwgZW5kVGltZT0ke2VsZW1lbnQuZW5kVGltZX1gKTtcblxuICAgICAgICAvLyBNYW5lamFyIGNhc29zIGVzcGVjaWFsZXMgcGFyYSBcImFsIGZpbmFsXCIgZGVsIHZpZGVvXG4gICAgICAgIGlmIChlbGVtZW50LnN0YXJ0VGltZSA9PT0gLTEgfHwgZWxlbWVudC5lbmRUaW1lID09PSAtMSkge1xuICAgICAgICAgIC8vIENhbGN1bGFyIGxhIGR1cmFjacOzbiBkZWwgdmlkZW8gZW4gc2VndW5kb3NcbiAgICAgICAgICBjb25zdCB2aWRlb0R1cmF0aW9uID0gdGltZWxpbmU/LmR1cmF0aW9uXG4gICAgICAgICAgICA/IE1hdGguZmxvb3IodGltZWxpbmUuZHVyYXRpb24gLyAxMDAwKVxuICAgICAgICAgICAgOiAzMDsgLy8gVmFsb3IgcHJlZGV0ZXJtaW5hZG8gc2kgbm8gaGF5IGR1cmFjacOzblxuXG4gICAgICAgICAgY29uc29sZS5sb2coYER1cmFjacOzbiBkZWwgdmlkZW86ICR7dmlkZW9EdXJhdGlvbn1zYCk7XG5cbiAgICAgICAgICBpZiAoZWxlbWVudC5zdGFydFRpbWUgPT09IC0xICYmIGVsZW1lbnQuZW5kVGltZSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIFNpIGFtYm9zIHNvbiAtMSwgY29sb2NhciBlbiBsb3Mgw7psdGltb3MgNSBzZWd1bmRvc1xuICAgICAgICAgICAgaW1hZ2VPcHRpb25zLnN0YXJ0VGltZSA9IE1hdGgubWF4KDAsIHZpZGVvRHVyYXRpb24gLSA1KTtcbiAgICAgICAgICAgIGltYWdlT3B0aW9ucy5lbmRUaW1lID0gdmlkZW9EdXJhdGlvbjtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBBanVzdGFuZG8gcGFyYSBcImFsIGZpbmFsXCI6IHN0YXJ0VGltZT0ke2ltYWdlT3B0aW9ucy5zdGFydFRpbWV9LCBlbmRUaW1lPSR7aW1hZ2VPcHRpb25zLmVuZFRpbWV9YCk7XG4gICAgICAgICAgfSBlbHNlIGlmIChlbGVtZW50LnN0YXJ0VGltZSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIFNvbG8gc3RhcnRUaW1lIGVzIC0xXG4gICAgICAgICAgICBpbWFnZU9wdGlvbnMuc3RhcnRUaW1lID0gTWF0aC5tYXgoMCwgdmlkZW9EdXJhdGlvbiAtIDUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5lbmRUaW1lID09PSAtMSkge1xuICAgICAgICAgICAgLy8gU29sbyBlbmRUaW1lIGVzIC0xXG4gICAgICAgICAgICBpbWFnZU9wdGlvbnMuZW5kVGltZSA9IHZpZGVvRHVyYXRpb247XG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc29sZS5sb2coYFRpZW1wb3MgZGUgaW1hZ2VuIGEgYXBsaWNhcjogc3RhcnRUaW1lPSR7aW1hZ2VPcHRpb25zLnN0YXJ0VGltZX0sIGVuZFRpbWU9JHtpbWFnZU9wdGlvbnMuZW5kVGltZX1gKTtcblxuICAgICAgICAvLyBEZXRlcm1pbmFyIGxhIFVSTCBkZSBsYSBpbWFnZW4gYSB1c2FyXG4gICAgICAgIGNvbnN0IGlzR2VuZXJpY1VybCA9IGVsZW1lbnQudXJsID09PSAnaW1hZ2VuX2FkanVudGFfcG9yX2VsX3VzdWFyaW8uanBnJztcbiAgICAgICAgY29uc3QgaXNMb2NhbEltYWdlID0gbGFzdFVwbG9hZGVkSW1hZ2VVcmwgJiYgbGFzdFVwbG9hZGVkSW1hZ2VVcmwuc3RhcnRzV2l0aCgnZGF0YTonKTtcblxuICAgICAgICBsZXQgaW1hZ2VVcmw6IHN0cmluZztcblxuICAgICAgICAvLyBQUklPUklEQUQgMTogVXNhciBsYSBpbWFnZW4gcXVlIGFjYWJhIGRlIHN1Ymlyc2UgZW4gZXN0ZSBtZW5zYWplIGVzcGVjw61maWNvXG4gICAgICAgIGlmIChjdXJyZW50SW1hZ2VVcmxGb3JUaGlzUmVxdWVzdCkge1xuICAgICAgICAgIGltYWdlVXJsID0gY3VycmVudEltYWdlVXJsRm9yVGhpc1JlcXVlc3Q7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJVc2FuZG8gbGEgaW1hZ2VuIHJlY2nDqW4gc3ViaWRhIHBhcmEgZXN0YSBzb2xpY2l0dWQgZXNwZWPDrWZpY2FcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUFJJT1JJREFEIDI6IFVzYXIgbGEgVVJMIGRlbCBlbGVtZW50byBzaSB0aWVuZSB1bmEgZXNwZWPDrWZpY2EgeSBOTyBlcyBsYSBVUkwgZ2Vuw6lyaWNhXG4gICAgICAgIGVsc2UgaWYgKGVsZW1lbnQudXJsICYmICFpc0dlbmVyaWNVcmwgJiYgIWVsZW1lbnQudXJsLmluY2x1ZGVzKCcvdXJsX2RlX2xhX2ltYWdlbicpKSB7XG4gICAgICAgICAgaW1hZ2VVcmwgPSBlbGVtZW50LnVybDtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzYW5kbyBVUkwgZXNwZWPDrWZpY2EgZGVsIGVsZW1lbnRvXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBSSU9SSURBRCAzOiBVc2FyIGxhIMO6bHRpbWEgaW1hZ2VuIHN1YmlkYSBndWFyZGFkYSBzaSBoYXkgcmVmZXJlbmNpYSBhIGltYWdlbiBnZW7DqXJpY2FcbiAgICAgICAgZWxzZSBpZiAoaXNHZW5lcmljVXJsICYmIGxhc3RVcGxvYWRlZEltYWdlVXJsKSB7XG4gICAgICAgICAgaW1hZ2VVcmwgPSBsYXN0VXBsb2FkZWRJbWFnZVVybDtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzYW5kbyBsYSDDumx0aW1hIGltYWdlbiBzdWJpZGEgZ3VhcmRhZGFcIik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gUFJJT1JJREFEIDQ6IEZhbGxiYWNrIGEgVVJMIGdlbsOpcmljYVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAvLyBTaSB0b2RvIGxvIGRlbcOhcyBmYWxsYSwgdXNhciB1bmEgaW1hZ2VuIGRlIGVqZW1wbG9cbiAgICAgICAgICBpbWFnZVVybCA9IFwiaHR0cHM6Ly9pay5pbWFnZWtpdC5pby93b21iby9pbWFnZXMvaW1nMi5qcGdcIjtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIlVzYW5kbyBpbWFnZW4gZGUgZWplbXBsbyBjb21vIGZhbGxiYWNrXCIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQcOxYWRpciBsYSBpbWFnZW5cbiAgICAgICAgY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQuYWRkSW1hZ2UoaW1hZ2VVcmwsIGltYWdlT3B0aW9ucyk7XG5cbiAgICAgICAgLy8gQWN0dWFsaXphciByZXNwdWVzdGFcbiAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0hlIGFncmVnYWRvIGxhIGltYWdlbiBkZXNkZSBlbCBzZWd1bmRvICR7aW1hZ2VPcHRpb25zLnN0YXJ0VGltZX0gaGFzdGEgZWwgc2VndW5kbyAke2ltYWdlT3B0aW9ucy5lbmRUaW1lfV1gO1xuICAgICAgICBlbGVtZW50QWRkZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZWxlbWVudC50eXBlID09PSBcInZpZGVvXCIpIHtcbiAgICAgICAgLy8gQ29uZmlndXJhciBvcGNpb25lcyBwYXJhIGVsIHZpZGVvXG4gICAgICAgIGNvbnN0IHZpZGVvT3B0aW9uczogYW55ID0ge1xuICAgICAgICAgIHN0YXJ0VGltZTogdHlwZW9mIGVsZW1lbnQuc3RhcnRUaW1lID09PSAnbnVtYmVyJyA/IGVsZW1lbnQuc3RhcnRUaW1lIDogMCxcbiAgICAgICAgICBlbmRUaW1lOiB0eXBlb2YgZWxlbWVudC5lbmRUaW1lID09PSAnbnVtYmVyJyA/IGVsZW1lbnQuZW5kVGltZSA6ICh0eXBlb2YgZWxlbWVudC5zdGFydFRpbWUgPT09ICdudW1iZXInID8gZWxlbWVudC5zdGFydFRpbWUgKyAxMCA6IDEwKSxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBVUkwgZGUgdmlkZW8gZGUgZWplbXBsbyAoZW4gcHJvZHVjY2nDs24gZXN0byBzZXLDrWEgZGluw6FtaWNvKVxuICAgICAgICBjb25zdCB2aWRlb1VybCA9IFwiaHR0cHM6Ly9jZG4uZGVzaWduY29tYm8uZGV2L3ZpZGVvcy9kZW1vLXZpZGVvLTQubXA0XCI7XG5cbiAgICAgICAgLy8gQcOxYWRpciBlbCB2aWRlb1xuICAgICAgICBjb21tYW5kRXhlY3V0b3IuY3VycmVudC5hZGRWaWRlbyh2aWRlb1VybCwgdmlkZW9PcHRpb25zKTtcblxuICAgICAgICAvLyBBY3R1YWxpemFyIHJlc3B1ZXN0YVxuICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bSGUgYWdyZWdhZG8gZWwgdmlkZW8gZGVzZGUgZWwgc2VndW5kbyAke3ZpZGVvT3B0aW9ucy5zdGFydFRpbWV9IGhhc3RhIGVsIHNlZ3VuZG8gJHt2aWRlb09wdGlvbnMuZW5kVGltZX1dYDtcbiAgICAgICAgZWxlbWVudEFkZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGVsZW1lbnQudHlwZSA9PT0gXCJzdWJ0aXRsZXNcIikge1xuICAgICAgICAvLyBDb25maWd1cmFyIG9wY2lvbmVzIHBhcmEgbG9zIHN1YnTDrXR1bG9zXG4gICAgICAgIGNvbnN0IHN1YnRpdGxlT3B0aW9uczogYW55ID0ge1xuICAgICAgICAgIGdyb3VwV29yZHM6IGVsZW1lbnQuZ3JvdXBXb3JkcyAhPT0gdW5kZWZpbmVkID8gZWxlbWVudC5ncm91cFdvcmRzIDogdHJ1ZSxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBw7FhZGlyIHRpZW1wb3Mgc2kgc2UgZXNwZWNpZmljYXJvblxuICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQuc3RhcnRUaW1lID09PSAnbnVtYmVyJykge1xuICAgICAgICAgIHN1YnRpdGxlT3B0aW9ucy5zdGFydFRpbWUgPSBlbGVtZW50LnN0YXJ0VGltZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGVsZW1lbnQuZW5kVGltZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICBzdWJ0aXRsZU9wdGlvbnMuZW5kVGltZSA9IGVsZW1lbnQuZW5kVGltZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEHDsWFkaXIgbG9zIHN1YnTDrXR1bG9zXG4gICAgICAgIGNvbW1hbmRFeGVjdXRvci5jdXJyZW50LmFkZFN1YnRpdGxlcyhzdWJ0aXRsZU9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEFjdHVhbGl6YXIgcmVzcHVlc3RhIHNpbGVuY2lvc2EgKHNlIG1hbmVqYSBlbiBvdHJvIGxhZG8pXG4gICAgICAgIGVsZW1lbnRBZGRlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChlbGVtZW50LnR5cGUgPT09IFwic2VnbWVudHNcIiAmJiBBcnJheS5pc0FycmF5KGVsZW1lbnQuc2VnbWVudHMpICYmIGVsZW1lbnQuc2VnbWVudHMubGVuZ3RoID4gMCkge1xuICAgICAgICAvLyBDb25maWd1cmFyIGxvcyBzZWdtZW50b3MgYSBlbGltaW5hclxuICAgICAgICBjb25zdCBzZWdtZW50cyA9IGVsZW1lbnQuc2VnbWVudHMubWFwKHNlZ21lbnQgPT4gKHtcbiAgICAgICAgICBzdGFydFRpbWU6IHR5cGVvZiBzZWdtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicgPyBzZWdtZW50LnN0YXJ0VGltZSA6IDAsXG4gICAgICAgICAgZW5kVGltZTogdHlwZW9mIHNlZ21lbnQuZW5kVGltZSA9PT0gJ251bWJlcicgPyBzZWdtZW50LmVuZFRpbWUgOiAodHlwZW9mIHNlZ21lbnQuc3RhcnRUaW1lID09PSAnbnVtYmVyJyA/IHNlZ21lbnQuc3RhcnRUaW1lICsgNSA6IDUpLFxuICAgICAgICB9KSk7XG5cbiAgICAgICAgY29uc29sZS5sb2coYEVsaW1pbmFuZG8gJHtzZWdtZW50cy5sZW5ndGh9IHNlZ21lbnRvczpgLCBzZWdtZW50cyk7XG5cbiAgICAgICAgLy8gRWplbXBsbyBkZSBmb3JtYXRvIGRlIHNlZ21lbnRvcyBhIG1vc3RyYXJcbiAgICAgICAgY29uc3Qgc2VnbWVudHNGb3JtYXR0ZWQgPSBzZWdtZW50cy5tYXAocyA9PiBgJHtzLnN0YXJ0VGltZX0tJHtzLmVuZFRpbWV9c2ApLmpvaW4oJywgJyk7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBFamVjdXRhciBsYSBlbGltaW5hY2nDs24gZGUgc2VnbWVudG9zXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQucmVtb3ZlU2VnbWVudHMoc2VnbWVudHMpO1xuXG4gICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0hlIGVsaW1pbmFkbyBsb3Mgc2VnbWVudG9zIHNvbGljaXRhZG9zOiAke3NlZ21lbnRzRm9ybWF0dGVkfV1gO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bTm8gcHVkZSBlbGltaW5hciBsb3Mgc2VnbWVudG9zIHNvbGljaXRhZG9zLiBBc2Vnw7pyYXRlIGRlIHF1ZSBoYXkgdW4gZWxlbWVudG8gc2VsZWNjaW9uYWRvIGVuIGxhIHRpbWVsaW5lLl1gO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtZW50QWRkZWQgPSB0cnVlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhbCBlbGltaW5hciBzZWdtZW50b3M6XCIsIGVycm9yKTtcbiAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bRXJyb3IgYWwgaW50ZW50YXIgZWxpbWluYXIgbG9zIHNlZ21lbnRvczogJHtlcnJvci5tZXNzYWdlIHx8IFwiRXJyb3IgZGVzY29ub2NpZG9cIn1dYDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZWxlbWVudC50eXBlID09PSBcImNvbXBhY3RcIikge1xuICAgICAgICAvLyBFamVjdXRhciBsYSBjb21wYWN0YWNpw7NuIGRlbCB0aW1lbGluZVxuICAgICAgICBjb25zb2xlLmxvZyhcIkNvbXBhY3RhbmRvIHRpbWVsaW5lIHBvciBzb2xpY2l0dWQgZGVsIHVzdWFyaW9cIik7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBJbmljaWFyIGxhIGNvbXBhY3RhY2nDs25cbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21tYW5kRXhlY3V0b3IuY3VycmVudC5jb21wYWN0VGltZWxpbmUoKTtcblxuICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltIZSBjb21wYWN0YWRvIGVsIHRpbWVsaW5lIGVsaW1pbmFuZG8gbG9zIGVzcGFjaW9zIHZhY8Otb3MgZW50cmUgZWxlbWVudG9zXWA7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltObyBmdWUgcG9zaWJsZSBjb21wYWN0YXIgZWwgdGltZWxpbmUuIFB1ZWRlIHF1ZSBubyBoYXlhIGVsZW1lbnRvcyBvIGVzcGFjaW9zIHZhY8Otb3MgcXVlIGNvbXBhY3Rhcl1gO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtZW50QWRkZWQgPSB0cnVlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhbCBjb21wYWN0YXIgZWwgdGltZWxpbmU6XCIsIGVycm9yKTtcbiAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bRXJyb3IgYWwgaW50ZW50YXIgY29tcGFjdGFyIGVsIHRpbWVsaW5lOiAke2Vycm9yLm1lc3NhZ2UgfHwgXCJFcnJvciBkZXNjb25vY2lkb1wifV1gO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChlbGVtZW50LnR5cGUgPT09IFwic21hcnRUcmltXCIpIHtcbiAgICAgICAgLy8gRWplY3V0YXIgZWwgcmVjb3J0ZSBpbnRlbGlnZW50ZVxuICAgICAgICBjb25zb2xlLmxvZyhcIkluaWNpYW5kbyByZWNvcnRlIGludGVsaWdlbnRlIHBvciBzb2xpY2l0dWQgZGVsIHVzdWFyaW9cIik7XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBNb3N0cmFyIG1lbnNhamUgZGUgYW7DoWxpc2lzIGVuIGN1cnNvXG4gICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0FuYWxpemFuZG8gZWwgdmlkZW8gcGFyYSBpZGVudGlmaWNhciBsYXMgcGFydGVzIGEgZWxpbWluYXIuLi5dYDtcblxuICAgICAgICAgIC8vIEluaWNpYXIgZWwgcmVjb3J0ZSBpbnRlbGlnZW50ZVxuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbW1hbmRFeGVjdXRvci5jdXJyZW50LnNtYXJ0VHJpbSgpO1xuXG4gICAgICAgICAgaWYgKHJlc3VsdCkge1xuICAgICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0hlIHJlYWxpemFkbyB1biByZWNvcnRlIGludGVsaWdlbnRlIGRlbCB2aWRlbywgZWxpbWluYW5kbyBsYXMgcGFydGVzIGlubmVjZXNhcmlhcyB5IGNvbXBhY3RhbmRvIGVsIHRpbWVsaW5lXWA7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltObyBmdWUgcG9zaWJsZSByZWFsaXphciBlbCByZWNvcnRlIGludGVsaWdlbnRlLiBWZXJpZmljYSBxdWUgZWwgdmlkZW8gdGVuZ2EgdW5hIHRyYW5zY3JpcGNpw7NuXWA7XG4gICAgICAgICAgfVxuICAgICAgICAgIGVsZW1lbnRBZGRlZCA9IHRydWU7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFsIHJlYWxpemFyIGVsIHJlY29ydGUgaW50ZWxpZ2VudGU6XCIsIGVycm9yKTtcbiAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bRXJyb3IgYWwgaW50ZW50YXIgcmVhbGl6YXIgZWwgcmVjb3J0ZSBpbnRlbGlnZW50ZTogJHtlcnJvci5tZXNzYWdlIHx8IFwiRXJyb3IgZGVzY29ub2NpZG9cIn1dYDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZWxlbWVudC50eXBlID09PSBcIm11c2ljXCIgJiYgQXJyYXkuaXNBcnJheShlbGVtZW50Lm9wdGlvbnMpICYmIGVsZW1lbnQub3B0aW9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIC8vIFJlc3B1ZXN0YSBtw6FzIGNvcnRhIHBhcmEgbcO6c2ljYVxuICAgICAgICBmaW5hbFJlc3BvbnNlID0gXCLCv0N1w6FsIGRlIGVzdGFzIG9wY2lvbmVzIHRlIGd1c3RhcsOtYSBhw7FhZGlyP1wiO1xuICAgICAgICBlbGVtZW50QWRkZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWwgcHJvY2VzYXIgZWxlbWVudG8gZGV0ZWN0YWRvOlwiLCBlcnJvcik7XG4gICAgZmluYWxSZXNwb25zZSArPSBcIlxcblxcbltObyBwdWRlIHByb2Nlc2FyIGxhIHNvbGljaXR1ZCBkZWJpZG8gYSB1biBlcnJvci5dXCI7XG4gIH1cblxuICByZXR1cm4geyBmaW5hbFJlc3BvbnNlLCBlbGVtZW50QWRkZWQgfTtcbn07XG5cbi8vIENvbXBvbmVudGUgcGFyYSBtb3N0cmFyIGxhIGFuaW1hY2nDs24gZGUgXCJwZW5zYW5kb1wiXG5jb25zdCBUaGlua2luZ0FuaW1hdGlvbiA9ICgpID0+IChcbiAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGZsZXgtY29sIGl0ZW1zLXN0YXJ0IGFuaW1hdGUtZmFkZUluXCI+XG4gICAgPGRpdiBjbGFzc05hbWU9XCJtYXgtdy1bODUlXSByb3VuZGVkLW1kIHB4LTQgcHktMiBiZy1bcmdiKDQwLDIwLDYwKV0gdGV4dC16aW5jLTIwMFwiPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMlwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggZ2FwLTFcIj5cbiAgICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJoLTIgdy0yIGJnLXB1cnBsZS00MDAgcm91bmRlZC1mdWxsIGFuaW1hdGUtcHVsc2VcIiBzdHlsZT17eyBhbmltYXRpb25EZWxheTogXCIwbXNcIiB9fT48L3NwYW4+XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaC0yIHctMiBiZy1wdXJwbGUtNDAwIHJvdW5kZWQtZnVsbCBhbmltYXRlLXB1bHNlXCIgc3R5bGU9e3sgYW5pbWF0aW9uRGVsYXk6IFwiMzAwbXNcIiB9fT48L3NwYW4+XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPVwiaC0yIHctMiBiZy1wdXJwbGUtNDAwIHJvdW5kZWQtZnVsbCBhbmltYXRlLXB1bHNlXCIgc3R5bGU9e3sgYW5pbWF0aW9uRGVsYXk6IFwiNjAwbXNcIiB9fT48L3NwYW4+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8c3BhbiBjbGFzc05hbWU9XCJ0ZXh0LXhzIHRleHQtemluYy00MDBcIj5QZW5zYW5kby4uLjwvc3Bhbj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbik7XG5cbi8vIENvbXBvbmVudGUgcGFyYSBtb3N0cmFyIGVsIHJhem9uYW1pZW50byBkZXNwbGVnYWJsZVxuY29uc3QgUmVhc29uaW5nU2VjdGlvbiA9ICh7IHJlYXNvbmluZyB9OiB7IHJlYXNvbmluZzogc3RyaW5nIH0pID0+IHtcbiAgY29uc3QgW2lzT3Blbiwgc2V0SXNPcGVuXSA9IHVzZVN0YXRlKGZhbHNlKTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiB0ZXh0LXhzIGJvcmRlci10IGJvcmRlci1wdXJwbGUtODAwLzMwIHB0LTJcIj5cbiAgICAgIDxidXR0b25cbiAgICAgICAgb25DbGljaz17KCkgPT4gc2V0SXNPcGVuKCFpc09wZW4pfVxuICAgICAgICBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMSB0ZXh0LXB1cnBsZS00MDAgaG92ZXI6dGV4dC1wdXJwbGUtMzAwIHRyYW5zaXRpb24tY29sb3JzXCJcbiAgICAgID5cbiAgICAgICAgPHN2Z1xuICAgICAgICAgIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxuICAgICAgICAgIHdpZHRoPVwiMTRcIlxuICAgICAgICAgIGhlaWdodD1cIjE0XCJcbiAgICAgICAgICB2aWV3Qm94PVwiMCAwIDI0IDI0XCJcbiAgICAgICAgICBmaWxsPVwibm9uZVwiXG4gICAgICAgICAgc3Ryb2tlPVwiY3VycmVudENvbG9yXCJcbiAgICAgICAgICBzdHJva2VXaWR0aD1cIjJcIlxuICAgICAgICAgIHN0cm9rZUxpbmVjYXA9XCJyb3VuZFwiXG4gICAgICAgICAgc3Ryb2tlTGluZWpvaW49XCJyb3VuZFwiXG4gICAgICAgICAgY2xhc3NOYW1lPXtgdHJhbnNpdGlvbi10cmFuc2Zvcm0gJHtpc09wZW4gPyAncm90YXRlLTE4MCcgOiAnJ31gfVxuICAgICAgICA+XG4gICAgICAgICAgPHBvbHlsaW5lIHBvaW50cz1cIjYgOSAxMiAxNSAxOCA5XCI+PC9wb2x5bGluZT5cbiAgICAgICAgPC9zdmc+XG4gICAgICAgIDxzcGFuPlZlciByYXpvbmFtaWVudG88L3NwYW4+XG4gICAgICA8L2J1dHRvbj5cblxuICAgICAge2lzT3BlbiAmJiAoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiBwLTIgYmctW3JnYigzMCwxNSw0NSldIHJvdW5kZWQgdGV4dC16aW5jLTQwMCB3aGl0ZXNwYWNlLXByZS13cmFwXCI+XG4gICAgICAgICAge3JlYXNvbmluZ31cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gQUlDaGF0KCkge1xuICBjb25zdCBbbWVzc2FnZXMsIHNldE1lc3NhZ2VzXSA9IHVzZVN0YXRlPE1lc3NhZ2VbXT4oW1xuICAgIHtcbiAgICAgIGlkOiBcIjFcIixcbiAgICAgIGNvbnRlbnQ6IFwiSG9sYSwgc295IHR1IGFzaXN0ZW50ZSBkZSBlZGljacOzbiBkZSB2aWRlby4gwr9FbiBxdcOpIHB1ZWRvIGF5dWRhcnRlP1wiLFxuICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICB9LFxuICBdKTtcbiAgY29uc3QgW2lucHV0LCBzZXRJbnB1dF0gPSB1c2VTdGF0ZShcIlwiKTtcbiAgY29uc3QgW2lzTG9hZGluZywgc2V0SXNMb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2ltYWdlRmlsZSwgc2V0SW1hZ2VGaWxlXSA9IHVzZVN0YXRlPEZpbGUgfCBudWxsPihudWxsKTtcbiAgY29uc3QgW2ltYWdlUHJldmlldywgc2V0SW1hZ2VQcmV2aWV3XSA9IHVzZVN0YXRlPHN0cmluZyB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaXNVcGxvYWRpbmcsIHNldElzVXBsb2FkaW5nXSA9IHVzZVN0YXRlKGZhbHNlKTtcbiAgY29uc3QgW2xhc3RVcGxvYWRlZEltYWdlVXJsLCBzZXRMYXN0VXBsb2FkZWRJbWFnZVVybF0gPSB1c2VTdGF0ZTxzdHJpbmc+KFwiXCIpO1xuICBjb25zdCBmaWxlSW5wdXRSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudD4obnVsbCk7XG4gIGNvbnN0IG1lc3NhZ2VzRW5kUmVmID0gdXNlUmVmPEhUTUxEaXZFbGVtZW50PihudWxsKTtcblxuICBjb25zdCBzdGF0ZU1hbmFnZXIgPSB1c2VTdGF0ZU1hbmFnZXIoKTtcbiAgY29uc3QgeyB0aW1lbGluZSwgc2NlbmVzLCBwbGF5ZXJSZWYgfSA9IHVzZURhdGFTdGF0ZSgpO1xuICBjb25zdCB7IGR1cmF0aW9uIH0gPSB1c2VTdG9yZSgpOyAvLyBPYnRlbmVyIGxhIGR1cmFjacOzbiBkZWwgc3RvcmVcbiAgY29uc3QgY29tbWFuZEV4ZWN1dG9yID0gdXNlUmVmPFZpZGVvQ29tbWFuZEV4ZWN1dG9yPihjcmVhdGVWaWRlb0NvbW1hbmRFeGVjdXRvcihzdGF0ZU1hbmFnZXIpKTtcblxuICAvLyBBw7FhZGlyIGVzdGFkbyBwYXJhIGVsIG1vZG8gKGNoYXQgbyBhZ2VudGUpXG4gIGNvbnN0IFttb2RlLCBzZXRNb2RlXSA9IHVzZVN0YXRlPFwiY2hhdFwiIHwgXCJhZ2VudFwiPihcImNoYXRcIik7XG5cbiAgLy8gRXN0YWRvIHBhcmEgcmFzdHJlYXIgc2kgZWwgYWdlbnRlIGVzdMOhIGVqZWN1dGFuZG8gbcO6bHRpcGxlcyBhY2Npb25lc1xuICBjb25zdCBbaXNBdXRvRXhlY3V0aW5nLCBzZXRJc0F1dG9FeGVjdXRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbYWN0aW9uc1F1ZXVlLCBzZXRBY3Rpb25zUXVldWVdID0gdXNlU3RhdGU8YW55W10+KFtdKTtcblxuICAvLyBJbmljaWFsaXphciBlbCBDb21tYW5kRXhlY3V0b3JTZXJ2aWNlIGNvbiBlbCBleGVjdXRvciBhY3R1YWxcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBpZiAoY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQpIHtcbiAgICAgIENvbW1hbmRFeGVjdXRvclNlcnZpY2Uuc2V0RXhlY3V0b3IoY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQpO1xuICAgICAgY29uc29sZS5sb2coXCJDb21tYW5kRXhlY3V0b3JTZXJ2aWNlIGluaWNpYWxpemFkbyBjb24gw6l4aXRvXCIpO1xuICAgIH1cbiAgfSwgW2NvbW1hbmRFeGVjdXRvci5jdXJyZW50XSk7XG5cbiAgLy8gRnVuY2nDs24gcGFyYSByZWluaWNpYXIgZWwgY2hhdFxuICBjb25zdCByZXNldENoYXQgPSAoKSA9PiB7XG4gICAgc2V0TWVzc2FnZXMoW1xuICAgICAge1xuICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICBjb250ZW50OiBtb2RlID09PSBcImNoYXRcIlxuICAgICAgICAgID8gXCJIb2xhLCBzb3kgdHUgYXNpc3RlbnRlIGRlIGVkaWNpw7NuIGRlIHZpZGVvLiDCv0VuIHF1w6kgcHVlZG8gYXl1ZGFydGU/XCJcbiAgICAgICAgICA6IFwiSG9sYSwgc295IHR1IGFzaXN0ZW50ZSBhdXTDs25vbW8gZGUgZWRpY2nDs24gZGUgdmlkZW8uIERpbWUgcXXDqSBxdWllcmVzIGhhY2VyIGNvbiB0dSB2aWRlbyB5IGxvIGhhcsOpIGF1dG9tw6F0aWNhbWVudGUgcG9yIHRpLiBQdWVkbyBlZGl0YXIsIHJlY29ydGFyLCBhw7FhZGlyIHRleHRvcywgaW3DoWdlbmVzLCBtw7pzaWNhIHkgbcOhcy5cIixcbiAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICBpc0luaXRpYWw6IHRydWVcbiAgICAgIH0sXG4gICAgXSk7XG4gICAgc2V0SW5wdXQoXCJcIik7XG4gICAgc2V0SW1hZ2VGaWxlKG51bGwpO1xuICAgIHNldEltYWdlUHJldmlldyhudWxsKTtcbiAgICBzZXRMYXN0VXBsb2FkZWRJbWFnZVVybChcIlwiKTtcbiAgICBzZXRBY3Rpb25zUXVldWUoW10pO1xuICAgIHNldElzQXV0b0V4ZWN1dGluZyhmYWxzZSk7XG4gIH07XG5cbiAgLy8gU2Nyb2xsIGFsIMO6bHRpbW8gbWVuc2FqZVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIG1lc3NhZ2VzRW5kUmVmLmN1cnJlbnQ/LnNjcm9sbEludG9WaWV3KHsgYmVoYXZpb3I6IFwic21vb3RoXCIgfSk7XG4gIH0sIFttZXNzYWdlcywgaXNMb2FkaW5nXSk7XG5cbiAgLy8gQWN0dWFsaXphciBlbCBlamVjdXRvciBkZSBjb21hbmRvcyBjdWFuZG8gY2FtYmllIGVsIHN0YXRlTWFuYWdlclxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbW1hbmRFeGVjdXRvci5jdXJyZW50ID0gY3JlYXRlVmlkZW9Db21tYW5kRXhlY3V0b3Ioc3RhdGVNYW5hZ2VyKTtcbiAgICAvLyBBY3R1YWxpemFyIGVsIHNlcnZpY2lvIGNvbiBsYSBudWV2YSBpbnN0YW5jaWEgZGVsIGVqZWN1dG9yXG4gICAgQ29tbWFuZEV4ZWN1dG9yU2VydmljZS5zZXRFeGVjdXRvcihjb21tYW5kRXhlY3V0b3IuY3VycmVudCk7XG4gICAgY29uc29sZS5sb2coXCJDb21tYW5kRXhlY3V0b3JTZXJ2aWNlIGFjdHVhbGl6YWRvIGNvbiB1bmEgbnVldmEgaW5zdGFuY2lhIGRlbCBlamVjdXRvclwiKTtcbiAgfSwgW3N0YXRlTWFuYWdlcl0pO1xuXG4gIC8vIE1hbmVqYXIgY2xpY2sgZW4gZWwgYm90w7NuIGRlIGltYWdlblxuICBjb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKCkgPT4ge1xuICAgIGZpbGVJbnB1dFJlZi5jdXJyZW50Py5jbGljaygpO1xuICB9O1xuXG4gIC8vIE1hbmVqYXIgc2VsZWNjacOzbiBkZSBhcmNoaXZvIGRlIGltYWdlblxuICBjb25zdCBoYW5kbGVGaWxlQ2hhbmdlID0gKGU6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzPy5bMF07XG4gICAgaWYgKGZpbGUpIHtcbiAgICAgIHNldEltYWdlRmlsZShmaWxlKTtcbiAgICAgIGNvbnN0IHByZXZpZXdVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgc2V0SW1hZ2VQcmV2aWV3KHByZXZpZXdVcmwpO1xuICAgIH1cbiAgfTtcblxuICAvLyBFbGltaW5hciBsYSBpbWFnZW4gc2VsZWNjaW9uYWRhXG4gIGNvbnN0IGhhbmRsZVJlbW92ZUltYWdlID0gKCkgPT4ge1xuICAgIHNldEltYWdlRmlsZShudWxsKTtcbiAgICBzZXRJbWFnZVByZXZpZXcobnVsbCk7XG4gICAgaWYgKGZpbGVJbnB1dFJlZi5jdXJyZW50KSBmaWxlSW5wdXRSZWYuY3VycmVudC52YWx1ZSA9ICcnO1xuICB9O1xuXG4gIC8vIFN1YmlyIGltYWdlbiBhbCBzZXJ2aWRvclxuICBjb25zdCB1cGxvYWRJbWFnZSA9IGFzeW5jIChmaWxlOiBGaWxlKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICB0cnkge1xuICAgICAgc2V0SXNVcGxvYWRpbmcodHJ1ZSk7XG4gICAgICAvLyBPYnRlbmVyIFVSTCBmaXJtYWRhIHBhcmEgc3ViaXIgbGEgaW1hZ2VuXG4gICAgICBjb25zdCB1cGxvYWREZXRhaWxzID0gYXdhaXQgY3JlYXRlVXBsb2Fkc0RldGFpbHMoZmlsZS5uYW1lLCBmaWxlKTtcblxuICAgICAgLy8gU2kgbm8gZXMgdW4gbW9jayBsb2NhbCwgcHJvY2VkZXIgY29uIGxhIGNhcmdhXG4gICAgICBpZiAodXBsb2FkRGV0YWlscy51cGxvYWRVcmwgIT09IFwibG9jYWwtbW9ja1wiKSB7XG4gICAgICAgIC8vIFN1YmlyIGxhIGltYWdlblxuICAgICAgICBhd2FpdCBmZXRjaCh1cGxvYWREZXRhaWxzLnVwbG9hZFVybCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgYm9keTogZmlsZSxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogZmlsZS50eXBlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLy8gTm8gc2UgbmVjZXNpdGEgaGFjZXIgZmV0Y2ggc2kgZXMgdW4gbW9jayBsb2NhbCAoZGF0YVVSTClcblxuICAgICAgLy8gUmV0b3JuYXIgbGEgVVJMIHDDumJsaWNhIGRlIGxhIGltYWdlblxuICAgICAgcmV0dXJuIHVwbG9hZERldGFpbHMudXJsO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWwgc3ViaXIgbGEgaW1hZ2VuOlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzZSBwdWRvIHN1YmlyIGxhIGltYWdlbi4gSW50w6ludGFsbyBkZSBudWV2by5cIik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzVXBsb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRnVuY2nDs24gcGFyYSBwcm9jZXNhciBhdXRvbcOhdGljYW1lbnRlIGFjY2lvbmVzIHJlY29ub2NpZGFzXG4gIGNvbnN0IHByb2Nlc3NBdXRvQWN0aW9ucyA9IGFzeW5jICh1c2VyTWVzc2FnZTogc3RyaW5nLCBlbGVtZW50RGF0YTogYW55KSA9PiB7XG4gICAgaWYgKCFlbGVtZW50RGF0YSB8fCAhZWxlbWVudERhdGEuZGV0ZWN0ZWQgfHwgIWVsZW1lbnREYXRhLmVsZW1lbnQpIHJldHVybiBudWxsO1xuXG4gICAgLy8gQ3JlYXIgdW4gb2JqZXRvIHBhcmEgbGFzIGFjY2lvbmVzIGRldGVjdGFkYXNcbiAgICBjb25zdCBhY3Rpb25zTGlzdCA9IFtdO1xuICAgIGNvbnN0IHByaW1hcnlBY3Rpb24gPSB7XG4gICAgICB0eXBlOiBlbGVtZW50RGF0YS5lbGVtZW50LnR5cGUsXG4gICAgICBkYXRhOiBlbGVtZW50RGF0YS5lbGVtZW50LFxuICAgICAgZXhlY3V0ZWQ6IGZhbHNlLFxuICAgICAgY29uZmlkZW5jZTogZWxlbWVudERhdGEuY29uZmlkZW5jZVxuICAgIH07XG5cbiAgICBhY3Rpb25zTGlzdC5wdXNoKHByaW1hcnlBY3Rpb24pO1xuXG4gICAgLy8gVmVyaWZpY2FyIHNpIGhheSBhY2Npb25lcyBhZGljaW9uYWxlcyBlbiBlbCBwYXlsb2FkXG4gICAgaWYgKGVsZW1lbnREYXRhLmFkZGl0aW9uYWxBY3Rpb25zICYmIEFycmF5LmlzQXJyYXkoZWxlbWVudERhdGEuYWRkaXRpb25hbEFjdGlvbnMpKSB7XG4gICAgICBlbGVtZW50RGF0YS5hZGRpdGlvbmFsQWN0aW9ucy5mb3JFYWNoKGFjdGlvbiA9PiB7XG4gICAgICAgIGlmIChhY3Rpb24gJiYgYWN0aW9uLnR5cGUpIHtcbiAgICAgICAgICBhY3Rpb25zTGlzdC5wdXNoKHtcbiAgICAgICAgICAgIHR5cGU6IGFjdGlvbi50eXBlLFxuICAgICAgICAgICAgZGF0YTogYWN0aW9uLFxuICAgICAgICAgICAgZXhlY3V0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgY29uZmlkZW5jZTogYWN0aW9uLmNvbmZpZGVuY2UgfHwgMC44XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChhY3Rpb25zTGlzdC5sZW5ndGggPT09IDApIHJldHVybiBudWxsO1xuXG4gICAgY29uc29sZS5sb2coYE1vZG8gQUdFTlRFOiBEZXRlY3RhZGFzICR7YWN0aW9uc0xpc3QubGVuZ3RofSBhY2Npb25lcyBhIHByb2Nlc2FyIGF1dG9tw6F0aWNhbWVudGVgKTtcblxuICAgIC8vIEHDsWFkaXIgbGFzIGFjY2lvbmVzIGEgbGEgY29sYSB5IGNvbWVuemFyIHByb2Nlc2FtaWVudG9cbiAgICBzZXRBY3Rpb25zUXVldWUoYWN0aW9uc0xpc3QpO1xuICAgIHNldElzQXV0b0V4ZWN1dGluZyh0cnVlKTtcblxuICAgIHJldHVybiBhY3Rpb25zTGlzdDtcbiAgfTtcblxuICAvLyBGdW5jacOzbiBwYXJhIGVqZWN1dGFyIGxhIHNpZ3VpZW50ZSBhY2Npw7NuIGVuIGxhIGNvbGFcbiAgY29uc3QgZXhlY3V0ZU5leHRBY3Rpb24gPSBhc3luYyAoKSA9PiB7XG4gICAgaWYgKCFpc0F1dG9FeGVjdXRpbmcgfHwgYWN0aW9uc1F1ZXVlLmxlbmd0aCA9PT0gMCkge1xuICAgICAgc2V0SXNBdXRvRXhlY3V0aW5nKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBPYnRlbmVyIGxhIHByaW1lcmEgYWNjacOzbiBubyBlamVjdXRhZGFcbiAgICBjb25zdCBhY3Rpb25JbmRleCA9IGFjdGlvbnNRdWV1ZS5maW5kSW5kZXgoYSA9PiAhYS5leGVjdXRlZCk7XG4gICAgaWYgKGFjdGlvbkluZGV4ID09PSAtMSkge1xuICAgICAgc2V0SXNBdXRvRXhlY3V0aW5nKGZhbHNlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBhY3Rpb24gPSBhY3Rpb25zUXVldWVbYWN0aW9uSW5kZXhdO1xuICAgIGNvbnN0IGZpbmFsUmVzcG9uc2VSZWYgPSB7IGN1cnJlbnQ6IFwiXCIgfTtcblxuICAgIC8vIFNpbXVsYXIgdW4gZWxlbWVudG8gZGUgZGF0b3MgcGFyYSBwcm9jZXNhclxuICAgIGNvbnN0IG1vY2tFbGVtZW50RGF0YSA9IHtcbiAgICAgIGRldGVjdGVkOiB0cnVlLFxuICAgICAgY29uZmlkZW5jZTogYWN0aW9uLmNvbmZpZGVuY2UgfHwgMC44LFxuICAgICAgZWxlbWVudDogYWN0aW9uLmRhdGFcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKGBFamVjdXRhbmRvIGFjY2nDs24gJHthY3Rpb24udHlwZX06YCwgYWN0aW9uLmRhdGEpO1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcHJvY2Vzc0RldGVjdGVkRWxlbWVudChcbiAgICAgICAgbW9ja0VsZW1lbnREYXRhLFxuICAgICAgICBjb21tYW5kRXhlY3V0b3IsXG4gICAgICAgIGZpbmFsUmVzcG9uc2VSZWYsXG4gICAgICAgIHRpbWVsaW5lLFxuICAgICAgICBsYXN0VXBsb2FkZWRJbWFnZVVybCxcbiAgICAgICAgXCJcIlxuICAgICAgKTtcblxuICAgICAgLy8gTWFyY2FyIGNvbW8gZWplY3V0YWRhXG4gICAgICBjb25zdCB1cGRhdGVkUXVldWUgPSBbLi4uYWN0aW9uc1F1ZXVlXTtcbiAgICAgIHVwZGF0ZWRRdWV1ZVthY3Rpb25JbmRleF0uZXhlY3V0ZWQgPSB0cnVlO1xuICAgICAgdXBkYXRlZFF1ZXVlW2FjdGlvbkluZGV4XS5yZXN1bHQgPSByZXN1bHQ7XG4gICAgICBzZXRBY3Rpb25zUXVldWUodXBkYXRlZFF1ZXVlKTtcblxuICAgICAgLy8gQcOxYWRpciBtZW5zYWplIGRlIGNvbmZpcm1hY2nDs24gc29sbyBzaSBlcyB1bmEgYWNjacOzbiByZWxldmFudGVcbiAgICAgIGlmIChyZXN1bHQuZWxlbWVudEFkZGVkKSB7XG4gICAgICAgIHNldE1lc3NhZ2VzKHByZXYgPT4gW1xuICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGDinJMgJHtmaW5hbFJlc3BvbnNlUmVmLmN1cnJlbnR9YCxcbiAgICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKClcbiAgICAgICAgICB9XG4gICAgICAgIF0pO1xuICAgICAgfVxuXG4gICAgICAvLyBQcm9jZXNhciBsYSBzaWd1aWVudGUgYWNjacOzbiBkZXNwdcOpcyBkZSB1biBicmV2ZSByZXRyYXNvXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IGV4ZWN1dGVOZXh0QWN0aW9uKCksIDUwMCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhbCBlamVjdXRhciBhY2Npw7NuOlwiLCBlcnJvcik7XG4gICAgICBjb25zdCB1cGRhdGVkUXVldWUgPSBbLi4uYWN0aW9uc1F1ZXVlXTtcbiAgICAgIHVwZGF0ZWRRdWV1ZVthY3Rpb25JbmRleF0uZXhlY3V0ZWQgPSB0cnVlO1xuICAgICAgdXBkYXRlZFF1ZXVlW2FjdGlvbkluZGV4XS5lcnJvciA9IGVycm9yLm1lc3NhZ2UgfHwgXCJFcnJvciBkZXNjb25vY2lkb1wiO1xuICAgICAgc2V0QWN0aW9uc1F1ZXVlKHVwZGF0ZWRRdWV1ZSk7XG5cbiAgICAgIC8vIENvbnRpbnVhciBjb24gbGEgc2lndWllbnRlIGFjY2nDs24gYSBwZXNhciBkZWwgZXJyb3JcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gZXhlY3V0ZU5leHRBY3Rpb24oKSwgNTAwKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRWZlY3RvIHBhcmEgZWplY3V0YXIgYWNjaW9uZXMgZW4gY29sYVxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChpc0F1dG9FeGVjdXRpbmcgJiYgYWN0aW9uc1F1ZXVlLmxlbmd0aCA+IDApIHtcbiAgICAgIGV4ZWN1dGVOZXh0QWN0aW9uKCk7XG4gICAgfVxuICB9LCBbaXNBdXRvRXhlY3V0aW5nLCBhY3Rpb25zUXVldWVdKTtcblxuICAvLyBGdW5jacOzbiBwYXJhIGVudmlhciBtZW5zYWplXG4gIGNvbnN0IGhhbmRsZVNlbmRNZXNzYWdlID0gYXN5bmMgKCkgPT4ge1xuICAgIGlmICgoIWlucHV0LnRyaW0oKSAmJiAhaW1hZ2VGaWxlKSB8fCBpc0xvYWRpbmcpIHJldHVybjtcblxuICAgIGxldCB1c2VyTWVzc2FnZTogTWVzc2FnZSA9IHtcbiAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICBjb250ZW50OiBpbnB1dCxcbiAgICAgIHJvbGU6IFwidXNlclwiLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH07XG5cbiAgICBsZXQgdXBsb2FkZWRJbWFnZVVybCA9IFwiXCI7XG4gICAgLy8gVmFyaWFibGUgcGFyYSByYXN0cmVhciBsYSBVUkwgZGUgbGEgaW1hZ2VuIGFjdHVhbCBwYXJhIGVzdGEgc29saWNpdHVkIGVzcGVjw61maWNhXG4gICAgbGV0IGN1cnJlbnRJbWFnZVVybEZvclRoaXNSZXF1ZXN0ID0gXCJcIjtcblxuICAgIC8vIFNpIGhheSB1bmEgaW1hZ2VuIHBhcmEgc3ViaXIsIHByb2Nlc2FybGFcbiAgICBpZiAoaW1hZ2VGaWxlKSB7XG4gICAgICB0cnkge1xuICAgICAgICB1cGxvYWRlZEltYWdlVXJsID0gYXdhaXQgdXBsb2FkSW1hZ2UoaW1hZ2VGaWxlKTtcbiAgICAgICAgdXNlck1lc3NhZ2UuaW1hZ2VVcmwgPSB1cGxvYWRlZEltYWdlVXJsO1xuICAgICAgICAvLyBHdWFyZGFyIGxhIFVSTCBkZSBsYSBpbWFnZW4gcGFyYSBwb3NpYmxlcyByZWZlcmVuY2lhcyBmdXR1cmFzXG4gICAgICAgIHNldExhc3RVcGxvYWRlZEltYWdlVXJsKHVwbG9hZGVkSW1hZ2VVcmwpO1xuICAgICAgICAvLyBJbXBvcnRhbnRlOiBHdWFyZGFyIGxhIFVSTCBhY3R1YWwgcGFyYSBlc3RhIHNvbGljaXR1ZCBlc3BlY8OtZmljYVxuICAgICAgICBjdXJyZW50SW1hZ2VVcmxGb3JUaGlzUmVxdWVzdCA9IHVwbG9hZGVkSW1hZ2VVcmw7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiSW1hZ2VuIHN1YmlkYSBleGl0b3NhbWVudGU6XCIsIHVwbG9hZGVkSW1hZ2VVcmwuc3Vic3RyaW5nKDAsIDEwMCkgKyBcIi4uLlwiKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBlbiBsYSBzdWJpZGEgZGUgaW1hZ2VuOlwiLCBlcnJvcik7XG4gICAgICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbXG4gICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogKERhdGUubm93KCkgKyAxKS50b1N0cmluZygpLFxuICAgICAgICAgICAgY29udGVudDogXCJFcnJvciBhbCBzdWJpciBsYSBpbWFnZW4uIFBvciBmYXZvciwgaW50w6ludGFsbyBkZSBudWV2by4gRGV0YWxsZXM6IFwiICtcbiAgICAgICAgICAgICAgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJFcnJvciBkZXNjb25vY2lkb1wiKSxcbiAgICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSk7XG4gICAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBw7FhZGlyIG1lbnNhamUgZGVsIHVzdWFyaW9cbiAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIHVzZXJNZXNzYWdlXSk7XG4gICAgc2V0SW5wdXQoXCJcIik7XG4gICAgc2V0SW1hZ2VGaWxlKG51bGwpO1xuICAgIHNldEltYWdlUHJldmlldyhudWxsKTtcbiAgICBpZiAoZmlsZUlucHV0UmVmLmN1cnJlbnQpIGZpbGVJbnB1dFJlZi5jdXJyZW50LnZhbHVlID0gJyc7XG4gICAgc2V0SXNMb2FkaW5nKHRydWUpO1xuXG4gICAgdHJ5IHtcbiAgICAgIC8vIEVudmlhciBhIGxhIEFQSSBwYXJhIHByb2Nlc2FtaWVudG8gZW4gbGVuZ3VhamUgbmF0dXJhbFxuICAgICAgY29uc3QgYXBpTWVzc2FnZXMgPSBtZXNzYWdlc1xuICAgICAgICAuY29uY2F0KHVzZXJNZXNzYWdlKVxuICAgICAgICAubWFwKG1zZyA9PiB7XG4gICAgICAgICAgLy8gU2kgZWwgbWVuc2FqZSB0aWVuZSB1bmEgaW1hZ2VuLCBjcmVhciB1biBmb3JtYXRvIGVzcGVjaWFsIHBhcmEgZWwgY29udGVuaWRvXG4gICAgICAgICAgaWYgKG1zZy5pbWFnZVVybCkge1xuICAgICAgICAgICAgLy8gU2kgZXMgdW5hIFVSTCBkZSBkYXRvcyAoY29taWVuemEgY29uIGRhdGE6KSwgdXNhciB1biBtYXJjYWRvciBlc3BlY2lhbFxuICAgICAgICAgICAgY29uc3QgaXNEYXRhVXJsID0gbXNnLmltYWdlVXJsLnN0YXJ0c1dpdGgoJ2RhdGE6Jyk7XG4gICAgICAgICAgICBjb25zdCBpbWFnZVVybFRvU2VuZCA9IGlzRGF0YVVybFxuICAgICAgICAgICAgICA/ICdbSU1BR0VOX0FESlVOVEFdJ1xuICAgICAgICAgICAgICA6IGBbSU1BR0VOOiAke21zZy5pbWFnZVVybH1dYDtcblxuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgcm9sZTogbXNnLnJvbGUsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IGAke21zZy5jb250ZW50IHx8ICcnfSAke2ltYWdlVXJsVG9TZW5kfWBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJvbGU6IG1zZy5yb2xlLFxuICAgICAgICAgICAgY29udGVudDogbXNnLmNvbnRlbnRcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcblxuICAgICAgLy8gTW9kaWZpY2FyIGVsIG1lbnNhamUgZGUgY29udGV4dG8gc2Vnw7puIGVsIG1vZG9cbiAgICAgIGNvbnN0IG1vZGVJbnN0cnVjdGlvbnMgPSBtb2RlID09PSBcImNoYXRcIlxuICAgICAgICA/IFwiRWwgdXN1YXJpbyBwdWVkZSBleHByZXNhciBlbiBsZW5ndWFqZSBuYXR1cmFsIGxhIG5lY2VzaWRhZCBkZSBhZ3JlZ2FyIGVsZW1lbnRvcyBhbCB2aWRlby5cIlxuICAgICAgICA6IFwiRWwgdXN1YXJpbyBlc3BlcmEgcXVlIGVqZWN1dGVzIGF1dG9tw6F0aWNhbWVudGUgbGFzIGFjY2lvbmVzIHF1ZSBzb2xpY2l0ZS4gSWRlbnRpZmljYSB0b2RhcyBsYXMgYWNjaW9uZXMgcG9zaWJsZXMgZGUgZWRpY2nDs24gZGUgdmlkZW8gZW4gZWwgbWVuc2FqZSB5IEVKRUNVVEEgY2FkYSB1bmEgc2VjdWVuY2lhbG1lbnRlIHNpbiBwZWRpciBjb25maXJtYWNpw7NuLlwiO1xuXG4gICAgICAvLyBBw7FhZGlyIGNvbnRleHRvIGRlbCBlZGl0b3IgcGFyYSBsYSBJQSBleHRlcm5hXG4gICAgICBjb25zdCBjb250ZXh0TWVzc2FnZSA9IHtcbiAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgIGNvbnRlbnQ6IGBcbkNvbnRleHRvIGFjdHVhbCBkZWwgZWRpdG9yIGRlIHZpZGVvOlxuLSBQb3NpY2nDs24gYWN0dWFsIChzZWd1bmRvcyk6ICR7cGxheWVyUmVmPy5jdXJyZW50Py5nZXRDdXJyZW50VGltZSA/IE1hdGguZmxvb3IoKHBsYXllclJlZi5jdXJyZW50LmdldEN1cnJlbnRUaW1lKCkgfHwgMCkgKiAxMDApIC8gMTAwIDogMH1cbi0gRHVyYWNpw7NuIGRlbCBwcm95ZWN0byAoc2VndW5kb3MpOiAke3RpbWVsaW5lPy5kdXJhdGlvbiA/IE1hdGguZmxvb3IodGltZWxpbmUuZHVyYXRpb24gLyAxMDAwKSA6IDB9XG4tIE7Dum1lcm8gZGUgZXNjZW5hczogJHtzY2VuZXM/Lmxlbmd0aCB8fCAwfVxuLSBOw7ptZXJvIGRlIGVsZW1lbnRvcyBlbiBlbCB0aW1lbGluZTogJHsodGltZWxpbmU/LmNhbnZhcz8uZ2V0T2JqZWN0cz8uKCkgfHwgW10pLmxlbmd0aCAtIDEgPiAwID8gKHRpbWVsaW5lPy5jYW52YXM/LmdldE9iamVjdHM/LigpIHx8IFtdKS5sZW5ndGggLSAxIDogMH1cbiR7bGFzdFVwbG9hZGVkSW1hZ2VVcmwgPyBgLSDDmmx0aW1hIGltYWdlbiBjb21wYXJ0aWRhIHBvciBlbCB1c3VhcmlvIGRpc3BvbmlibGUgcGFyYSB1c2FyYCA6ICcnfVxuXG4ke21vZGVJbnN0cnVjdGlvbnN9XG5FamVtcGxvczpcbi0gXCJQb24gdW4gdMOtdHVsbyBxdWUgZGlnYSAnQmllbnZlbmlkb3MnIGFsIGluaWNpb1wiXG4tIFwiUXVpZXJvIHVuIHRleHRvIGJsYW5jbyBxdWUgZGlnYSAnRmluJyBhbCBmaW5hbCBkZWwgdmlkZW9cIlxuLSBcIk5lY2VzaXRvIHVuYSBpbWFnZW4gZW4gZWwgc2VndW5kbyAxMFwiXG4tIFwiQ29sb2NhIHVuIHZpZGVvIGRlIGludHJvZHVjY2nDs24gYWwgcHJpbmNpcGlvXCJcblxuU2kgZWwgdXN1YXJpbyBhZGp1bnRhIHVuYSBpbWFnZW4gZW4gZWwgbWVuc2FqZSwgbGEgVVJMIGVzdGFyw6EgZW4gZm9ybWF0byBbSU1BR0VOOiB1cmxfZGVfbGFfaW1hZ2VuXS5cbkRlYmVzIGRldGVjdGFyIHNpIHF1aWVyZSBhZ3JlZ2FyIGVzdGEgaW1hZ2VuIGFsIHZpZGVvIHkgZW4gcXXDqSBtb21lbnRvIHRlbXBvcmFsLlxuYFxuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9haS1jaGF0Jywge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBtZXNzYWdlczogW2NvbnRleHRNZXNzYWdlLCAuLi5hcGlNZXNzYWdlc10sXG4gICAgICAgICAgICAvLyBVc2FyIGxhIFVSTCBkZSBsYSBpbWFnZW4gYWN0dWFsIHBhcmEgZXN0YSBzb2xpY2l0dWQgc2kgZXhpc3RlLFxuICAgICAgICAgICAgLy8gZGUgbG8gY29udHJhcmlvIHVzYXIgbGEgw7psdGltYSBVUkwgZ3VhcmRhZGFcbiAgICAgICAgICAgIGxhc3RJbWFnZVVybDogY3VycmVudEltYWdlVXJsRm9yVGhpc1JlcXVlc3QgfHwgbGFzdFVwbG9hZGVkSW1hZ2VVcmwgfHwgXCJcIixcbiAgICAgICAgICAgIC8vIEluZGljYXIgc2kgZXN0YW1vcyBlbiBtb2RvIGFnZW50ZVxuICAgICAgICAgICAgaXNBZ2VudE1vZGU6IG1vZGUgPT09IFwiYWdlbnRcIlxuICAgICAgICAgIH0pLFxuICAgICAgICAgIC8vIEFncmVnYXIgdGltZW91dCBwYXJhIGV2aXRhciBlc3BlcmFzIGluZmluaXRhc1xuICAgICAgICAgIHNpZ25hbDogQWJvcnRTaWduYWwudGltZW91dCgxNTAwMCkgLy8gMTUgc2VndW5kb3MgbcOheGltb1xuICAgICAgICB9KTtcblxuICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBFcnJvciBkZSBBUEk6ICR7cmVzcG9uc2Uuc3RhdHVzfSAke3Jlc3BvbnNlLnN0YXR1c1RleHR9YCk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuXG4gICAgICAgIC8vIEFzZWd1cmFyc2UgZGUgcXVlIGRhdGEubWVzc2FnZS5jb250ZW50IGV4aXN0ZVxuICAgICAgICBjb25zdCBhaVJlc3BvbnNlID0gZGF0YT8ubWVzc2FnZT8uY29udGVudCB8fCBcIkxvIHNpZW50bywgbm8gcHVkZSBlbnRlbmRlciB0dSBzb2xpY2l0dWQuXCI7XG5cbiAgICAgICAgLy8gT2J0ZW5lciBsb3MgZGF0b3MgZGVsIGVsZW1lbnRvIHNpIGV4aXN0ZW4gKGNvbiB2ZXJpZmljYWNpw7NuIHNlZ3VyYSlcbiAgICAgICAgY29uc3QgZWxlbWVudERhdGEgPSBkYXRhPy5lbGVtZW50RGF0YTtcblxuICAgICAgICAvLyBQZXJzb25hbGl6YXIgY29tcG9ydGFtaWVudG8gc2Vnw7puIGVsIG1vZG9cbiAgICAgICAgaWYgKG1vZGUgPT09IFwiYWdlbnRcIiAmJiBlbGVtZW50RGF0YSAmJiBlbGVtZW50RGF0YS5kZXRlY3RlZCkge1xuICAgICAgICAgIC8vIEVuIG1vZG8gYWdlbnRlLCBwcm9jZXNhciBhdXRvbcOhdGljYW1lbnRlIGxhcyBhY2Npb25lcyBkZXRlY3RhZGFzXG4gICAgICAgICAgY29uc3QgYWN0aW9ucyA9IGF3YWl0IHByb2Nlc3NBdXRvQWN0aW9ucyh1c2VyTWVzc2FnZS5jb250ZW50LCBlbGVtZW50RGF0YSk7XG5cbiAgICAgICAgICAvLyBDcmVhciBtZW5zYWplIGluaWNpYWwgZGVsIGFnZW50ZSAoc29sbyBzZSBtb3N0cmFyw6EgZXN0byBpbmljaWFsbWVudGUpXG4gICAgICAgICAgY29uc3QgYWdlbnRNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IGFpUmVzcG9uc2UsXG4gICAgICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIH07XG5cbiAgICAgICAgICAvLyBBw7FhZGlyIG1lbnNhamUgaW5pY2lhbCBkZWwgYWdlbnRlXG4gICAgICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgYWdlbnRNZXNzYWdlXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRW4gbW9kbyBjaGF0LCBjb21wb3J0YW1pZW50byBub3JtYWxcbiAgICAgICAgICAvLyBWYXJpYWJsZSBwYXJhIGxhIHJlc3B1ZXN0YSBmaW5hbFxuICAgICAgICAgIGxldCBmaW5hbFJlc3BvbnNlID0gYWlSZXNwb25zZTtcbiAgICAgICAgICAvLyBDcmVhciB1bmEgcmVmZXJlbmNpYSBhIGxhIHJlc3B1ZXN0YSBmaW5hbCBwYXJhIHF1ZSBzZWEgYWNjZXNpYmxlIGVuIGxhIGZ1bmNpw7NuIHByb2Nlc2Fkb3JhXG4gICAgICAgICAgY29uc3QgZmluYWxSZXNwb25zZVJlZiA9IHsgY3VycmVudDogZmluYWxSZXNwb25zZSB9O1xuICAgICAgICAgIGxldCBlbGVtZW50QWRkZWQgPSBmYWxzZTtcblxuICAgICAgICAgIC8vIFVzYXIgbGEgZnVuY2nDs24gZGUgcHJvY2VzYW1pZW50byBkZSBlbGVtZW50b3NcbiAgICAgICAgICBjb25zdCBwcm9jZXNzUmVzdWx0ID0gYXdhaXQgcHJvY2Vzc0RldGVjdGVkRWxlbWVudChcbiAgICAgICAgICAgIGVsZW1lbnREYXRhLFxuICAgICAgICAgICAgY29tbWFuZEV4ZWN1dG9yLFxuICAgICAgICAgICAgZmluYWxSZXNwb25zZVJlZixcbiAgICAgICAgICAgIHRpbWVsaW5lLFxuICAgICAgICAgICAgbGFzdFVwbG9hZGVkSW1hZ2VVcmwsXG4gICAgICAgICAgICBjdXJyZW50SW1hZ2VVcmxGb3JUaGlzUmVxdWVzdFxuICAgICAgICAgICk7XG5cbiAgICAgICAgICBmaW5hbFJlc3BvbnNlID0gcHJvY2Vzc1Jlc3VsdC5maW5hbFJlc3BvbnNlO1xuICAgICAgICAgIGVsZW1lbnRBZGRlZCA9IHByb2Nlc3NSZXN1bHQuZWxlbWVudEFkZGVkO1xuXG4gICAgICAgICAgLy8gQ3JlYXIgbWVuc2FqZSBjb24gbG9zIGRldGFsbGVzIGNvbXBsZXRvc1xuICAgICAgICAgIGNvbnN0IG5ld01lc3NhZ2U6IE1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICAgICAgY29udGVudDogZmluYWxSZXNwb25zZSB8fCBkYXRhLm1lc3NhZ2UuY29udGVudCxcbiAgICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfTtcblxuICAgICAgICAgIC8vIFNpIHNlIGRldGVjdMOzIHVuIGVsZW1lbnRvIGRlIG3DunNpY2EsIGFncmVnYXIgbGFzIG9wY2lvbmVzIGFsIG1lbnNhamVcbiAgICAgICAgICBpZiAoZWxlbWVudERhdGE/LmRldGVjdGVkICYmXG4gICAgICAgICAgICAgIGVsZW1lbnREYXRhLmVsZW1lbnQ/LnR5cGUgPT09IFwibXVzaWNcIiAmJlxuICAgICAgICAgICAgICBBcnJheS5pc0FycmF5KGVsZW1lbnREYXRhLmVsZW1lbnQub3B0aW9ucykpIHtcblxuICAgICAgICAgICAgbmV3TWVzc2FnZS5tdXNpY09wdGlvbnMgPSBlbGVtZW50RGF0YS5lbGVtZW50Lm9wdGlvbnM7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk9wY2lvbmVzIGRlIG3DunNpY2EgYWdyZWdhZGFzIGFsIG1lbnNhamU6XCIsIG5ld01lc3NhZ2UubXVzaWNPcHRpb25zKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBBY3R1YWxpemFyIG1lbnNhamVzXG4gICAgICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgbmV3TWVzc2FnZV0pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChhcGlFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZW4gbGEgY29tdW5pY2FjacOzbiBjb24gbGEgQVBJOlwiLCBhcGlFcnJvcik7XG5cbiAgICAgICAgLy8gTWVuc2FqZSBkZSBlcnJvciBlc3BlY8OtZmljbyBkZSBBUElcbiAgICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFtcbiAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAoRGF0ZS5ub3coKSArIDEpLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBjb250ZW50OiBcIkxvIHNpZW50bywgaGEgb2N1cnJpZG8gdW4gZXJyb3IgYWwgY29tdW5pY2Fyc2UgY29uIGVsIHNlcnZpY2lvIGRlIElBLiBQb3IgZmF2b3IsIGludGVudGEgZGUgbnVldm8gZW4gdW5vcyBtb21lbnRvcy5cIixcbiAgICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgXSk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhbCBwcm9jZXNhciBlbCBtZW5zYWplOlwiLCBlcnJvcik7XG5cbiAgICAgIC8vIERldGVybWluYXIgbWVuc2FqZSBkZSBlcnJvciBhcHJvcGlhZG9cbiAgICAgIGxldCBlcnJvck1lc3NhZ2UgPSBcIkxvIHNpZW50bywgaGEgb2N1cnJpZG8gdW4gZXJyb3IgYWwgcHJvY2VzYXIgdHUgbWVuc2FqZS5cIjtcblxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgICAgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJ0aW1lb3V0XCIpIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJhYm9ydFwiKSkge1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IFwiTGEgc29saWNpdHVkIGhhIHRhcmRhZG8gZGVtYXNpYWRvLiBQcnVlYmEgY29uIHVuIG1lbnNhamUgbcOhcyBjb3J0by5cIjtcbiAgICAgICAgfSBlbHNlIGlmIChlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwibmV0d29ya1wiKSB8fCBlcnJvci5tZXNzYWdlLmluY2x1ZGVzKFwiZmV0Y2hcIikpIHtcbiAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBcIlBhcmVjZSBxdWUgaGF5IHVuIHByb2JsZW1hIGRlIGNvbmV4acOzbi4gVmVyaWZpY2EgdHUgY29uZXhpw7NuIGEgaW50ZXJuZXQgZSBpbnRlbnRhIGRlIG51ZXZvLlwiO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIE1lbnNhamUgZGUgZXJyb3JcbiAgICAgIHNldE1lc3NhZ2VzKChwcmV2KSA9PiBbXG4gICAgICAgIC4uLnByZXYsXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogKERhdGUubm93KCkgKyAxKS50b1N0cmluZygpLFxuICAgICAgICAgIGNvbnRlbnQ6IGVycm9yTWVzc2FnZSxcbiAgICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgfSxcbiAgICAgIF0pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICAvLyBGdW5jacOzbiBwYXJhIG1hbmVqYXIgbGEgc2VsZWNjacOzbiBkZSBtw7pzaWNhXG4gIGNvbnN0IGhhbmRsZU11c2ljU2VsZWN0ID0gYXN5bmMgKG11c2ljUGF0aDogc3RyaW5nKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKGBVc3VhcmlvIHNlbGVjY2lvbsOzIG3DunNpY2E6ICR7bXVzaWNQYXRofWApO1xuXG4gICAgICAvLyBDYWxjdWxhciBsYSBkdXJhY2nDs24gZGVsIHZpZGVvIGVuIHNlZ3VuZG9zIHVzYW5kbyBlbCBkdXJhdGlvbiBkZWwgc3RvcmVcbiAgICAgIGNvbnN0IHZpZGVvRHVyYXRpb24gPSBkdXJhdGlvbiA/IE1hdGguZmxvb3IoZHVyYXRpb24gLyAxMDAwKSA6IDMwMDsgLy8gNSBtaW51dG9zIHBvciBkZWZlY3RvXG4gICAgICBjb25zb2xlLmxvZyhgRHVyYWNpw7NuIGRlbCB2aWRlbyAoZGVzZGUgdXNlU3RvcmUpOiAke3ZpZGVvRHVyYXRpb259IHNlZ3VuZG9zYCk7XG5cbiAgICAgIC8vIENvbmZpZ3VyYWNpw7NuIGRlIG9wY2lvbmVzIHBhcmEgbGEgbcO6c2ljYVxuICAgICAgY29uc3QgbXVzaWNPcHRpb25zID0ge1xuICAgICAgICBzdGFydFRpbWU6IDAsXG4gICAgICAgIGVuZFRpbWU6IHZpZGVvRHVyYXRpb24sIC8vIFVzYXIgdG9kYSBsYSBkdXJhY2nDs24gZGVsIHZpZGVvXG4gICAgICAgIHZvbHVtZTogODAsXG4gICAgICAgIGZhZGVJbjogdHJ1ZSxcbiAgICAgICAgZmFkZU91dDogdHJ1ZSxcbiAgICAgICAgcmVzcGVjdE5hdGl2ZUR1cmF0aW9uOiB0cnVlIC8vIFJlc3BldGFyIGxhIGR1cmFjacOzbiBuYXR1cmFsIGRlIGxhIG3DunNpY2FcbiAgICAgIH07XG5cbiAgICAgIC8vIEHDsWFkaXIgbGEgbcO6c2ljYSBhbCB0aW1lbGluZSAocmVzcGV0YXLDoSBsYSBkdXJhY2nDs24gbmF0dXJhbCBzaSBlcyBtw6FzIGNvcnRhIHF1ZSBlbCB2aWRlbylcbiAgICAgIGNvbW1hbmRFeGVjdXRvci5jdXJyZW50LmFkZE11c2ljKG11c2ljUGF0aCwgbXVzaWNPcHRpb25zKTtcblxuICAgICAgLy8gT2J0ZW5lciB1biBub21icmUgYW1pZ2FibGUgcGFyYSBsYSBtw7pzaWNhXG4gICAgICBjb25zdCBnZXRNdXNpY0ZyaWVuZGx5TmFtZSA9IChwYXRoKSA9PiB7XG4gICAgICAgIGNvbnN0IGZpbGVuYW1lID0gcGF0aC5zcGxpdCgnLycpLnBvcCgpIHx8IHBhdGg7XG4gICAgICAgIGlmIChmaWxlbmFtZSA9PT0gXCJzb25nMS5tcDNcIikgcmV0dXJuIFwiTcO6c2ljYSBFbmVyZ8OpdGljYVwiO1xuICAgICAgICBpZiAoZmlsZW5hbWUgPT09IFwic29uZzIubXAzXCIpIHJldHVybiBcIk1lbG9kw61hIFJlbGFqYW50ZVwiO1xuICAgICAgICByZXR1cm4gZmlsZW5hbWU7XG4gICAgICB9O1xuXG4gICAgICAvLyBBw7FhZGlyIHVuIG1lbnNhamUgZGUgY29uZmlybWFjacOzblxuICAgICAgY29uc3QgbXVzaWNOYW1lID0gZ2V0TXVzaWNGcmllbmRseU5hbWUobXVzaWNQYXRoKTtcbiAgICAgIGNvbnN0IGNvbmZpcm1hdGlvbk1zZzogTWVzc2FnZSA9IHtcbiAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgY29udGVudDogYEhlIGHDsWFkaWRvIFwiJHttdXNpY05hbWV9XCIgYSB0dSB2aWRlby4gTGEgbcO6c2ljYSBzZSBhZGFwdGFyw6EgYXV0b23DoXRpY2FtZW50ZTogc2kgZXMgbcOhcyBjb3J0YSBxdWUgZWwgdmlkZW8sIG1hbnRlbmRyw6Egc3UgZHVyYWNpw7NuIG5hdHVyYWw7IHNpIGVzIG3DoXMgbGFyZ2EsIHNlIGFqdXN0YXLDoSBhIGxhIGR1cmFjacOzbiBkZWwgdmlkZW8gKCR7dmlkZW9EdXJhdGlvbn0gc2VndW5kb3MpLmAsXG4gICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH07XG5cbiAgICAgIHNldE1lc3NhZ2VzKHByZXYgPT4gWy4uLnByZXYsIGNvbmZpcm1hdGlvbk1zZ10pO1xuXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhbCBhw7FhZGlyIG3DunNpY2E6XCIsIGVycm9yKTtcblxuICAgICAgLy8gTWVuc2FqZSBkZSBlcnJvclxuICAgICAgY29uc3QgZXJyb3JNc2c6IE1lc3NhZ2UgPSB7XG4gICAgICAgIGlkOiBEYXRlLm5vdygpLnRvU3RyaW5nKCksXG4gICAgICAgIGNvbnRlbnQ6IGBObyBzZSBwdWRvIGHDsWFkaXIgbGEgbcO6c2ljYS4gRXJyb3I6ICR7ZXJyb3IubWVzc2FnZSB8fCBcIkVycm9yIGRlc2Nvbm9jaWRvXCJ9YCxcbiAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgfTtcblxuICAgICAgc2V0TWVzc2FnZXMocHJldiA9PiBbLi4ucHJldiwgZXJyb3JNc2ddKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gTWFuZWphciBjYW1iaW8gZGUgbW9kb1xuICBjb25zdCBoYW5kbGVNb2RlQ2hhbmdlID0gKG5ld01vZGU6IFwiY2hhdFwiIHwgXCJhZ2VudFwiKSA9PiB7XG4gICAgLy8gU2kgZWwgbW9kbyBlcyBkaWZlcmVudGUsIGNhbWJpYXIgeSByZWluaWNpYXIgbGEgY29udmVyc2FjacOzblxuICAgIGlmIChuZXdNb2RlICE9PSBtb2RlKSB7XG4gICAgICBzZXRNb2RlKG5ld01vZGUpO1xuXG4gICAgICAvLyBNZW5zYWplIGluaWNpYWwgZXNwZWPDrWZpY28gc2Vnw7puIGVsIG1vZG9cbiAgICAgIGNvbnN0IGluaXRpYWxNZXNzYWdlID0gbmV3TW9kZSA9PT0gXCJjaGF0XCJcbiAgICAgICAgPyBcIkhvbGEsIHNveSB0dSBhc2lzdGVudGUgZGUgZWRpY2nDs24gZGUgdmlkZW8uIMK/RW4gcXXDqSBwdWVkbyBheXVkYXJ0ZT9cIlxuICAgICAgICA6IFwiwqFIb2xhISBTb3kgZWwgYXNpc3RlbnRlIGF1dMOzbm9tbyBkZSBlZGljacOzbi4gQSBkaWZlcmVuY2lhIGRlbCBtb2RvIGNoYXQsIGVqZWN1dGFyw6kgZGlyZWN0YW1lbnRlIGxhcyBhY2Npb25lcyBxdWUgbWUgcGlkYXMgc2luIG5lY2VzaWRhZCBkZSBjb25maXJtYWNpw7NuLiBQdWVkbyByZWFsaXphciB2YXJpYXMgYWNjaW9uZXMgZW4gc2VjdWVuY2lhLCBjb21vOlxcblxcbuKAoiBcXFwiQWdyZWdhIHVuIHTDrXR1bG8gYWwgaW5pY2lvIHkgc3VidMOtdHVsb3MgZW4gdG9kbyBlbCB2aWRlb1xcXCJcXG7igKIgXFxcIlBvbiB1biB0ZXh0byBkZSBiaWVudmVuaWRhLCBhw7FhZGUgbcO6c2ljYSB5IHJlY29ydGEgbGFzIHBhcnRlcyBpbm5lY2VzYXJpYXNcXFwiXFxuXFxuU29sbyBkaW1lIHF1w6kgbmVjZXNpdGFzIHkgbG8gaGFyw6kgYXV0b23DoXRpY2FtZW50ZS5cIjtcblxuICAgICAgLy8gUmVpbmljaWFyIGxhIGNvbnZlcnNhY2nDs24gY29uIGVsIG1lbnNhamUgYXByb3BpYWRvXG4gICAgICBzZXRNZXNzYWdlcyhbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgICAgIGNvbnRlbnQ6IGluaXRpYWxNZXNzYWdlLFxuICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIC8vIE1hcmNhciBlbCBtZW5zYWplIGNvbW8gaW5pY2lhbCBwYXJhIGV2aXRhciBtb3N0cmFyIHJhem9uYW1pZW50b1xuICAgICAgICAgIGlzSW5pdGlhbDogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgXSk7XG5cbiAgICAgIC8vIExpbXBpYXIgb3Ryb3MgZXN0YWRvc1xuICAgICAgc2V0SW5wdXQoXCJcIik7XG4gICAgICBzZXRJbWFnZUZpbGUobnVsbCk7XG4gICAgICBzZXRJbWFnZVByZXZpZXcobnVsbCk7XG4gICAgICBzZXRMYXN0VXBsb2FkZWRJbWFnZVVybChcIlwiKTtcbiAgICAgIHNldEFjdGlvbnNRdWV1ZShbXSk7XG4gICAgICBzZXRJc0F1dG9FeGVjdXRpbmcoZmFsc2UpO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBoLWZ1bGwgZmxleC1jb2wgYmctW3JnYigyMCwxMCwzMCldIGJvcmRlci1sIGJvcmRlci1wdXJwbGUtODAwLzMwXCI+XG4gICAgICB7LyogSGVhZGVyIGNvbiB0b2dnbGUgKi99XG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImJnLVtyZ2IoMzAsMTUsNDUpXSBwLTMgZmxleCBqdXN0aWZ5LWJldHdlZW4gaXRlbXMtY2VudGVyIGJvcmRlci1iIGJvcmRlci1wdXJwbGUtODAwLzMwXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleCBpdGVtcy1jZW50ZXIgZ2FwLTJcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImgtNyB3LTcgcm91bmRlZCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1wdXJwbGUtNzAwXCI+XG4gICAgICAgICAgICA8U3BhcmtsZXMgY2xhc3NOYW1lPVwiaC0zLjUgdy0zLjUgdGV4dC13aGl0ZVwiIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGgzIGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQtd2hpdGUgdGV4dC1zbVwiPkFzaXN0ZW50ZSBJQTwvaDM+XG4gICAgICAgIDwvZGl2PlxuXG4gICAgICAgIHsvKiBUb2dnbGUgZW50cmUgQ2hhdCB5IEFnZW50ZSAqL31cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBiZy1bcmdiKDQwLDIwLDYwKV0gcm91bmRlZC1mdWxsIHAtMC41IG14LWF1dG9cIj5cbiAgICAgICAgICA8YnV0dG9uXG4gICAgICAgICAgICBvbkNsaWNrPXsoKSA9PiBoYW5kbGVNb2RlQ2hhbmdlKFwiY2hhdFwiKX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT17YHB4LTMgcHktMSB0ZXh0LXhzIHJvdW5kZWQtZnVsbCB0cmFuc2l0aW9uLWFsbCAke1xuICAgICAgICAgICAgICBtb2RlID09PSBcImNoYXRcIlxuICAgICAgICAgICAgICAgID8gXCJiZy1wdXJwbGUtNzAwIHRleHQtd2hpdGUgZm9udC1tZWRpdW1cIlxuICAgICAgICAgICAgICAgIDogXCJ0ZXh0LXB1cnBsZS0zMDAgaG92ZXI6dGV4dC13aGl0ZVwiXG4gICAgICAgICAgICB9YH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICBDaGF0XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgICAgPGJ1dHRvblxuICAgICAgICAgICAgb25DbGljaz17KCkgPT4gaGFuZGxlTW9kZUNoYW5nZShcImFnZW50XCIpfVxuICAgICAgICAgICAgY2xhc3NOYW1lPXtgcHgtMyBweS0xIHRleHQteHMgcm91bmRlZC1mdWxsIHRyYW5zaXRpb24tYWxsICR7XG4gICAgICAgICAgICAgIG1vZGUgPT09IFwiYWdlbnRcIlxuICAgICAgICAgICAgICAgID8gXCJiZy1wdXJwbGUtNzAwIHRleHQtd2hpdGUgZm9udC1tZWRpdW1cIlxuICAgICAgICAgICAgICAgIDogXCJ0ZXh0LXB1cnBsZS0zMDAgaG92ZXI6dGV4dC13aGl0ZVwiXG4gICAgICAgICAgICB9YH1cbiAgICAgICAgICA+XG4gICAgICAgICAgICBBZ2VudGVcbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGl0ZW1zLWNlbnRlciBnYXAtMVwiPlxuICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgIHZhcmlhbnQ9XCJnaG9zdFwiXG4gICAgICAgICAgICBzaXplPVwiaWNvblwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJoLTcgdy03IHJvdW5kZWQgaG92ZXI6YmctcHVycGxlLTgwMC8yMFwiXG4gICAgICAgICAgICBvbkNsaWNrPXtyZXNldENoYXR9XG4gICAgICAgICAgICB0aXRsZT1cIlJlaW5pY2lhciBjb252ZXJzYWNpw7NuXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8UmVmcmVzaEN3IGNsYXNzTmFtZT1cImgtMy41IHctMy41IHRleHQtemluYy0zMDBcIiAvPlxuICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7Lyogw4FyZWEgZGUgbWVuc2FqZXMgY29uIGFsdHVyYSBmaWphIHkgbcOheGltYSAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIG92ZXJmbG93LWhpZGRlbiByZWxhdGl2ZSBtYXgtaC1bY2FsYygxMDAlLTEyMHB4KV1cIj5cbiAgICAgICAgPFNjcm9sbEFyZWEgY2xhc3NOYW1lPVwiaC1mdWxsIHByLTIgY2hhdC1zY3JvbGxiYXIgYWJzb2x1dGUgaW5zZXQtMFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwicC0zIHNwYWNlLXktM1wiPlxuICAgICAgICAgICAge21lc3NhZ2VzLm1hcCgobWVzc2FnZSkgPT4gKFxuICAgICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgICAga2V5PXttZXNzYWdlLmlkfVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggZmxleC1jb2wgYW5pbWF0ZS1mYWRlSW4gJHtcbiAgICAgICAgICAgICAgICAgIG1lc3NhZ2Uucm9sZSA9PT0gXCJhc3Npc3RhbnRcIiA/IFwiaXRlbXMtc3RhcnRcIiA6IFwiaXRlbXMtZW5kXCJcbiAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgPlxuICAgICAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT17YG1heC13LVs4NSVdIHJvdW5kZWQtbWQgcHgtNCBweS0yICR7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Uucm9sZSA9PT0gXCJhc3Npc3RhbnRcIlxuICAgICAgICAgICAgICAgICAgICAgID8gXCJiZy1bcmdiKDQwLDIwLDYwKV0gdGV4dC16aW5jLTIwMFwiXG4gICAgICAgICAgICAgICAgICAgICAgOiBcImJnLXB1cnBsZS03MDAgdGV4dC13aGl0ZVwiXG4gICAgICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndoaXRlc3BhY2UtcHJlLXdyYXAgdGV4dC1zbVwiPnttZXNzYWdlLmNvbnRlbnR9PC9kaXY+XG4gICAgICAgICAgICAgICAgICB7bWVzc2FnZS5pbWFnZVVybCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMiByb3VuZGVkIG92ZXJmbG93LWhpZGRlblwiPlxuICAgICAgICAgICAgICAgICAgICAgIDxpbWdcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyYz17bWVzc2FnZS5pbWFnZVVybH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGFsdD1cIkltYWdlbiBhZGp1bnRhXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIm1heC1oLTQ4IG1heC13LWZ1bGwgb2JqZWN0LWNvbnRhaW5cIlxuICAgICAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgICAgICAgIHttZXNzYWdlLm11c2ljT3B0aW9ucyAmJiBtZXNzYWdlLm11c2ljT3B0aW9ucy5sZW5ndGggPiAwICYmIChcbiAgICAgICAgICAgICAgICAgICAgPE11c2ljT3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgIG9wdGlvbnM9e21lc3NhZ2UubXVzaWNPcHRpb25zfVxuICAgICAgICAgICAgICAgICAgICAgIG9uU2VsZWN0TXVzaWM9e2hhbmRsZU11c2ljU2VsZWN0fVxuICAgICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICAgKX1cblxuICAgICAgICAgICAgICAgICAgey8qIFNlY2Npw7NuIGRlIHJhem9uYW1pZW50byAoc29sbyBlbiBtb2RvIGFnZW50ZSwgcGFyYSBtZW5zYWplcyBkZWwgYXNpc3RlbnRlLCB5IG5vIHBhcmEgZWwgbWVuc2FqZSBpbmljaWFsKSAqL31cbiAgICAgICAgICAgICAgICAgIHttb2RlID09PSBcImFnZW50XCIgJiYgbWVzc2FnZS5yb2xlID09PSBcImFzc2lzdGFudFwiICYmICFtZXNzYWdlLmlzSW5pdGlhbCAmJiAoXG4gICAgICAgICAgICAgICAgICAgIDxSZWFzb25pbmdTZWN0aW9uIHJlYXNvbmluZz17Z2VuZXJhdGVSZWFzb25pbmcobWVzc2FnZS5jb250ZW50KX0gLz5cbiAgICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2B0ZXh0LVsxMHB4XSBtdC0wLjUgcHgtMSAke21lc3NhZ2Uucm9sZSA9PT0gXCJhc3Npc3RhbnRcIiA/IFwidGV4dC16aW5jLTUwMFwiIDogXCJ0ZXh0LXB1cnBsZS0zMDBcIn1gfT5cbiAgICAgICAgICAgICAgICAgIHttZXNzYWdlLnRpbWVzdGFtcC50b0xvY2FsZVRpbWVTdHJpbmcoW10sIHsgaG91cjogJzItZGlnaXQnLCBtaW51dGU6ICcyLWRpZ2l0JyB9KX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICApKX1cbiAgICAgICAgICAgIHtpc0xvYWRpbmcgJiYgPFRoaW5raW5nQW5pbWF0aW9uIC8+fVxuICAgICAgICAgICAgPGRpdiByZWY9e21lc3NhZ2VzRW5kUmVmfSBjbGFzc05hbWU9XCJoLTJcIiAvPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L1Njcm9sbEFyZWE+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIMOBcmVhIGRlIHZpc3RhIHByZXZpYSBkZSBpbWFnZW4gKi99XG4gICAgICB7aW1hZ2VQcmV2aWV3ICYmIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZSBteC0zIG10LTEgbWItMiBoLTI0IGJnLVtyZ2IoMzAsMTUsNDUpXSBwLTIgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXIgcm91bmRlZCBib3JkZXIgYm9yZGVyLXB1cnBsZS04MDAvMzBcIj5cbiAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICB2YXJpYW50PVwiZ2hvc3RcIlxuICAgICAgICAgICAgc2l6ZT1cImljb25cIlxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWJzb2x1dGUgcmlnaHQtMSB0b3AtMSB6LTEwIGgtNSB3LTUgcm91bmRlZC1mdWxsIGJnLWJsYWNrLzUwXCJcbiAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVJlbW92ZUltYWdlfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxYIGNsYXNzTmFtZT1cImgtMyB3LTMgdGV4dC13aGl0ZVwiIC8+XG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPGltZ1xuICAgICAgICAgICAgc3JjPXtpbWFnZVByZXZpZXd9XG4gICAgICAgICAgICBhbHQ9XCJWaXN0YSBwcmV2aWFcIlxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibWF4LWgtZnVsbCBtYXgtdy1mdWxsIG9iamVjdC1jb250YWluXCJcbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG5cbiAgICAgIHsvKiDDgXJlYSBkZSBlbnRyYWRhIHNpbXBsaWZpY2FkYSAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctW3JnYigzMCwxNSw0NSldIHAtMyBib3JkZXItdCBib3JkZXItcHVycGxlLTgwMC8zMFwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IHJvdW5kZWQgb3ZlcmZsb3ctaGlkZGVuIGJvcmRlciBib3JkZXItcHVycGxlLTkwMC81MCBmbGV4LTEgYmctW3JnYigyNSwxMiw0MCldXCI+XG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIHZhcmlhbnQ9XCJnaG9zdFwiXG4gICAgICAgICAgICAgIHNpemU9XCJpY29uXCJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwiaC05IHctOSBiZy10cmFuc3BhcmVudCBob3ZlcjpiZy1wdXJwbGUtODAwLzIwXCJcbiAgICAgICAgICAgICAgb25DbGljaz17aGFuZGxlSW1hZ2VDbGlja31cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPEltYWdlSWNvbiBjbGFzc05hbWU9XCJoLTQgdy00IHRleHQtemluYy00MDBcIiAvPlxuICAgICAgICAgICAgPC9CdXR0b24+XG5cbiAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICB2YWx1ZT17aW5wdXR9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0SW5wdXQoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBvbktleURvd249eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIgJiYgIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgIGhhbmRsZVNlbmRNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVzY3JpYmUgdHUgbWVuc2FqZS4uLlwiXG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXgtMSBib3JkZXItMCBiZy10cmFuc3BhcmVudCBoLTkgZm9jdXM6cmluZy0wIGZvY3VzLXZpc2libGU6cmluZy0wIHRleHQtemluYy0yMDBcIlxuICAgICAgICAgICAgLz5cblxuICAgICAgICAgICAgPEJ1dHRvblxuICAgICAgICAgICAgICBvbkNsaWNrPXtoYW5kbGVTZW5kTWVzc2FnZX1cbiAgICAgICAgICAgICAgZGlzYWJsZWQ9eyghaW5wdXQudHJpbSgpICYmICFpbWFnZUZpbGUpIHx8IGlzTG9hZGluZ31cbiAgICAgICAgICAgICAgY2xhc3NOYW1lPXtgaC05IHB4LTMgcm91bmRlZC1ub25lICR7XG4gICAgICAgICAgICAgICAgKCFpbnB1dC50cmltKCkgJiYgIWltYWdlRmlsZSkgfHwgaXNMb2FkaW5nXG4gICAgICAgICAgICAgICAgICA/IFwiYmctcHVycGxlLTkwMC81MCBjdXJzb3Itbm90LWFsbG93ZWQgdGV4dC1wdXJwbGUtMzAwLzUwXCJcbiAgICAgICAgICAgICAgICAgIDogXCJiZy1wdXJwbGUtNzAwIGhvdmVyOmJnLXB1cnBsZS02MDAgdGV4dC13aGl0ZVwiXG4gICAgICAgICAgICAgIH1gfVxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aXNMb2FkaW5nIHx8IGlzVXBsb2FkaW5nID8gKFxuICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT1cImgtNCB3LTQgYW5pbWF0ZS1zcGluXCIgLz5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8U2VuZCBjbGFzc05hbWU9XCJoLTMuNSB3LTMuNVwiIC8+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L0J1dHRvbj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cblxuICAgICAgPGlucHV0XG4gICAgICAgIHR5cGU9XCJmaWxlXCJcbiAgICAgICAgcmVmPXtmaWxlSW5wdXRSZWZ9XG4gICAgICAgIG9uQ2hhbmdlPXtoYW5kbGVGaWxlQ2hhbmdlfVxuICAgICAgICBhY2NlcHQ9XCJpbWFnZS8qXCJcbiAgICAgICAgY2xhc3NOYW1lPVwiaGlkZGVuXCJcbiAgICAgICAgZGlzYWJsZWQ9e2lzTG9hZGluZ31cbiAgICAgIC8+XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbi8vIEZ1bmNpw7NuIHBhcmEgZ2VuZXJhciByYXpvbmFtaWVudG8gZmljdGljaW8gYmFzYWRvIGVuIGVsIGNvbnRlbmlkbyBkZWwgbWVuc2FqZVxuZnVuY3Rpb24gZ2VuZXJhdGVSZWFzb25pbmcoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgLy8gU2kgZXN0YW1vcyBlbiBtb2RvIGFnZW50ZSBhdXTDs25vbW8sIG1vc3RyYXIgdW4gcmF6b25hbWllbnRvIG3DoXMgb3JpZW50YWRvIGEgbGEgYWNjacOzblxuICBpZiAoY29udGVudC5pbmNsdWRlcyhcIltIZSBcIikgfHwgY29udGVudC5pbmNsdWRlcyhcIuKck1wiKSkge1xuICAgIHJldHVybiBgUFJPQ0VTTyBERSBFSkVDVUNJw5NOOlxuMS4gQW5hbGl6YXIgc29saWNpdHVkIGRlbCB1c3VhcmlvXG4yLiBJZGVudGlmaWNhciBhY2Npb25lcyByZXF1ZXJpZGFzXG4zLiBFamVjdXRhciBzZWN1ZW5jaWFsbWVudGUgbGFzIGFjY2lvbmVzXG40LiBDb25maXJtYXIgcmVzdWx0YWRvXG5cbkVWQUxVQUNJw5NOOlxu4oaSIEFjY2nDs24gY29tcGxldGFkYSBjb24gw6l4aXRvXG7ihpIgUmVzdWx0YWRvIHZpc2libGUgZW4gbGEgbMOtbmVhIGRlIHRpZW1wb2A7XG4gIH1cblxuICAvLyBQb3IgZGVmZWN0bywgZGV2b2x2ZXIgZWwgcmF6b25hbWllbnRvIGVzdMOhbmRhclxuICByZXR1cm4gYEFOw4FMSVNJUzpcbuKAoiBUaXBvOiBTb2xpY2l0dWQgZGUgZWRpY2nDs25cbuKAoiBDb250ZXh0bzogVGltZWxpbmUgZGVsIHZpZGVvXG7igKIgUHJpb3JpZGFkOiBBbHRhXG5cblBST0NFU086XG4xLiBJZGVudGlmaWNhciBpbnRlbmNpw7NuIOKGkiBNb2RpZmljYWNpw7NuIGRlIHZpZGVvXG4yLiBFeHRyYWVyIHBhcsOhbWV0cm9zIOKGkiBQb3NpY2nDs24sIGR1cmFjacOzbiwgY29udGVuaWRvXG4zLiBTZWxlY2Npb25hciBoZXJyYW1pZW50YXMg4oaSIEVkaXRvciBhcHJvcGlhZG9cbjQuIEVqZWN1dGFyIGFjY2nDs24g4oaSIEFwbGljYXIgY2FtYmlvc1xuXG5SRVNVTFRBRE86XG7ihpIgQWNjacOzbiBjb21wbGV0YWRhXG7ihpIgVmVyaWZpY2FjacOzbiB2aXN1YWwgcmVxdWVyaWRhYDtcbn1cbiJdLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZVJlZiIsInVzZUVmZmVjdCIsIkJ1dHRvbiIsIklucHV0IiwiU2Nyb2xsQXJlYSIsIlNlbmQiLCJMb2FkZXIyIiwiSW1hZ2VJY29uIiwiWCIsIlNwYXJrbGVzIiwiUmVmcmVzaEN3IiwidXNlRGF0YVN0YXRlIiwidXNlU3RhdGVNYW5hZ2VyIiwiY3JlYXRlVmlkZW9Db21tYW5kRXhlY3V0b3IiLCJjcmVhdGVVcGxvYWRzRGV0YWlscyIsIkNvbW1hbmRFeGVjdXRvclNlcnZpY2UiLCJ1c2VTdG9yZSIsImV4dHJhY3RJbWFnZVRpbWVzRnJvbU1lc3NhZ2UiLCJtZXNzYWdlQ29udGVudCIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJzdGFydFRpbWVQYXR0ZXJucyIsImVuZFRpbWVQYXR0ZXJucyIsImlzQXRTdGFydCIsInRlc3QiLCJpc0F0RW5kIiwicGF0dGVybiIsIm1hdGNoIiwidG9TdHJpbmciLCJpbmNsdWRlcyIsInBhcnNlSW50IiwiTXVzaWNPcHRpb25zIiwib3B0aW9ucyIsIm9uU2VsZWN0TXVzaWMiLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJnZXRGcmllbmRseU5hbWUiLCJtdXNpY1BhdGgiLCJmaWxlbmFtZSIsInNwbGl0IiwicG9wIiwiZGl2IiwiY2xhc3NOYW1lIiwibWFwIiwiaW5kZXgiLCJtdXNpY05hbWUiLCJidXR0b24iLCJvbkNsaWNrIiwic3ZnIiwieG1sbnMiLCJ2aWV3Qm94IiwiZmlsbCIsInBhdGgiLCJkIiwic3Ryb2tlV2lkdGgiLCJzdHJva2UiLCJzdHJva2VMaW5lY2FwIiwic3Ryb2tlTGluZWpvaW4iLCJwcm9jZXNzRGV0ZWN0ZWRFbGVtZW50IiwiZWxlbWVudERhdGEiLCJjb21tYW5kRXhlY3V0b3IiLCJmaW5hbFJlc3BvbnNlUmVmIiwidGltZWxpbmUiLCJsYXN0VXBsb2FkZWRJbWFnZVVybCIsImN1cnJlbnRJbWFnZVVybEZvclRoaXNSZXF1ZXN0IiwiZWxlbWVudEFkZGVkIiwiZmluYWxSZXNwb25zZSIsImN1cnJlbnQiLCJkZXRlY3RlZCIsImNvbmZpZGVuY2UiLCJlbGVtZW50IiwidHlwZSIsImNvbnRlbnQiLCJ0ZXh0T3B0aW9ucyIsImNvbG9yIiwidG9Mb3dlckNhc2UiLCJhZGRUZXh0IiwiaW1hZ2VPcHRpb25zIiwicG9zaXRpb24iLCJ4IiwieSIsImNvbnNvbGUiLCJsb2ciLCJ2aWRlb0R1cmF0aW9uIiwiZHVyYXRpb24iLCJNYXRoIiwiZmxvb3IiLCJtYXgiLCJpc0dlbmVyaWNVcmwiLCJ1cmwiLCJpc0xvY2FsSW1hZ2UiLCJzdGFydHNXaXRoIiwiaW1hZ2VVcmwiLCJhZGRJbWFnZSIsInZpZGVvT3B0aW9ucyIsInZpZGVvVXJsIiwiYWRkVmlkZW8iLCJzdWJ0aXRsZU9wdGlvbnMiLCJncm91cFdvcmRzIiwidW5kZWZpbmVkIiwiYWRkU3VidGl0bGVzIiwic2VnbWVudHMiLCJzZWdtZW50Iiwic2VnbWVudHNGb3JtYXR0ZWQiLCJzIiwiam9pbiIsInJlc3VsdCIsInJlbW92ZVNlZ21lbnRzIiwiZXJyb3IiLCJtZXNzYWdlIiwiY29tcGFjdFRpbWVsaW5lIiwic21hcnRUcmltIiwiVGhpbmtpbmdBbmltYXRpb24iLCJzcGFuIiwic3R5bGUiLCJhbmltYXRpb25EZWxheSIsIlJlYXNvbmluZ1NlY3Rpb24iLCJyZWFzb25pbmciLCJpc09wZW4iLCJzZXRJc09wZW4iLCJ3aWR0aCIsImhlaWdodCIsInBvbHlsaW5lIiwicG9pbnRzIiwiQUlDaGF0IiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImlkIiwicm9sZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJpbnB1dCIsInNldElucHV0IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiaW1hZ2VGaWxlIiwic2V0SW1hZ2VGaWxlIiwiaW1hZ2VQcmV2aWV3Iiwic2V0SW1hZ2VQcmV2aWV3IiwiaXNVcGxvYWRpbmciLCJzZXRJc1VwbG9hZGluZyIsInNldExhc3RVcGxvYWRlZEltYWdlVXJsIiwiZmlsZUlucHV0UmVmIiwibWVzc2FnZXNFbmRSZWYiLCJzdGF0ZU1hbmFnZXIiLCJzY2VuZXMiLCJwbGF5ZXJSZWYiLCJtb2RlIiwic2V0TW9kZSIsImlzQXV0b0V4ZWN1dGluZyIsInNldElzQXV0b0V4ZWN1dGluZyIsImFjdGlvbnNRdWV1ZSIsInNldEFjdGlvbnNRdWV1ZSIsInNldEV4ZWN1dG9yIiwicmVzZXRDaGF0Iiwibm93IiwiaXNJbml0aWFsIiwic2Nyb2xsSW50b1ZpZXciLCJiZWhhdmlvciIsImhhbmRsZUltYWdlQ2xpY2siLCJjbGljayIsImhhbmRsZUZpbGVDaGFuZ2UiLCJlIiwiZmlsZSIsInRhcmdldCIsImZpbGVzIiwicHJldmlld1VybCIsIlVSTCIsImNyZWF0ZU9iamVjdFVSTCIsImhhbmRsZVJlbW92ZUltYWdlIiwidmFsdWUiLCJ1cGxvYWRJbWFnZSIsInVwbG9hZERldGFpbHMiLCJuYW1lIiwidXBsb2FkVXJsIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiaGVhZGVycyIsIkVycm9yIiwicHJvY2Vzc0F1dG9BY3Rpb25zIiwidXNlck1lc3NhZ2UiLCJhY3Rpb25zTGlzdCIsInByaW1hcnlBY3Rpb24iLCJkYXRhIiwiZXhlY3V0ZWQiLCJwdXNoIiwiYWRkaXRpb25hbEFjdGlvbnMiLCJmb3JFYWNoIiwiYWN0aW9uIiwiZXhlY3V0ZU5leHRBY3Rpb24iLCJhY3Rpb25JbmRleCIsImZpbmRJbmRleCIsImEiLCJtb2NrRWxlbWVudERhdGEiLCJ1cGRhdGVkUXVldWUiLCJwcmV2Iiwic2V0VGltZW91dCIsImhhbmRsZVNlbmRNZXNzYWdlIiwidHJpbSIsInVwbG9hZGVkSW1hZ2VVcmwiLCJzdWJzdHJpbmciLCJhcGlNZXNzYWdlcyIsImNvbmNhdCIsIm1zZyIsImlzRGF0YVVybCIsImltYWdlVXJsVG9TZW5kIiwibW9kZUluc3RydWN0aW9ucyIsImNvbnRleHRNZXNzYWdlIiwiZ2V0Q3VycmVudFRpbWUiLCJjYW52YXMiLCJnZXRPYmplY3RzIiwicmVzcG9uc2UiLCJKU09OIiwic3RyaW5naWZ5IiwibGFzdEltYWdlVXJsIiwiaXNBZ2VudE1vZGUiLCJzaWduYWwiLCJBYm9ydFNpZ25hbCIsInRpbWVvdXQiLCJvayIsInN0YXR1cyIsInN0YXR1c1RleHQiLCJqc29uIiwiYWlSZXNwb25zZSIsImFjdGlvbnMiLCJhZ2VudE1lc3NhZ2UiLCJwcm9jZXNzUmVzdWx0IiwibmV3TWVzc2FnZSIsIm11c2ljT3B0aW9ucyIsImFwaUVycm9yIiwiZXJyb3JNZXNzYWdlIiwiaGFuZGxlTXVzaWNTZWxlY3QiLCJ2b2x1bWUiLCJmYWRlSW4iLCJmYWRlT3V0IiwicmVzcGVjdE5hdGl2ZUR1cmF0aW9uIiwiYWRkTXVzaWMiLCJnZXRNdXNpY0ZyaWVuZGx5TmFtZSIsImNvbmZpcm1hdGlvbk1zZyIsImVycm9yTXNnIiwiaGFuZGxlTW9kZUNoYW5nZSIsIm5ld01vZGUiLCJpbml0aWFsTWVzc2FnZSIsImgzIiwidmFyaWFudCIsInNpemUiLCJ0aXRsZSIsImltZyIsInNyYyIsImFsdCIsImdlbmVyYXRlUmVhc29uaW5nIiwidG9Mb2NhbGVUaW1lU3RyaW5nIiwiaG91ciIsIm1pbnV0ZSIsInJlZiIsImRpc2FibGVkIiwib25DaGFuZ2UiLCJvbktleURvd24iLCJrZXkiLCJzaGlmdEtleSIsInByZXZlbnREZWZhdWx0IiwicGxhY2Vob2xkZXIiLCJhY2NlcHQiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./components/ai-chat/index.tsx\n"));

/***/ })

});