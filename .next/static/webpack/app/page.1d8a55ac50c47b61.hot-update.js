"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/page",{

/***/ "(app-pages-browser)/./components/ai-chat/index.tsx":
/*!**************************************!*\
  !*** ./components/ai-chat/index.tsx ***!
  \**************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ AIChat; }\n/* harmony export */ });\n/* harmony import */ var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react/jsx-dev-runtime */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/jsx-dev-runtime.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(app-pages-browser)/./node_modules/next/dist/compiled/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _components_ui_button__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/components/ui/button */ \"(app-pages-browser)/./components/ui/button.tsx\");\n/* harmony import */ var _components_ui_input__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/components/ui/input */ \"(app-pages-browser)/./components/ui/input.tsx\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/sparkles.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/refresh-cw.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/x.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/image.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/loader-circle.js\");\n/* harmony import */ var _barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! __barrel_optimize__?names=ImageIcon,Loader2,RefreshCw,Send,Sparkles,X!=!lucide-react */ \"(app-pages-browser)/./node_modules/lucide-react/dist/esm/icons/send.js\");\n/* harmony import */ var _features_editor_store_use_data_state__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/features/editor/store/use-data-state */ \"(app-pages-browser)/./features/editor/store/use-data-state.ts\");\n/* harmony import */ var _features_editor_hooks_state_manager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @/features/editor/hooks/state-manager */ \"(app-pages-browser)/./features/editor/hooks/state-manager.tsx\");\n/* harmony import */ var _ai_video_commands__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./ai-video-commands */ \"(app-pages-browser)/./components/ai-chat/ai-video-commands.ts\");\n/* harmony import */ var _utils_upload__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @/utils/upload */ \"(app-pages-browser)/./utils/upload.ts\");\n/* __next_internal_client_entry_do_not_use__ default auto */ \nvar _s = $RefreshSig$();\n\n\n\n\n\n\n\n\n// Función para extraer tiempos de inicio y fin de una imagen a partir del mensaje\nfunction extractImageTimesFromMessage(messageContent) {\n    let startTime = 0;\n    let endTime = 5;\n    if (!messageContent) return {\n        startTime,\n        endTime\n    };\n    // Buscar referencias al tiempo inicial\n    const startTimePatterns = [\n        /en el segundo (\\d+)/i,\n        /desde el segundo (\\d+)/i,\n        /a partir del segundo (\\d+)/i,\n        /comenzando en el segundo (\\d+)/i,\n        /desde el minuto (\\d+)/i,\n        /en el minuto (\\d+)/i,\n        /entre los segundos (\\d+) y/i,\n        /del segundo (\\d+) al/i,\n        /empezando en (\\d+)/i,\n        /segundo (\\d+)/i,\n        /en (\\d+) segundos/i,\n        /en el (\\d+)/i\n    ];\n    // Buscar referencias al tiempo final\n    const endTimePatterns = [\n        /hasta el segundo (\\d+)/i,\n        /al segundo (\\d+)/i,\n        /terminando en el segundo (\\d+)/i,\n        /hasta el minuto (\\d+)/i,\n        /entre los segundos \\d+ y (\\d+)/i,\n        /del segundo \\d+ al (\\d+)/i,\n        /por (\\d+) segundos/i,\n        /durante (\\d+) segundos/i\n    ];\n    // Buscar palabras clave especiales\n    const isAtStart = /\\b(al inicio|al principio|al comienzo)\\b/i.test(messageContent);\n    const isAtEnd = /\\b(al final|al término|al acabar)\\b/i.test(messageContent);\n    // Procesar patrones de tiempo inicial\n    for (const pattern of startTimePatterns){\n        const match = messageContent.match(pattern);\n        if (match && match[1]) {\n            // Si es referencia a minutos, convertir a segundos\n            startTime = pattern.toString().includes(\"minuto\") ? parseInt(match[1]) * 60 : parseInt(match[1]);\n            break;\n        }\n    }\n    // Procesar patrones de tiempo final\n    for (const pattern of endTimePatterns){\n        const match = messageContent.match(pattern);\n        if (match && match[1]) {\n            if (pattern.toString().includes(\"por\") || pattern.toString().includes(\"durante\")) {\n                // Es una duración relativa, sumar al tiempo inicial\n                endTime = startTime + parseInt(match[1]);\n            } else {\n                // Es un tiempo absoluto\n                endTime = pattern.toString().includes(\"minuto\") ? parseInt(match[1]) * 60 : parseInt(match[1]);\n            }\n            break;\n        }\n    }\n    // Si se menciona \"al inicio\", establecer tiempo a 0\n    if (isAtStart) {\n        startTime = 0;\n        endTime = 5; // Por defecto 5 segundos de duración\n    }\n    // Si se menciona \"al final\", establecer valores relativos al final\n    // Nota: El valor real se ajustará en el cliente según la duración\n    if (isAtEnd) {\n        startTime = -1; // Código especial para \"final - 5 segundos\"\n        endTime = -1; // Código especial para \"final\"\n    }\n    // Si no se detectó tiempo final pero sí inicial, establecer una duración predeterminada\n    if (startTime > 0 && endTime === 5 && startTime !== 0) {\n        endTime = startTime + 5;\n    }\n    return {\n        startTime,\n        endTime\n    };\n}\n// Función para procesar elementos detectados por la IA\nconst processDetectedElement = async (elementData, commandExecutor, finalResponseRef, timeline, lastUploadedImageUrl, currentImageUrlForThisRequest)=>{\n    let elementAdded = false;\n    let finalResponse = finalResponseRef.current;\n    try {\n        // Si se detectó un elemento para agregar con confianza suficiente\n        if (elementData && elementData.detected === true && typeof elementData.confidence === \"number\" && elementData.confidence > 0.7 && elementData.element) {\n            const element = elementData.element;\n            // Procesar según el tipo de elemento\n            if (element.type === \"text\" && element.content) {\n                // Configurar opciones para el texto\n                const textOptions = {\n                    startTime: typeof element.startTime === \"number\" ? element.startTime : 0,\n                    endTime: typeof element.endTime === \"number\" ? element.endTime : typeof element.startTime === \"number\" ? element.startTime + 5 : 5\n                };\n                // Asignar color si está disponible\n                if (element.color) {\n                    textOptions.color = element.color.toLowerCase() === \"blanco\" ? \"#FFFFFF\" : element.color.toLowerCase() === \"negro\" ? \"#000000\" : element.color.toLowerCase() === \"rojo\" ? \"#FF0000\" : element.color.toLowerCase() === \"azul\" ? \"#0000FF\" : element.color.toLowerCase() === \"verde\" ? \"#00FF00\" : element.color.toLowerCase() === \"amarillo\" ? \"#FFFF00\" : element.color;\n                }\n                // Añadir el texto\n                commandExecutor.current.addText(element.content, textOptions);\n                // Actualizar respuesta\n                finalResponse += '\\n\\n[He agregado el texto \"'.concat(element.content, '\" ').concat(element.color ? \"con color \".concat(element.color, \" \") : \"\", \"desde el segundo \").concat(textOptions.startTime, \" hasta el segundo \").concat(textOptions.endTime, \"]\");\n                elementAdded = true;\n            } else if (element.type === \"image\") {\n                // Configurar opciones para la imagen\n                const imageOptions = {\n                    startTime: typeof element.startTime === \"number\" ? element.startTime : 0,\n                    endTime: typeof element.endTime === \"number\" ? element.endTime : typeof element.startTime === \"number\" ? element.startTime + 5 : 5,\n                    // Posición centrada por defecto\n                    position: {\n                        x: 0.5,\n                        y: 0.5\n                    }\n                };\n                // Registrar tiempos específicos para depuración\n                console.log(\"Tiempos de imagen recibidos de la API: startTime=\".concat(element.startTime, \", endTime=\").concat(element.endTime));\n                // Manejar casos especiales para \"al final\" del video\n                if (element.startTime === -1 || element.endTime === -1) {\n                    // Calcular la duración del video en segundos\n                    const videoDuration = (timeline === null || timeline === void 0 ? void 0 : timeline.duration) ? Math.floor(timeline.duration / 1000) : 30; // Valor predeterminado si no hay duración\n                    console.log(\"Duraci\\xf3n del video: \".concat(videoDuration, \"s\"));\n                    if (element.startTime === -1 && element.endTime === -1) {\n                        // Si ambos son -1, colocar en los últimos 5 segundos\n                        imageOptions.startTime = Math.max(0, videoDuration - 5);\n                        imageOptions.endTime = videoDuration;\n                        console.log('Ajustando para \"al final\": startTime='.concat(imageOptions.startTime, \", endTime=\").concat(imageOptions.endTime));\n                    } else if (element.startTime === -1) {\n                        // Solo startTime es -1\n                        imageOptions.startTime = Math.max(0, videoDuration - 5);\n                    } else if (element.endTime === -1) {\n                        // Solo endTime es -1\n                        imageOptions.endTime = videoDuration;\n                    }\n                }\n                console.log(\"Tiempos de imagen a aplicar: startTime=\".concat(imageOptions.startTime, \", endTime=\").concat(imageOptions.endTime));\n                // Determinar la URL de la imagen a usar\n                const isGenericUrl = element.url === \"imagen_adjunta_por_el_usuario.jpg\";\n                const isLocalImage = lastUploadedImageUrl && lastUploadedImageUrl.startsWith(\"data:\");\n                let imageUrl;\n                // PRIORIDAD 1: Usar la imagen que acaba de subirse en este mensaje específico\n                if (currentImageUrlForThisRequest) {\n                    imageUrl = currentImageUrlForThisRequest;\n                    console.log(\"Usando la imagen reci\\xe9n subida para esta solicitud espec\\xedfica\");\n                } else if (element.url && !isGenericUrl && !element.url.includes(\"/url_de_la_imagen\")) {\n                    imageUrl = element.url;\n                    console.log(\"Usando URL espec\\xedfica del elemento\");\n                } else if (isGenericUrl && lastUploadedImageUrl) {\n                    imageUrl = lastUploadedImageUrl;\n                    console.log(\"Usando la \\xfaltima imagen subida guardada\");\n                } else {\n                    // Si todo lo demás falla, usar una imagen de ejemplo\n                    imageUrl = \"https://ik.imagekit.io/wombo/images/img2.jpg\";\n                    console.log(\"Usando imagen de ejemplo como fallback\");\n                }\n                // Añadir la imagen\n                commandExecutor.current.addImage(imageUrl, imageOptions);\n                // Actualizar respuesta\n                finalResponse += \"\\n\\n[He agregado la imagen desde el segundo \".concat(imageOptions.startTime, \" hasta el segundo \").concat(imageOptions.endTime, \"]\");\n                elementAdded = true;\n            } else if (element.type === \"video\") {\n                // Configurar opciones para el video\n                const videoOptions = {\n                    startTime: typeof element.startTime === \"number\" ? element.startTime : 0,\n                    endTime: typeof element.endTime === \"number\" ? element.endTime : typeof element.startTime === \"number\" ? element.startTime + 10 : 10\n                };\n                // URL de video de ejemplo (en producción esto sería dinámico)\n                const videoUrl = \"https://cdn.designcombo.dev/videos/demo-video-4.mp4\";\n                // Añadir el video\n                commandExecutor.current.addVideo(videoUrl, videoOptions);\n                // Actualizar respuesta\n                finalResponse += \"\\n\\n[He agregado el video desde el segundo \".concat(videoOptions.startTime, \" hasta el segundo \").concat(videoOptions.endTime, \"]\");\n                elementAdded = true;\n            } else if (element.type === \"subtitles\") {\n                // Configurar opciones para los subtítulos\n                const subtitleOptions = {\n                    groupWords: element.groupWords !== undefined ? element.groupWords : true\n                };\n                // Añadir tiempos si se especificaron\n                if (typeof element.startTime === \"number\") {\n                    subtitleOptions.startTime = element.startTime;\n                }\n                if (typeof element.endTime === \"number\") {\n                    subtitleOptions.endTime = element.endTime;\n                }\n                // Añadir los subtítulos\n                commandExecutor.current.addSubtitles(subtitleOptions);\n                // Actualizar respuesta silenciosa (se maneja en otro lado)\n                elementAdded = true;\n            } else if (element.type === \"segments\" && Array.isArray(element.segments) && element.segments.length > 0) {\n                // Configurar los segmentos a eliminar\n                const segments = element.segments.map((segment)=>({\n                        startTime: typeof segment.startTime === \"number\" ? segment.startTime : 0,\n                        endTime: typeof segment.endTime === \"number\" ? segment.endTime : typeof segment.startTime === \"number\" ? segment.startTime + 5 : 5\n                    }));\n                console.log(\"Eliminando \".concat(segments.length, \" segmentos:\"), segments);\n                // Ejemplo de formato de segmentos a mostrar\n                const segmentsFormatted = segments.map((s)=>\"\".concat(s.startTime, \"-\").concat(s.endTime, \"s\")).join(\", \");\n                try {\n                    // Ejecutar la eliminación de segmentos\n                    const result = await commandExecutor.current.removeSegments(segments);\n                    if (result) {\n                        finalResponse += \"\\n\\n[He eliminado los segmentos solicitados: \".concat(segmentsFormatted, \"]\");\n                    } else {\n                        finalResponse += \"\\n\\n[No pude eliminar los segmentos solicitados. Aseg\\xfarate de que hay un elemento seleccionado en la timeline.]\";\n                    }\n                    elementAdded = true;\n                } catch (error) {\n                    console.error(\"Error al eliminar segmentos:\", error);\n                    finalResponse += \"\\n\\n[Error al intentar eliminar los segmentos: \".concat(error.message || \"Error desconocido\", \"]\");\n                }\n            } else if (element.type === \"compact\") {\n                // Ejecutar la compactación del timeline\n                console.log(\"Compactando timeline por solicitud del usuario\");\n                try {\n                    // Iniciar la compactación\n                    const result = await commandExecutor.current.compactTimeline();\n                    if (result) {\n                        finalResponse += \"\\n\\n[He compactado el timeline eliminando los espacios vac\\xedos entre elementos]\";\n                    } else {\n                        finalResponse += \"\\n\\n[No fue posible compactar el timeline. Puede que no haya elementos o espacios vac\\xedos que compactar]\";\n                    }\n                    elementAdded = true;\n                } catch (error) {\n                    console.error(\"Error al compactar el timeline:\", error);\n                    finalResponse += \"\\n\\n[Error al intentar compactar el timeline: \".concat(error.message || \"Error desconocido\", \"]\");\n                }\n            } else if (element.type === \"smartTrim\") {\n                // Ejecutar el recorte inteligente\n                console.log(\"Iniciando recorte inteligente por solicitud del usuario\");\n                try {\n                    // Mostrar mensaje de análisis en curso\n                    finalResponse += \"\\n\\n[Analizando el video para identificar las partes a eliminar...]\";\n                    // Iniciar el recorte inteligente\n                    const result = await commandExecutor.current.smartTrim();\n                    if (result) {\n                        finalResponse += \"\\n\\n[He realizado un recorte inteligente del video, eliminando las partes innecesarias y compactando el timeline]\";\n                    } else {\n                        finalResponse += \"\\n\\n[No fue posible realizar el recorte inteligente. Verifica que el video tenga una transcripci\\xf3n]\";\n                    }\n                    elementAdded = true;\n                } catch (error) {\n                    console.error(\"Error al realizar el recorte inteligente:\", error);\n                    finalResponse += \"\\n\\n[Error al intentar realizar el recorte inteligente: \".concat(error.message || \"Error desconocido\", \"]\");\n                }\n            }\n        }\n    } catch (error) {\n        console.error(\"Error al procesar elemento detectado:\", error);\n        finalResponse += \"\\n\\n[No pude procesar la solicitud debido a un error.]\";\n    }\n    return {\n        finalResponse,\n        elementAdded\n    };\n};\nfunction AIChat() {\n    _s();\n    const [messages, setMessages] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)([\n        {\n            id: \"1\",\n            content: \"Hola, soy tu asistente de edici\\xf3n de video. \\xbfEn qu\\xe9 puedo ayudarte?\",\n            role: \"assistant\",\n            timestamp: new Date()\n        }\n    ]);\n    const [input, setInput] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    const [imageFile, setImageFile] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [imagePreview, setImagePreview] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null);\n    const [isUploading, setIsUploading] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);\n    // Almacenar la última imagen subida para poder reutilizarla\n    const [lastUploadedImageUrl, setLastUploadedImageUrl] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(\"\");\n    const fileInputRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    const messagesEndRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(null);\n    // Referencia al state manager para manipular el editor\n    const stateManager = (0,_features_editor_hooks_state_manager__WEBPACK_IMPORTED_MODULE_5__.useStateManager)();\n    const { timeline, scenes, playerRef } = (0,_features_editor_store_use_data_state__WEBPACK_IMPORTED_MODULE_4__[\"default\"])();\n    const commandExecutor = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)((0,_ai_video_commands__WEBPACK_IMPORTED_MODULE_6__.createVideoCommandExecutor)(stateManager));\n    // Función para reiniciar el chat\n    const resetChat = ()=>{\n        setMessages([\n            {\n                id: Date.now().toString(),\n                content: \"Hola, soy tu asistente de edici\\xf3n de video. \\xbfEn qu\\xe9 puedo ayudarte?\",\n                role: \"assistant\",\n                timestamp: new Date()\n            }\n        ]);\n        setInput(\"\");\n        setImageFile(null);\n        setImagePreview(null);\n        setLastUploadedImageUrl(\"\");\n    };\n    // Scroll al último mensaje\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        var _messagesEndRef_current;\n        (_messagesEndRef_current = messagesEndRef.current) === null || _messagesEndRef_current === void 0 ? void 0 : _messagesEndRef_current.scrollIntoView({\n            behavior: \"smooth\"\n        });\n    }, [\n        messages\n    ]);\n    // Actualizar el ejecutor de comandos cuando cambie el stateManager\n    (0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)(()=>{\n        commandExecutor.current = (0,_ai_video_commands__WEBPACK_IMPORTED_MODULE_6__.createVideoCommandExecutor)(stateManager);\n    }, [\n        stateManager\n    ]);\n    // Manejar click en el botón de imagen\n    const handleImageClick = ()=>{\n        var _fileInputRef_current;\n        (_fileInputRef_current = fileInputRef.current) === null || _fileInputRef_current === void 0 ? void 0 : _fileInputRef_current.click();\n    };\n    // Manejar selección de archivo de imagen\n    const handleFileChange = (e)=>{\n        var _e_target_files;\n        const file = (_e_target_files = e.target.files) === null || _e_target_files === void 0 ? void 0 : _e_target_files[0];\n        if (file) {\n            setImageFile(file);\n            const previewUrl = URL.createObjectURL(file);\n            setImagePreview(previewUrl);\n        }\n    };\n    // Eliminar la imagen seleccionada\n    const handleRemoveImage = ()=>{\n        setImageFile(null);\n        setImagePreview(null);\n        if (fileInputRef.current) fileInputRef.current.value = \"\";\n    };\n    // Subir imagen al servidor\n    const uploadImage = async (file)=>{\n        try {\n            setIsUploading(true);\n            // Obtener URL firmada para subir la imagen\n            const uploadDetails = await (0,_utils_upload__WEBPACK_IMPORTED_MODULE_7__.createUploadsDetails)(file.name, file);\n            // Si no es un mock local, proceder con la carga\n            if (uploadDetails.uploadUrl !== \"local-mock\") {\n                // Subir la imagen\n                await fetch(uploadDetails.uploadUrl, {\n                    method: \"PUT\",\n                    body: file,\n                    headers: {\n                        \"Content-Type\": file.type\n                    }\n                });\n            }\n            // No se necesita hacer fetch si es un mock local (dataURL)\n            // Retornar la URL pública de la imagen\n            return uploadDetails.url;\n        } catch (error) {\n            console.error(\"Error al subir la imagen:\", error);\n            throw new Error(\"No se pudo subir la imagen. Int\\xe9ntalo de nuevo.\");\n        } finally{\n            setIsUploading(false);\n        }\n    };\n    // Función para enviar mensaje\n    const handleSendMessage = async ()=>{\n        if (!input.trim() && !imageFile || isLoading) return;\n        let userMessage = {\n            id: Date.now().toString(),\n            content: input,\n            role: \"user\",\n            timestamp: new Date()\n        };\n        let uploadedImageUrl = \"\";\n        // Variable para rastrear la URL de la imagen actual para esta solicitud específica\n        let currentImageUrlForThisRequest = \"\";\n        // Si hay una imagen para subir, procesarla\n        if (imageFile) {\n            try {\n                uploadedImageUrl = await uploadImage(imageFile);\n                userMessage.imageUrl = uploadedImageUrl;\n                // Guardar la URL de la imagen para posibles referencias futuras\n                setLastUploadedImageUrl(uploadedImageUrl);\n                // Importante: Guardar la URL actual para esta solicitud específica\n                currentImageUrlForThisRequest = uploadedImageUrl;\n                console.log(\"Imagen subida exitosamente:\", uploadedImageUrl.substring(0, 100) + \"...\");\n            } catch (error) {\n                console.error(\"Error en la subida de imagen:\", error);\n                setMessages((prev)=>[\n                        ...prev,\n                        {\n                            id: (Date.now() + 1).toString(),\n                            content: \"Error al subir la imagen. Por favor, int\\xe9ntalo de nuevo. Detalles: \" + (error instanceof Error ? error.message : \"Error desconocido\"),\n                            role: \"assistant\",\n                            timestamp: new Date()\n                        }\n                    ]);\n                setIsLoading(false);\n                return;\n            }\n        }\n        // Añadir mensaje del usuario\n        setMessages((prev)=>[\n                ...prev,\n                userMessage\n            ]);\n        setInput(\"\");\n        setImageFile(null);\n        setImagePreview(null);\n        if (fileInputRef.current) fileInputRef.current.value = \"\";\n        setIsLoading(true);\n        try {\n            var _playerRef_current, _timeline_canvas_getObjects, _timeline_canvas, _timeline_canvas_getObjects1, _timeline_canvas1;\n            // Enviar a la API para procesamiento en lenguaje natural\n            const apiMessages = messages.concat(userMessage).map((msg)=>{\n                // Si el mensaje tiene una imagen, crear un formato especial para el contenido\n                if (msg.imageUrl) {\n                    // Si es una URL de datos (comienza con data:), usar un marcador especial\n                    const isDataUrl = msg.imageUrl.startsWith(\"data:\");\n                    const imageUrlToSend = isDataUrl ? \"[IMAGEN_ADJUNTA]\" : \"[IMAGEN: \".concat(msg.imageUrl, \"]\");\n                    return {\n                        role: msg.role,\n                        content: \"\".concat(msg.content || \"\", \" \").concat(imageUrlToSend)\n                    };\n                }\n                return {\n                    role: msg.role,\n                    content: msg.content\n                };\n            });\n            // Añadir contexto del editor para la IA externa\n            const contextMessage = {\n                role: \"system\",\n                content: \"\\nContexto actual del editor de video:\\n- Posici\\xf3n actual (segundos): \".concat((playerRef === null || playerRef === void 0 ? void 0 : (_playerRef_current = playerRef.current) === null || _playerRef_current === void 0 ? void 0 : _playerRef_current.getCurrentTime) ? Math.floor((playerRef.current.getCurrentTime() || 0) * 100) / 100 : 0, \"\\n- Duraci\\xf3n del proyecto (segundos): \").concat((timeline === null || timeline === void 0 ? void 0 : timeline.duration) ? Math.floor(timeline.duration / 1000) : 0, \"\\n- N\\xfamero de escenas: \").concat((scenes === null || scenes === void 0 ? void 0 : scenes.length) || 0, \"\\n- N\\xfamero de elementos en el timeline: \").concat(((timeline === null || timeline === void 0 ? void 0 : (_timeline_canvas = timeline.canvas) === null || _timeline_canvas === void 0 ? void 0 : (_timeline_canvas_getObjects = _timeline_canvas.getObjects) === null || _timeline_canvas_getObjects === void 0 ? void 0 : _timeline_canvas_getObjects.call(_timeline_canvas)) || []).length - 1 > 0 ? ((timeline === null || timeline === void 0 ? void 0 : (_timeline_canvas1 = timeline.canvas) === null || _timeline_canvas1 === void 0 ? void 0 : (_timeline_canvas_getObjects1 = _timeline_canvas1.getObjects) === null || _timeline_canvas_getObjects1 === void 0 ? void 0 : _timeline_canvas_getObjects1.call(_timeline_canvas1)) || []).length - 1 : 0, \"\\n\").concat(lastUploadedImageUrl ? \"- \\xdaltima imagen compartida por el usuario disponible para usar\" : \"\", '\\n\\nEl usuario puede expresar en lenguaje natural la necesidad de agregar elementos al video.\\nEjemplos:\\n- \"Pon un t\\xedtulo que diga \\'Bienvenidos\\' al inicio\"\\n- \"Quiero un texto blanco que diga \\'Fin\\' al final del video\"\\n- \"Necesito una imagen en el segundo 10\"\\n- \"Coloca un video de introducci\\xf3n al principio\"\\n\\nSi el usuario adjunta una imagen en el mensaje, la URL estar\\xe1 en formato [IMAGEN: url_de_la_imagen].\\nDebes detectar si quiere agregar esta imagen al video y en qu\\xe9 momento temporal.\\n')\n            };\n            try {\n                var _data_message;\n                const response = await fetch(\"/api/ai\", {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        messages: [\n                            contextMessage,\n                            ...apiMessages\n                        ],\n                        // Usar la URL de la imagen actual para esta solicitud si existe,\n                        // de lo contrario usar la última URL guardada\n                        lastImageUrl: currentImageUrlForThisRequest || lastUploadedImageUrl || \"\"\n                    }),\n                    // Agregar timeout para evitar esperas infinitas\n                    signal: AbortSignal.timeout(15000) // 15 segundos máximo\n                });\n                if (!response.ok) {\n                    throw new Error(\"Error de API: \".concat(response.status, \" \").concat(response.statusText));\n                }\n                const data = await response.json();\n                // Asegurarse de que data.message.content existe\n                const aiResponse = (data === null || data === void 0 ? void 0 : (_data_message = data.message) === null || _data_message === void 0 ? void 0 : _data_message.content) || \"Lo siento, no pude entender tu solicitud.\";\n                // Obtener los datos del elemento si existen (con verificación segura)\n                const elementData = data === null || data === void 0 ? void 0 : data.elementData;\n                // Variable para la respuesta final\n                let finalResponse = aiResponse;\n                // Crear una referencia a la respuesta final para que sea accesible en la función procesadora\n                const finalResponseRef = {\n                    current: finalResponse\n                };\n                let elementAdded = false;\n                // Usar la función de procesamiento de elementos\n                const processResult = await processDetectedElement(elementData, commandExecutor, finalResponseRef, timeline, lastUploadedImageUrl, currentImageUrlForThisRequest);\n                finalResponse = processResult.finalResponse;\n                elementAdded = processResult.elementAdded;\n                const assistantMessage = {\n                    id: (Date.now() + 1).toString(),\n                    content: finalResponse,\n                    role: \"assistant\",\n                    timestamp: new Date()\n                };\n                setMessages((prev)=>[\n                        ...prev,\n                        assistantMessage\n                    ]);\n            } catch (apiError) {\n                console.error(\"Error en la comunicaci\\xf3n con la API:\", apiError);\n                // Mensaje de error específico de API\n                setMessages((prev)=>[\n                        ...prev,\n                        {\n                            id: (Date.now() + 1).toString(),\n                            content: \"Lo siento, ha ocurrido un error al comunicarse con el servicio de IA. Por favor, intenta de nuevo en unos momentos.\",\n                            role: \"assistant\",\n                            timestamp: new Date()\n                        }\n                    ]);\n            }\n        } catch (error) {\n            console.error(\"Error al procesar el mensaje:\", error);\n            // Determinar mensaje de error apropiado\n            let errorMessage = \"Lo siento, ha ocurrido un error al procesar tu mensaje.\";\n            if (error instanceof Error) {\n                if (error.message.includes(\"timeout\") || error.message.includes(\"abort\")) {\n                    errorMessage = \"La solicitud ha tardado demasiado. Prueba con un mensaje m\\xe1s corto.\";\n                } else if (error.message.includes(\"network\") || error.message.includes(\"fetch\")) {\n                    errorMessage = \"Parece que hay un problema de conexi\\xf3n. Verifica tu conexi\\xf3n a internet e intenta de nuevo.\";\n                }\n            }\n            // Mensaje de error\n            setMessages((prev)=>[\n                    ...prev,\n                    {\n                        id: (Date.now() + 1).toString(),\n                        content: errorMessage,\n                        role: \"assistant\",\n                        timestamp: new Date()\n                    }\n                ]);\n        } finally{\n            setIsLoading(false);\n        }\n    };\n    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n        className: \"flex h-full flex-col border-r border-border/80 bg-sidebar\",\n        children: [\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-[#1a1625] p-3 flex justify-between items-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex items-center gap-2\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"h-8 w-8 rounded-full flex items-center justify-center bg-gradient-to-br from-purple-600 to-indigo-700 text-white\",\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_8__[\"default\"], {\n                                    className: \"h-4 w-4\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 641,\n                                    columnNumber: 13\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 640,\n                                columnNumber: 11\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"h3\", {\n                                className: \"font-medium text-purple-50\",\n                                children: \"Asistente Wands\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 643,\n                                columnNumber: 11\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 639,\n                        columnNumber: 9\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                        variant: \"ghost\",\n                        size: \"icon\",\n                        className: \"h-8 w-8 rounded-full hover:bg-purple-800/40\",\n                        onClick: resetChat,\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_9__[\"default\"], {\n                            className: \"h-4 w-4 text-purple-300\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 651,\n                            columnNumber: 11\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 645,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 638,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"flex-1 overflow-auto bg-[#211a2c] p-4 space-y-4\",\n                children: [\n                    messages.map((message)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                            className: \"flex flex-col \".concat(message.role === \"assistant\" ? \"items-start\" : \"items-end\"),\n                            children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                className: \"max-w-[85%] rounded-lg px-4 py-2.5 \".concat(message.role === \"assistant\" ? \"bg-[#2a1f35] text-purple-50\" : \"bg-gradient-to-r from-purple-600 to-indigo-700 text-white\"),\n                                children: [\n                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"whitespace-pre-wrap\",\n                                        children: message.content\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                        lineNumber: 671,\n                                        columnNumber: 15\n                                    }, this),\n                                    message.imageUrl && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                                        className: \"mt-2\",\n                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                                            src: message.imageUrl,\n                                            alt: \"Imagen adjunta\",\n                                            className: \"max-h-48 max-w-full rounded-md object-contain\"\n                                        }, void 0, false, {\n                                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                            lineNumber: 674,\n                                            columnNumber: 19\n                                        }, this)\n                                    }, void 0, false, {\n                                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                        lineNumber: 673,\n                                        columnNumber: 17\n                                    }, this)\n                                ]\n                            }, void 0, true, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 664,\n                                columnNumber: 13\n                            }, this)\n                        }, message.id, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 658,\n                            columnNumber: 11\n                        }, this)),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        ref: messagesEndRef\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 684,\n                        columnNumber: 9\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 656,\n                columnNumber: 7\n            }, this),\n            imagePreview && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"relative mx-4 mt-1 mb-2 h-24 bg-[#2a1f35] p-2 flex items-center justify-center\",\n                children: [\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                        variant: \"ghost\",\n                        size: \"icon\",\n                        className: \"absolute right-1 top-1 z-10 h-5 w-5 rounded-full bg-[#211a2c]/80 hover:bg-red-800/80\",\n                        onClick: handleRemoveImage,\n                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_10__[\"default\"], {\n                            className: \"h-3 w-3 text-white\"\n                        }, void 0, false, {\n                            fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                            lineNumber: 696,\n                            columnNumber: 13\n                        }, this)\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 690,\n                        columnNumber: 11\n                    }, this),\n                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"img\", {\n                        src: imagePreview,\n                        alt: \"Vista previa\",\n                        className: \"max-h-full max-w-full object-contain\"\n                    }, void 0, false, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 698,\n                        columnNumber: 11\n                    }, this)\n                ]\n            }, void 0, true, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 689,\n                columnNumber: 9\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                className: \"bg-[#1a1625] p-3\",\n                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                    className: \"flex items-center gap-2\",\n                    children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"div\", {\n                        className: \"flex bg-[#2a1f35] rounded-md flex-1 overflow-hidden\",\n                        children: [\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                                variant: \"ghost\",\n                                size: \"icon\",\n                                className: \"h-10 w-10 bg-transparent hover:bg-purple-800/30\",\n                                onClick: handleImageClick,\n                                disabled: isLoading,\n                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_11__[\"default\"], {\n                                    className: \"h-5 w-5 text-purple-300\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 717,\n                                    columnNumber: 15\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 710,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_input__WEBPACK_IMPORTED_MODULE_3__.Input, {\n                                value: input,\n                                onChange: (e)=>setInput(e.target.value),\n                                onKeyDown: (e)=>{\n                                    if (e.key === \"Enter\" && !e.shiftKey) {\n                                        e.preventDefault();\n                                        handleSendMessage();\n                                    }\n                                },\n                                placeholder: \"Escribe tu mensaje...\",\n                                disabled: isLoading,\n                                className: \"flex-1 border-0 bg-transparent h-10 focus:ring-0 focus-visible:ring-0 text-purple-50\"\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 720,\n                                columnNumber: 13\n                            }, this),\n                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ui_button__WEBPACK_IMPORTED_MODULE_2__.Button, {\n                                onClick: handleSendMessage,\n                                disabled: !input.trim() && !imageFile || isLoading,\n                                className: \"h-10 bg-transparent hover:bg-purple-800/80 bg-purple-800/40 text-purple-300\",\n                                children: isLoading || isUploading ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_12__[\"default\"], {\n                                    className: \"h-5 w-5 animate-spin\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 740,\n                                    columnNumber: 17\n                                }, this) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_barrel_optimize_names_ImageIcon_Loader2_RefreshCw_Send_Sparkles_X_lucide_react__WEBPACK_IMPORTED_MODULE_13__[\"default\"], {\n                                    className: \"h-4 w-4\"\n                                }, void 0, false, {\n                                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                    lineNumber: 742,\n                                    columnNumber: 17\n                                }, this)\n                            }, void 0, false, {\n                                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                                lineNumber: 734,\n                                columnNumber: 13\n                            }, this)\n                        ]\n                    }, void 0, true, {\n                        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                        lineNumber: 709,\n                        columnNumber: 11\n                    }, this)\n                }, void 0, false, {\n                    fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                    lineNumber: 708,\n                    columnNumber: 9\n                }, this)\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 707,\n                columnNumber: 7\n            }, this),\n            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(\"input\", {\n                type: \"file\",\n                ref: fileInputRef,\n                onChange: handleFileChange,\n                accept: \"image/*\",\n                className: \"hidden\",\n                disabled: isLoading\n            }, void 0, false, {\n                fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n                lineNumber: 749,\n                columnNumber: 7\n            }, this)\n        ]\n    }, void 0, true, {\n        fileName: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\components\\\\ai-chat\\\\index.tsx\",\n        lineNumber: 636,\n        columnNumber: 5\n    }, this);\n}\n_s(AIChat, \"vJoBK3ZjxUeQmWwpjqWDhxYUEXg=\", false, function() {\n    return [\n        _features_editor_hooks_state_manager__WEBPACK_IMPORTED_MODULE_5__.useStateManager,\n        _features_editor_store_use_data_state__WEBPACK_IMPORTED_MODULE_4__[\"default\"]\n    ];\n});\n_c = AIChat;\nvar _c;\n$RefreshReg$(_c, \"AIChat\");\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL2NvbXBvbmVudHMvYWktY2hhdC9pbmRleC50c3giLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRW9EO0FBQ0o7QUFDRjtBQUU4QztBQUMxQjtBQUNNO0FBQ2U7QUFDakM7QUFFdEQsa0ZBQWtGO0FBQ2xGLFNBQVNlLDZCQUE2QkMsY0FBc0I7SUFDMUQsSUFBSUMsWUFBWTtJQUNoQixJQUFJQyxVQUFVO0lBRWQsSUFBSSxDQUFDRixnQkFBZ0IsT0FBTztRQUFFQztRQUFXQztJQUFRO0lBRWpELHVDQUF1QztJQUN2QyxNQUFNQyxvQkFBb0I7UUFDeEI7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO0tBQ0Q7SUFFRCxxQ0FBcUM7SUFDckMsTUFBTUMsa0JBQWtCO1FBQ3RCO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7UUFDQTtRQUNBO1FBQ0E7S0FDRDtJQUVELG1DQUFtQztJQUNuQyxNQUFNQyxZQUFZLDRDQUE0Q0MsSUFBSSxDQUFDTjtJQUNuRSxNQUFNTyxVQUFVLHVDQUF1Q0QsSUFBSSxDQUFDTjtJQUU1RCxzQ0FBc0M7SUFDdEMsS0FBSyxNQUFNUSxXQUFXTCxrQkFBbUI7UUFDdkMsTUFBTU0sUUFBUVQsZUFBZVMsS0FBSyxDQUFDRDtRQUNuQyxJQUFJQyxTQUFTQSxLQUFLLENBQUMsRUFBRSxFQUFFO1lBQ3JCLG1EQUFtRDtZQUNuRFIsWUFBWU8sUUFBUUUsUUFBUSxHQUFHQyxRQUFRLENBQUMsWUFDcENDLFNBQVNILEtBQUssQ0FBQyxFQUFFLElBQUksS0FDckJHLFNBQVNILEtBQUssQ0FBQyxFQUFFO1lBQ3JCO1FBQ0Y7SUFDRjtJQUVBLG9DQUFvQztJQUNwQyxLQUFLLE1BQU1ELFdBQVdKLGdCQUFpQjtRQUNyQyxNQUFNSyxRQUFRVCxlQUFlUyxLQUFLLENBQUNEO1FBQ25DLElBQUlDLFNBQVNBLEtBQUssQ0FBQyxFQUFFLEVBQUU7WUFDckIsSUFBSUQs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dEMsYUFBY0Y7Z0NBQzNDd0UsV0FBVTswQ0FFVHhFLGFBQWFNLDRCQUNaLDhEQUFDaEcsd0hBQU9BO29DQUFDa0ssV0FBVTs7Ozs7eURBRW5CLDhEQUFDbkssd0hBQUlBO29DQUFDbUssV0FBVTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OzBCQU8xQiw4REFBQzFFO2dCQUNDcEQsTUFBSztnQkFDTHNJLEtBQUt2RTtnQkFDTHlFLFVBQVU5RDtnQkFDVm9FLFFBQU87Z0JBQ1BoQixXQUFVO2dCQUNWUyxVQUFVakY7Ozs7Ozs7Ozs7OztBQUlsQjtHQXRhd0JUOztRQW9CRDNFLGlGQUFlQTtRQUNJRCw2RUFBWUE7OztLQXJCOUI0RSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9jb21wb25lbnRzL2FpLWNoYXQvaW5kZXgudHN4PzRiOTciXSwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2UgY2xpZW50XCI7XG5cbmltcG9ydCB7IHVzZVN0YXRlLCB1c2VSZWYsIHVzZUVmZmVjdCB9IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IHsgQnV0dG9uIH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9idXR0b25cIjtcbmltcG9ydCB7IElucHV0IH0gZnJvbSBcIkAvY29tcG9uZW50cy91aS9pbnB1dFwiO1xuaW1wb3J0IHsgU2Nyb2xsQXJlYSB9IGZyb20gXCJAL2NvbXBvbmVudHMvdWkvc2Nyb2xsLWFyZWFcIjtcbmltcG9ydCB7IFNlbmQsIExvYWRlcjIsIEltYWdlSWNvbiwgWCwgU3BhcmtsZXMsIFJlZnJlc2hDdywgSGVscENpcmNsZSB9IGZyb20gXCJsdWNpZGUtcmVhY3RcIjtcbmltcG9ydCB1c2VEYXRhU3RhdGUgZnJvbSBcIkAvZmVhdHVyZXMvZWRpdG9yL3N0b3JlL3VzZS1kYXRhLXN0YXRlXCI7XG5pbXBvcnQgeyB1c2VTdGF0ZU1hbmFnZXIgfSBmcm9tIFwiQC9mZWF0dXJlcy9lZGl0b3IvaG9va3Mvc3RhdGUtbWFuYWdlclwiO1xuaW1wb3J0IHsgY3JlYXRlVmlkZW9Db21tYW5kRXhlY3V0b3IsIFZpZGVvQ29tbWFuZEV4ZWN1dG9yIH0gZnJvbSBcIi4vYWktdmlkZW8tY29tbWFuZHNcIjtcbmltcG9ydCB7IGNyZWF0ZVVwbG9hZHNEZXRhaWxzIH0gZnJvbSBcIkAvdXRpbHMvdXBsb2FkXCI7XG5cbi8vIEZ1bmNpw7NuIHBhcmEgZXh0cmFlciB0aWVtcG9zIGRlIGluaWNpbyB5IGZpbiBkZSB1bmEgaW1hZ2VuIGEgcGFydGlyIGRlbCBtZW5zYWplXG5mdW5jdGlvbiBleHRyYWN0SW1hZ2VUaW1lc0Zyb21NZXNzYWdlKG1lc3NhZ2VDb250ZW50OiBzdHJpbmcpOiB7IHN0YXJ0VGltZTogbnVtYmVyLCBlbmRUaW1lOiBudW1iZXIgfSB7XG4gIGxldCBzdGFydFRpbWUgPSAwO1xuICBsZXQgZW5kVGltZSA9IDU7XG5cbiAgaWYgKCFtZXNzYWdlQ29udGVudCkgcmV0dXJuIHsgc3RhcnRUaW1lLCBlbmRUaW1lIH07XG5cbiAgLy8gQnVzY2FyIHJlZmVyZW5jaWFzIGFsIHRpZW1wbyBpbmljaWFsXG4gIGNvbnN0IHN0YXJ0VGltZVBhdHRlcm5zID0gW1xuICAgIC9lbiBlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9kZXNkZSBlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9hIHBhcnRpciBkZWwgc2VndW5kbyAoXFxkKykvaSxcbiAgICAvY29tZW56YW5kbyBlbiBlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9kZXNkZSBlbCBtaW51dG8gKFxcZCspL2ksIC8vIENvbnZlcnRpciBtaW51dG9zIGEgc2VndW5kb3NcbiAgICAvZW4gZWwgbWludXRvIChcXGQrKS9pLCAgICAvLyBDb252ZXJ0aXIgbWludXRvcyBhIHNlZ3VuZG9zXG4gICAgL2VudHJlIGxvcyBzZWd1bmRvcyAoXFxkKykgeS9pLCAvLyBDYXB0dXJhIGVsIHByaW1lciBuw7ptZXJvIGVuIFwiZW50cmUgWCB5IFlcIlxuICAgIC9kZWwgc2VndW5kbyAoXFxkKykgYWwvaSxcbiAgICAvZW1wZXphbmRvIGVuIChcXGQrKS9pLFxuICAgIC9zZWd1bmRvIChcXGQrKS9pLCAgICAgLy8gUGF0csOzbiBtw6FzIGdlbmVyYWwgcGFyYSBjYXB0dXJhciBcInNlZ3VuZG8gWFwiXG4gICAgL2VuIChcXGQrKSBzZWd1bmRvcy9pLCAvLyBcImVuIFggc2VndW5kb3NcIlxuICAgIC9lbiBlbCAoXFxkKykvaSwgICAgICAgLy8gXCJlbiBlbCBYXCIgKGN1YW5kbyBzZSByZWZpZXJlIGEgc2VndW5kb3MpXG4gIF07XG5cbiAgLy8gQnVzY2FyIHJlZmVyZW5jaWFzIGFsIHRpZW1wbyBmaW5hbFxuICBjb25zdCBlbmRUaW1lUGF0dGVybnMgPSBbXG4gICAgL2hhc3RhIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2FsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL3Rlcm1pbmFuZG8gZW4gZWwgc2VndW5kbyAoXFxkKykvaSxcbiAgICAvaGFzdGEgZWwgbWludXRvIChcXGQrKS9pLCAvLyBDb252ZXJ0aXIgbWludXRvcyBhIHNlZ3VuZG9zXG4gICAgL2VudHJlIGxvcyBzZWd1bmRvcyBcXGQrIHkgKFxcZCspL2ksIC8vIENhcHR1cmEgZWwgc2VndW5kbyBuw7ptZXJvIGVuIFwiZW50cmUgWCB5IFlcIlxuICAgIC9kZWwgc2VndW5kbyBcXGQrIGFsIChcXGQrKS9pLFxuICAgIC9wb3IgKFxcZCspIHNlZ3VuZG9zL2ksIC8vIER1cmFjacOzbiByZWxhdGl2YVxuICAgIC9kdXJhbnRlIChcXGQrKSBzZWd1bmRvcy9pLCAvLyBEdXJhY2nDs24gcmVsYXRpdmFcbiAgXTtcblxuICAvLyBCdXNjYXIgcGFsYWJyYXMgY2xhdmUgZXNwZWNpYWxlc1xuICBjb25zdCBpc0F0U3RhcnQgPSAvXFxiKGFsIGluaWNpb3xhbCBwcmluY2lwaW98YWwgY29taWVuem8pXFxiL2kudGVzdChtZXNzYWdlQ29udGVudCk7XG4gIGNvbnN0IGlzQXRFbmQgPSAvXFxiKGFsIGZpbmFsfGFsIHTDqXJtaW5vfGFsIGFjYWJhcilcXGIvaS50ZXN0KG1lc3NhZ2VDb250ZW50KTtcblxuICAvLyBQcm9jZXNhciBwYXRyb25lcyBkZSB0aWVtcG8gaW5pY2lhbFxuICBmb3IgKGNvbnN0IHBhdHRlcm4gb2Ygc3RhcnRUaW1lUGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaCA9IG1lc3NhZ2VDb250ZW50Lm1hdGNoKHBhdHRlcm4pO1xuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgLy8gU2kgZXMgcmVmZXJlbmNpYSBhIG1pbnV0b3MsIGNvbnZlcnRpciBhIHNlZ3VuZG9zXG4gICAgICBzdGFydFRpbWUgPSBwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ21pbnV0bycpXG4gICAgICAgID8gcGFyc2VJbnQobWF0Y2hbMV0pICogNjBcbiAgICAgICAgOiBwYXJzZUludChtYXRjaFsxXSk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBQcm9jZXNhciBwYXRyb25lcyBkZSB0aWVtcG8gZmluYWxcbiAgZm9yIChjb25zdCBwYXR0ZXJuIG9mIGVuZFRpbWVQYXR0ZXJucykge1xuICAgIGNvbnN0IG1hdGNoID0gbWVzc2FnZUNvbnRlbnQubWF0Y2gocGF0dGVybik7XG4gICAgaWYgKG1hdGNoICYmIG1hdGNoWzFdKSB7XG4gICAgICBpZiAocGF0dGVybi50b1N0cmluZygpLmluY2x1ZGVzKCdwb3InKSB8fCBwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ2R1cmFudGUnKSkge1xuICAgICAgICAvLyBFcyB1bmEgZHVyYWNpw7NuIHJlbGF0aXZhLCBzdW1hciBhbCB0aWVtcG8gaW5pY2lhbFxuICAgICAgICBlbmRUaW1lID0gc3RhcnRUaW1lICsgcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRXMgdW4gdGllbXBvIGFic29sdXRvXG4gICAgICAgIGVuZFRpbWUgPSBwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ21pbnV0bycpXG4gICAgICAgICAgPyBwYXJzZUludChtYXRjaFsxXSkgKiA2MFxuICAgICAgICAgIDogcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgfVxuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgLy8gU2kgc2UgbWVuY2lvbmEgXCJhbCBpbmljaW9cIiwgZXN0YWJsZWNlciB0aWVtcG8gYSAwXG4gIGlmIChpc0F0U3RhcnQpIHtcbiAgICBzdGFydFRpbWUgPSAwO1xuICAgIGVuZFRpbWUgPSA1OyAvLyBQb3IgZGVmZWN0byA1IHNlZ3VuZG9zIGRlIGR1cmFjacOzblxuICB9XG5cbiAgLy8gU2kgc2UgbWVuY2lvbmEgXCJhbCBmaW5hbFwiLCBlc3RhYmxlY2VyIHZhbG9yZXMgcmVsYXRpdm9zIGFsIGZpbmFsXG4gIC8vIE5vdGE6IEVsIHZhbG9yIHJlYWwgc2UgYWp1c3RhcsOhIGVuIGVsIGNsaWVudGUgc2Vnw7puIGxhIGR1cmFjacOzblxuICBpZiAoaXNBdEVuZCkge1xuICAgIHN0YXJ0VGltZSA9IC0xOyAvLyBDw7NkaWdvIGVzcGVjaWFsIHBhcmEgXCJmaW5hbCAtIDUgc2VndW5kb3NcIlxuICAgIGVuZFRpbWUgPSAtMTsgICAvLyBDw7NkaWdvIGVzcGVjaWFsIHBhcmEgXCJmaW5hbFwiXG4gIH1cblxuICAvLyBTaSBubyBzZSBkZXRlY3TDsyB0aWVtcG8gZmluYWwgcGVybyBzw60gaW5pY2lhbCwgZXN0YWJsZWNlciB1bmEgZHVyYWNpw7NuIHByZWRldGVybWluYWRhXG4gIGlmIChzdGFydFRpbWUgPiAwICYmIGVuZFRpbWUgPT09IDUgJiYgc3RhcnRUaW1lICE9PSAwKSB7XG4gICAgZW5kVGltZSA9IHN0YXJ0VGltZSArIDU7XG4gIH1cblxuICByZXR1cm4geyBzdGFydFRpbWUsIGVuZFRpbWUgfTtcbn1cblxuLy8gVGlwbyBwYXJhIGxvcyBtZW5zYWplc1xudHlwZSBNZXNzYWdlID0ge1xuICBpZDogc3RyaW5nO1xuICBjb250ZW50OiBzdHJpbmc7XG4gIHJvbGU6IFwiYXNzaXN0YW50XCIgfCBcInVzZXJcIjtcbiAgdGltZXN0YW1wOiBEYXRlO1xuICBpbWFnZVVybD86IHN0cmluZzsgLy8gTnVldmEgcHJvcGllZGFkIHBhcmEgVVJMcyBkZSBpbWFnZW5cbn07XG5cbi8vIEZ1bmNpw7NuIHBhcmEgcHJvY2VzYXIgZWxlbWVudG9zIGRldGVjdGFkb3MgcG9yIGxhIElBXG5jb25zdCBwcm9jZXNzRGV0ZWN0ZWRFbGVtZW50ID0gYXN5bmMgKGVsZW1lbnREYXRhLCBjb21tYW5kRXhlY3V0b3IsIGZpbmFsUmVzcG9uc2VSZWYsIHRpbWVsaW5lLCBsYXN0VXBsb2FkZWRJbWFnZVVybCwgY3VycmVudEltYWdlVXJsRm9yVGhpc1JlcXVlc3QpID0+IHtcbiAgbGV0IGVsZW1lbnRBZGRlZCA9IGZhbHNlO1xuICBsZXQgZmluYWxSZXNwb25zZSA9IGZpbmFsUmVzcG9uc2VSZWYuY3VycmVudDtcblxuICB0cnkge1xuICAgIC8vIFNpIHNlIGRldGVjdMOzIHVuIGVsZW1lbnRvIHBhcmEgYWdyZWdhciBjb24gY29uZmlhbnphIHN1ZmljaWVudGVcbiAgICBpZiAoZWxlbWVudERhdGEgJiZcbiAgICAgICAgZWxlbWVudERhdGEuZGV0ZWN0ZWQgPT09IHRydWUgJiZcbiAgICAgICAgdHlwZW9mIGVsZW1lbnREYXRhLmNvbmZpZGVuY2UgPT09ICdudW1iZXInICYmXG4gICAgICAgIGVsZW1lbnREYXRhLmNvbmZpZGVuY2UgPiAwLjcgJiZcbiAgICAgICAgZWxlbWVudERhdGEuZWxlbWVudCkge1xuICAgICAgY29uc3QgZWxlbWVudCA9IGVsZW1lbnREYXRhLmVsZW1lbnQ7XG5cbiAgICAgIC8vIFByb2Nlc2FyIHNlZ8O6biBlbCB0aXBvIGRlIGVsZW1lbnRvXG4gICAgICBpZiAoZWxlbWVudC50eXBlID09PSBcInRleHRcIiAmJiBlbGVtZW50LmNvbnRlbnQpIHtcbiAgICAgICAgLy8gQ29uZmlndXJhciBvcGNpb25lcyBwYXJhIGVsIHRleHRvXG4gICAgICAgIGNvbnN0IHRleHRPcHRpb25zOiBhbnkgPSB7XG4gICAgICAgICAgc3RhcnRUaW1lOiB0eXBlb2YgZWxlbWVudC5zdGFydFRpbWUgPT09ICdudW1iZXInID8gZWxlbWVudC5zdGFydFRpbWUgOiAwLFxuICAgICAgICAgIGVuZFRpbWU6IHR5cGVvZiBlbGVtZW50LmVuZFRpbWUgPT09ICdudW1iZXInID8gZWxlbWVudC5lbmRUaW1lIDogKHR5cGVvZiBlbGVtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicgPyBlbGVtZW50LnN0YXJ0VGltZSArIDUgOiA1KSxcbiAgICAgICAgfTtcblxuICAgICAgICAvLyBBc2lnbmFyIGNvbG9yIHNpIGVzdMOhIGRpc3BvbmlibGVcbiAgICAgICAgaWYgKGVsZW1lbnQuY29sb3IpIHtcbiAgICAgICAgICB0ZXh0T3B0aW9ucy5jb2xvciA9IGVsZW1lbnQuY29sb3IudG9Mb3dlckNhc2UoKSA9PT0gXCJibGFuY29cIiA/IFwiI0ZGRkZGRlwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNvbG9yLnRvTG93ZXJDYXNlKCkgPT09IFwibmVncm9cIiA/IFwiIzAwMDAwMFwiIDpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmNvbG9yLnRvTG93ZXJDYXNlKCkgPT09IFwicm9qb1wiID8gXCIjRkYwMDAwXCIgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY29sb3IudG9Mb3dlckNhc2UoKSA9PT0gXCJhenVsXCIgPyBcIiMwMDAwRkZcIiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jb2xvci50b0xvd2VyQ2FzZSgpID09PSBcInZlcmRlXCIgPyBcIiMwMEZGMDBcIiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jb2xvci50b0xvd2VyQ2FzZSgpID09PSBcImFtYXJpbGxvXCIgPyBcIiNGRkZGMDBcIiA6XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jb2xvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEHDsWFkaXIgZWwgdGV4dG9cbiAgICAgICAgY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQuYWRkVGV4dChlbGVtZW50LmNvbnRlbnQsIHRleHRPcHRpb25zKTtcblxuICAgICAgICAvLyBBY3R1YWxpemFyIHJlc3B1ZXN0YVxuICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bSGUgYWdyZWdhZG8gZWwgdGV4dG8gXCIke2VsZW1lbnQuY29udGVudH1cIiAke2VsZW1lbnQuY29sb3IgPyBgY29uIGNvbG9yICR7ZWxlbWVudC5jb2xvcn0gYCA6IFwiXCJ9ZGVzZGUgZWwgc2VndW5kbyAke3RleHRPcHRpb25zLnN0YXJ0VGltZX0gaGFzdGEgZWwgc2VndW5kbyAke3RleHRPcHRpb25zLmVuZFRpbWV9XWA7XG4gICAgICAgIGVsZW1lbnRBZGRlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChlbGVtZW50LnR5cGUgPT09IFwiaW1hZ2VcIikge1xuICAgICAgICAvLyBDb25maWd1cmFyIG9wY2lvbmVzIHBhcmEgbGEgaW1hZ2VuXG4gICAgICAgIGNvbnN0IGltYWdlT3B0aW9uczogYW55ID0ge1xuICAgICAgICAgIHN0YXJ0VGltZTogdHlwZW9mIGVsZW1lbnQuc3RhcnRUaW1lID09PSAnbnVtYmVyJyA/IGVsZW1lbnQuc3RhcnRUaW1lIDogMCxcbiAgICAgICAgICBlbmRUaW1lOiB0eXBlb2YgZWxlbWVudC5lbmRUaW1lID09PSAnbnVtYmVyJyA/IGVsZW1lbnQuZW5kVGltZSA6ICh0eXBlb2YgZWxlbWVudC5zdGFydFRpbWUgPT09ICdudW1iZXInID8gZWxlbWVudC5zdGFydFRpbWUgKyA1IDogNSksXG4gICAgICAgICAgLy8gUG9zaWNpw7NuIGNlbnRyYWRhIHBvciBkZWZlY3RvXG4gICAgICAgICAgcG9zaXRpb246IHsgeDogMC41LCB5OiAwLjUgfVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFJlZ2lzdHJhciB0aWVtcG9zIGVzcGVjw61maWNvcyBwYXJhIGRlcHVyYWNpw7NuXG4gICAgICAgIGNvbnNvbGUubG9nKGBUaWVtcG9zIGRlIGltYWdlbiByZWNpYmlkb3MgZGUgbGEgQVBJOiBzdGFydFRpbWU9JHtlbGVtZW50LnN0YXJ0VGltZX0sIGVuZFRpbWU9JHtlbGVtZW50LmVuZFRpbWV9YCk7XG5cbiAgICAgICAgLy8gTWFuZWphciBjYXNvcyBlc3BlY2lhbGVzIHBhcmEgXCJhbCBmaW5hbFwiIGRlbCB2aWRlb1xuICAgICAgICBpZiAoZWxlbWVudC5zdGFydFRpbWUgPT09IC0xIHx8IGVsZW1lbnQuZW5kVGltZSA9PT0gLTEpIHtcbiAgICAgICAgICAvLyBDYWxjdWxhciBsYSBkdXJhY2nDs24gZGVsIHZpZGVvIGVuIHNlZ3VuZG9zXG4gICAgICAgICAgY29uc3QgdmlkZW9EdXJhdGlvbiA9IHRpbWVsaW5lPy5kdXJhdGlvblxuICAgICAgICAgICAgPyBNYXRoLmZsb29yKHRpbWVsaW5lLmR1cmF0aW9uIC8gMTAwMClcbiAgICAgICAgICAgIDogMzA7IC8vIFZhbG9yIHByZWRldGVybWluYWRvIHNpIG5vIGhheSBkdXJhY2nDs25cblxuICAgICAgICAgIGNvbnNvbGUubG9nKGBEdXJhY2nDs24gZGVsIHZpZGVvOiAke3ZpZGVvRHVyYXRpb259c2ApO1xuXG4gICAgICAgICAgaWYgKGVsZW1lbnQuc3RhcnRUaW1lID09PSAtMSAmJiBlbGVtZW50LmVuZFRpbWUgPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBTaSBhbWJvcyBzb24gLTEsIGNvbG9jYXIgZW4gbG9zIMO6bHRpbW9zIDUgc2VndW5kb3NcbiAgICAgICAgICAgIGltYWdlT3B0aW9ucy5zdGFydFRpbWUgPSBNYXRoLm1heCgwLCB2aWRlb0R1cmF0aW9uIC0gNSk7XG4gICAgICAgICAgICBpbWFnZU9wdGlvbnMuZW5kVGltZSA9IHZpZGVvRHVyYXRpb247XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgQWp1c3RhbmRvIHBhcmEgXCJhbCBmaW5hbFwiOiBzdGFydFRpbWU9JHtpbWFnZU9wdGlvbnMuc3RhcnRUaW1lfSwgZW5kVGltZT0ke2ltYWdlT3B0aW9ucy5lbmRUaW1lfWApO1xuICAgICAgICAgIH0gZWxzZSBpZiAoZWxlbWVudC5zdGFydFRpbWUgPT09IC0xKSB7XG4gICAgICAgICAgICAvLyBTb2xvIHN0YXJ0VGltZSBlcyAtMVxuICAgICAgICAgICAgaW1hZ2VPcHRpb25zLnN0YXJ0VGltZSA9IE1hdGgubWF4KDAsIHZpZGVvRHVyYXRpb24gLSA1KTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGVsZW1lbnQuZW5kVGltZSA9PT0gLTEpIHtcbiAgICAgICAgICAgIC8vIFNvbG8gZW5kVGltZSBlcyAtMVxuICAgICAgICAgICAgaW1hZ2VPcHRpb25zLmVuZFRpbWUgPSB2aWRlb0R1cmF0aW9uO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnNvbGUubG9nKGBUaWVtcG9zIGRlIGltYWdlbiBhIGFwbGljYXI6IHN0YXJ0VGltZT0ke2ltYWdlT3B0aW9ucy5zdGFydFRpbWV9LCBlbmRUaW1lPSR7aW1hZ2VPcHRpb25zLmVuZFRpbWV9YCk7XG5cbiAgICAgICAgLy8gRGV0ZXJtaW5hciBsYSBVUkwgZGUgbGEgaW1hZ2VuIGEgdXNhclxuICAgICAgICBjb25zdCBpc0dlbmVyaWNVcmwgPSBlbGVtZW50LnVybCA9PT0gJ2ltYWdlbl9hZGp1bnRhX3Bvcl9lbF91c3VhcmlvLmpwZyc7XG4gICAgICAgIGNvbnN0IGlzTG9jYWxJbWFnZSA9IGxhc3RVcGxvYWRlZEltYWdlVXJsICYmIGxhc3RVcGxvYWRlZEltYWdlVXJsLnN0YXJ0c1dpdGgoJ2RhdGE6Jyk7XG5cbiAgICAgICAgbGV0IGltYWdlVXJsOiBzdHJpbmc7XG5cbiAgICAgICAgLy8gUFJJT1JJREFEIDE6IFVzYXIgbGEgaW1hZ2VuIHF1ZSBhY2FiYSBkZSBzdWJpcnNlIGVuIGVzdGUgbWVuc2FqZSBlc3BlY8OtZmljb1xuICAgICAgICBpZiAoY3VycmVudEltYWdlVXJsRm9yVGhpc1JlcXVlc3QpIHtcbiAgICAgICAgICBpbWFnZVVybCA9IGN1cnJlbnRJbWFnZVVybEZvclRoaXNSZXF1ZXN0O1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiVXNhbmRvIGxhIGltYWdlbiByZWNpw6luIHN1YmlkYSBwYXJhIGVzdGEgc29saWNpdHVkIGVzcGVjw61maWNhXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBSSU9SSURBRCAyOiBVc2FyIGxhIFVSTCBkZWwgZWxlbWVudG8gc2kgdGllbmUgdW5hIGVzcGVjw61maWNhIHkgTk8gZXMgbGEgVVJMIGdlbsOpcmljYVxuICAgICAgICBlbHNlIGlmIChlbGVtZW50LnVybCAmJiAhaXNHZW5lcmljVXJsICYmICFlbGVtZW50LnVybC5pbmNsdWRlcygnL3VybF9kZV9sYV9pbWFnZW4nKSkge1xuICAgICAgICAgIGltYWdlVXJsID0gZWxlbWVudC51cmw7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJVc2FuZG8gVVJMIGVzcGVjw61maWNhIGRlbCBlbGVtZW50b1wiKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBQUklPUklEQUQgMzogVXNhciBsYSDDumx0aW1hIGltYWdlbiBzdWJpZGEgZ3VhcmRhZGEgc2kgaGF5IHJlZmVyZW5jaWEgYSBpbWFnZW4gZ2Vuw6lyaWNhXG4gICAgICAgIGVsc2UgaWYgKGlzR2VuZXJpY1VybCAmJiBsYXN0VXBsb2FkZWRJbWFnZVVybCkge1xuICAgICAgICAgIGltYWdlVXJsID0gbGFzdFVwbG9hZGVkSW1hZ2VVcmw7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJVc2FuZG8gbGEgw7psdGltYSBpbWFnZW4gc3ViaWRhIGd1YXJkYWRhXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFBSSU9SSURBRCA0OiBGYWxsYmFjayBhIFVSTCBnZW7DqXJpY2FcbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gU2kgdG9kbyBsbyBkZW3DoXMgZmFsbGEsIHVzYXIgdW5hIGltYWdlbiBkZSBlamVtcGxvXG4gICAgICAgICAgaW1hZ2VVcmwgPSBcImh0dHBzOi8vaWsuaW1hZ2VraXQuaW8vd29tYm8vaW1hZ2VzL2ltZzIuanBnXCI7XG4gICAgICAgICAgY29uc29sZS5sb2coXCJVc2FuZG8gaW1hZ2VuIGRlIGVqZW1wbG8gY29tbyBmYWxsYmFja1wiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEHDsWFkaXIgbGEgaW1hZ2VuXG4gICAgICAgIGNvbW1hbmRFeGVjdXRvci5jdXJyZW50LmFkZEltYWdlKGltYWdlVXJsLCBpbWFnZU9wdGlvbnMpO1xuXG4gICAgICAgIC8vIEFjdHVhbGl6YXIgcmVzcHVlc3RhXG4gICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltIZSBhZ3JlZ2FkbyBsYSBpbWFnZW4gZGVzZGUgZWwgc2VndW5kbyAke2ltYWdlT3B0aW9ucy5zdGFydFRpbWV9IGhhc3RhIGVsIHNlZ3VuZG8gJHtpbWFnZU9wdGlvbnMuZW5kVGltZX1dYDtcbiAgICAgICAgZWxlbWVudEFkZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGVsZW1lbnQudHlwZSA9PT0gXCJ2aWRlb1wiKSB7XG4gICAgICAgIC8vIENvbmZpZ3VyYXIgb3BjaW9uZXMgcGFyYSBlbCB2aWRlb1xuICAgICAgICBjb25zdCB2aWRlb09wdGlvbnM6IGFueSA9IHtcbiAgICAgICAgICBzdGFydFRpbWU6IHR5cGVvZiBlbGVtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicgPyBlbGVtZW50LnN0YXJ0VGltZSA6IDAsXG4gICAgICAgICAgZW5kVGltZTogdHlwZW9mIGVsZW1lbnQuZW5kVGltZSA9PT0gJ251bWJlcicgPyBlbGVtZW50LmVuZFRpbWUgOiAodHlwZW9mIGVsZW1lbnQuc3RhcnRUaW1lID09PSAnbnVtYmVyJyA/IGVsZW1lbnQuc3RhcnRUaW1lICsgMTAgOiAxMCksXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gVVJMIGRlIHZpZGVvIGRlIGVqZW1wbG8gKGVuIHByb2R1Y2Npw7NuIGVzdG8gc2Vyw61hIGRpbsOhbWljbylcbiAgICAgICAgY29uc3QgdmlkZW9VcmwgPSBcImh0dHBzOi8vY2RuLmRlc2lnbmNvbWJvLmRldi92aWRlb3MvZGVtby12aWRlby00Lm1wNFwiO1xuXG4gICAgICAgIC8vIEHDsWFkaXIgZWwgdmlkZW9cbiAgICAgICAgY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQuYWRkVmlkZW8odmlkZW9VcmwsIHZpZGVvT3B0aW9ucyk7XG5cbiAgICAgICAgLy8gQWN0dWFsaXphciByZXNwdWVzdGFcbiAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0hlIGFncmVnYWRvIGVsIHZpZGVvIGRlc2RlIGVsIHNlZ3VuZG8gJHt2aWRlb09wdGlvbnMuc3RhcnRUaW1lfSBoYXN0YSBlbCBzZWd1bmRvICR7dmlkZW9PcHRpb25zLmVuZFRpbWV9XWA7XG4gICAgICAgIGVsZW1lbnRBZGRlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChlbGVtZW50LnR5cGUgPT09IFwic3VidGl0bGVzXCIpIHtcbiAgICAgICAgLy8gQ29uZmlndXJhciBvcGNpb25lcyBwYXJhIGxvcyBzdWJ0w610dWxvc1xuICAgICAgICBjb25zdCBzdWJ0aXRsZU9wdGlvbnM6IGFueSA9IHtcbiAgICAgICAgICBncm91cFdvcmRzOiBlbGVtZW50Lmdyb3VwV29yZHMgIT09IHVuZGVmaW5lZCA/IGVsZW1lbnQuZ3JvdXBXb3JkcyA6IHRydWUsXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gQcOxYWRpciB0aWVtcG9zIHNpIHNlIGVzcGVjaWZpY2Fyb25cbiAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICBzdWJ0aXRsZU9wdGlvbnMuc3RhcnRUaW1lID0gZWxlbWVudC5zdGFydFRpbWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHR5cGVvZiBlbGVtZW50LmVuZFRpbWUgPT09ICdudW1iZXInKSB7XG4gICAgICAgICAgc3VidGl0bGVPcHRpb25zLmVuZFRpbWUgPSBlbGVtZW50LmVuZFRpbWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBBw7FhZGlyIGxvcyBzdWJ0w610dWxvc1xuICAgICAgICBjb21tYW5kRXhlY3V0b3IuY3VycmVudC5hZGRTdWJ0aXRsZXMoc3VidGl0bGVPcHRpb25zKTtcblxuICAgICAgICAvLyBBY3R1YWxpemFyIHJlc3B1ZXN0YSBzaWxlbmNpb3NhIChzZSBtYW5lamEgZW4gb3RybyBsYWRvKVxuICAgICAgICBlbGVtZW50QWRkZWQgPSB0cnVlO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZWxlbWVudC50eXBlID09PSBcInNlZ21lbnRzXCIgJiYgQXJyYXkuaXNBcnJheShlbGVtZW50LnNlZ21lbnRzKSAmJiBlbGVtZW50LnNlZ21lbnRzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgLy8gQ29uZmlndXJhciBsb3Mgc2VnbWVudG9zIGEgZWxpbWluYXJcbiAgICAgICAgY29uc3Qgc2VnbWVudHMgPSBlbGVtZW50LnNlZ21lbnRzLm1hcChzZWdtZW50ID0+ICh7XG4gICAgICAgICAgc3RhcnRUaW1lOiB0eXBlb2Ygc2VnbWVudC5zdGFydFRpbWUgPT09ICdudW1iZXInID8gc2VnbWVudC5zdGFydFRpbWUgOiAwLFxuICAgICAgICAgIGVuZFRpbWU6IHR5cGVvZiBzZWdtZW50LmVuZFRpbWUgPT09ICdudW1iZXInID8gc2VnbWVudC5lbmRUaW1lIDogKHR5cGVvZiBzZWdtZW50LnN0YXJ0VGltZSA9PT0gJ251bWJlcicgPyBzZWdtZW50LnN0YXJ0VGltZSArIDUgOiA1KSxcbiAgICAgICAgfSkpO1xuXG4gICAgICAgIGNvbnNvbGUubG9nKGBFbGltaW5hbmRvICR7c2VnbWVudHMubGVuZ3RofSBzZWdtZW50b3M6YCwgc2VnbWVudHMpO1xuXG4gICAgICAgIC8vIEVqZW1wbG8gZGUgZm9ybWF0byBkZSBzZWdtZW50b3MgYSBtb3N0cmFyXG4gICAgICAgIGNvbnN0IHNlZ21lbnRzRm9ybWF0dGVkID0gc2VnbWVudHMubWFwKHMgPT4gYCR7cy5zdGFydFRpbWV9LSR7cy5lbmRUaW1lfXNgKS5qb2luKCcsICcpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gRWplY3V0YXIgbGEgZWxpbWluYWNpw7NuIGRlIHNlZ21lbnRvc1xuICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNvbW1hbmRFeGVjdXRvci5jdXJyZW50LnJlbW92ZVNlZ21lbnRzKHNlZ21lbnRzKTtcblxuICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltIZSBlbGltaW5hZG8gbG9zIHNlZ21lbnRvcyBzb2xpY2l0YWRvczogJHtzZWdtZW50c0Zvcm1hdHRlZH1dYDtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW05vIHB1ZGUgZWxpbWluYXIgbG9zIHNlZ21lbnRvcyBzb2xpY2l0YWRvcy4gQXNlZ8O6cmF0ZSBkZSBxdWUgaGF5IHVuIGVsZW1lbnRvIHNlbGVjY2lvbmFkbyBlbiBsYSB0aW1lbGluZS5dYDtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxlbWVudEFkZGVkID0gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWwgZWxpbWluYXIgc2VnbWVudG9zOlwiLCBlcnJvcik7XG4gICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0Vycm9yIGFsIGludGVudGFyIGVsaW1pbmFyIGxvcyBzZWdtZW50b3M6ICR7ZXJyb3IubWVzc2FnZSB8fCBcIkVycm9yIGRlc2Nvbm9jaWRvXCJ9XWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGVsZW1lbnQudHlwZSA9PT0gXCJjb21wYWN0XCIpIHtcbiAgICAgICAgLy8gRWplY3V0YXIgbGEgY29tcGFjdGFjacOzbiBkZWwgdGltZWxpbmVcbiAgICAgICAgY29uc29sZS5sb2coXCJDb21wYWN0YW5kbyB0aW1lbGluZSBwb3Igc29saWNpdHVkIGRlbCB1c3VhcmlvXCIpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gSW5pY2lhciBsYSBjb21wYWN0YWNpw7NuXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY29tbWFuZEV4ZWN1dG9yLmN1cnJlbnQuY29tcGFjdFRpbWVsaW5lKCk7XG5cbiAgICAgICAgICBpZiAocmVzdWx0KSB7XG4gICAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bSGUgY29tcGFjdGFkbyBlbCB0aW1lbGluZSBlbGltaW5hbmRvIGxvcyBlc3BhY2lvcyB2YWPDrW9zIGVudHJlIGVsZW1lbnRvc11gO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bTm8gZnVlIHBvc2libGUgY29tcGFjdGFyIGVsIHRpbWVsaW5lLiBQdWVkZSBxdWUgbm8gaGF5YSBlbGVtZW50b3MgbyBlc3BhY2lvcyB2YWPDrW9zIHF1ZSBjb21wYWN0YXJdYDtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxlbWVudEFkZGVkID0gdHJ1ZTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWwgY29tcGFjdGFyIGVsIHRpbWVsaW5lOlwiLCBlcnJvcik7XG4gICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0Vycm9yIGFsIGludGVudGFyIGNvbXBhY3RhciBlbCB0aW1lbGluZTogJHtlcnJvci5tZXNzYWdlIHx8IFwiRXJyb3IgZGVzY29ub2NpZG9cIn1dYDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZWxzZSBpZiAoZWxlbWVudC50eXBlID09PSBcInNtYXJ0VHJpbVwiKSB7XG4gICAgICAgIC8vIEVqZWN1dGFyIGVsIHJlY29ydGUgaW50ZWxpZ2VudGVcbiAgICAgICAgY29uc29sZS5sb2coXCJJbmljaWFuZG8gcmVjb3J0ZSBpbnRlbGlnZW50ZSBwb3Igc29saWNpdHVkIGRlbCB1c3VhcmlvXCIpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8gTW9zdHJhciBtZW5zYWplIGRlIGFuw6FsaXNpcyBlbiBjdXJzb1xuICAgICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltBbmFsaXphbmRvIGVsIHZpZGVvIHBhcmEgaWRlbnRpZmljYXIgbGFzIHBhcnRlcyBhIGVsaW1pbmFyLi4uXWA7XG5cbiAgICAgICAgICAvLyBJbmljaWFyIGVsIHJlY29ydGUgaW50ZWxpZ2VudGVcbiAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb21tYW5kRXhlY3V0b3IuY3VycmVudC5zbWFydFRyaW0oKTtcblxuICAgICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIGZpbmFsUmVzcG9uc2UgKz0gYFxcblxcbltIZSByZWFsaXphZG8gdW4gcmVjb3J0ZSBpbnRlbGlnZW50ZSBkZWwgdmlkZW8sIGVsaW1pbmFuZG8gbGFzIHBhcnRlcyBpbm5lY2VzYXJpYXMgeSBjb21wYWN0YW5kbyBlbCB0aW1lbGluZV1gO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaW5hbFJlc3BvbnNlICs9IGBcXG5cXG5bTm8gZnVlIHBvc2libGUgcmVhbGl6YXIgZWwgcmVjb3J0ZSBpbnRlbGlnZW50ZS4gVmVyaWZpY2EgcXVlIGVsIHZpZGVvIHRlbmdhIHVuYSB0cmFuc2NyaXBjacOzbl1gO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbGVtZW50QWRkZWQgPSB0cnVlO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBhbCByZWFsaXphciBlbCByZWNvcnRlIGludGVsaWdlbnRlOlwiLCBlcnJvcik7XG4gICAgICAgICAgZmluYWxSZXNwb25zZSArPSBgXFxuXFxuW0Vycm9yIGFsIGludGVudGFyIHJlYWxpemFyIGVsIHJlY29ydGUgaW50ZWxpZ2VudGU6ICR7ZXJyb3IubWVzc2FnZSB8fCBcIkVycm9yIGRlc2Nvbm9jaWRvXCJ9XWA7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFsIHByb2Nlc2FyIGVsZW1lbnRvIGRldGVjdGFkbzpcIiwgZXJyb3IpO1xuICAgIGZpbmFsUmVzcG9uc2UgKz0gXCJcXG5cXG5bTm8gcHVkZSBwcm9jZXNhciBsYSBzb2xpY2l0dWQgZGViaWRvIGEgdW4gZXJyb3IuXVwiO1xuICB9XG5cbiAgcmV0dXJuIHsgZmluYWxSZXNwb25zZSwgZWxlbWVudEFkZGVkIH07XG59O1xuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBBSUNoYXQoKSB7XG4gIGNvbnN0IFttZXNzYWdlcywgc2V0TWVzc2FnZXNdID0gdXNlU3RhdGU8TWVzc2FnZVtdPihbXG4gICAge1xuICAgICAgaWQ6IFwiMVwiLFxuICAgICAgY29udGVudDogXCJIb2xhLCBzb3kgdHUgYXNpc3RlbnRlIGRlIGVkaWNpw7NuIGRlIHZpZGVvLiDCv0VuIHF1w6kgcHVlZG8gYXl1ZGFydGU/XCIsXG4gICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgIH0sXG4gIF0pO1xuICBjb25zdCBbaW5wdXQsIHNldElucHV0XSA9IHVzZVN0YXRlKFwiXCIpO1xuICBjb25zdCBbaXNMb2FkaW5nLCBzZXRJc0xvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbaW1hZ2VGaWxlLCBzZXRJbWFnZUZpbGVdID0gdXNlU3RhdGU8RmlsZSB8IG51bGw+KG51bGwpO1xuICBjb25zdCBbaW1hZ2VQcmV2aWV3LCBzZXRJbWFnZVByZXZpZXddID0gdXNlU3RhdGU8c3RyaW5nIHwgbnVsbD4obnVsbCk7XG4gIGNvbnN0IFtpc1VwbG9hZGluZywgc2V0SXNVcGxvYWRpbmddID0gdXNlU3RhdGUoZmFsc2UpO1xuICAvLyBBbG1hY2VuYXIgbGEgw7psdGltYSBpbWFnZW4gc3ViaWRhIHBhcmEgcG9kZXIgcmV1dGlsaXphcmxhXG4gIGNvbnN0IFtsYXN0VXBsb2FkZWRJbWFnZVVybCwgc2V0TGFzdFVwbG9hZGVkSW1hZ2VVcmxdID0gdXNlU3RhdGU8c3RyaW5nPihcIlwiKTtcbiAgY29uc3QgZmlsZUlucHV0UmVmID0gdXNlUmVmPEhUTUxJbnB1dEVsZW1lbnQ+KG51bGwpO1xuICBjb25zdCBtZXNzYWdlc0VuZFJlZiA9IHVzZVJlZjxIVE1MRGl2RWxlbWVudD4obnVsbCk7XG5cbiAgLy8gUmVmZXJlbmNpYSBhbCBzdGF0ZSBtYW5hZ2VyIHBhcmEgbWFuaXB1bGFyIGVsIGVkaXRvclxuICBjb25zdCBzdGF0ZU1hbmFnZXIgPSB1c2VTdGF0ZU1hbmFnZXIoKTtcbiAgY29uc3QgeyB0aW1lbGluZSwgc2NlbmVzLCBwbGF5ZXJSZWYgfSA9IHVzZURhdGFTdGF0ZSgpO1xuICBjb25zdCBjb21tYW5kRXhlY3V0b3IgPSB1c2VSZWY8VmlkZW9Db21tYW5kRXhlY3V0b3I+KGNyZWF0ZVZpZGVvQ29tbWFuZEV4ZWN1dG9yKHN0YXRlTWFuYWdlcikpO1xuXG4gIC8vIEZ1bmNpw7NuIHBhcmEgcmVpbmljaWFyIGVsIGNoYXRcbiAgY29uc3QgcmVzZXRDaGF0ID0gKCkgPT4ge1xuICAgIHNldE1lc3NhZ2VzKFtcbiAgICAgIHtcbiAgICAgICAgaWQ6IERhdGUubm93KCkudG9TdHJpbmcoKSxcbiAgICAgICAgY29udGVudDogXCJIb2xhLCBzb3kgdHUgYXNpc3RlbnRlIGRlIGVkaWNpw7NuIGRlIHZpZGVvLiDCv0VuIHF1w6kgcHVlZG8gYXl1ZGFydGU/XCIsXG4gICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgIH0sXG4gICAgXSk7XG4gICAgc2V0SW5wdXQoXCJcIik7XG4gICAgc2V0SW1hZ2VGaWxlKG51bGwpO1xuICAgIHNldEltYWdlUHJldmlldyhudWxsKTtcbiAgICBzZXRMYXN0VXBsb2FkZWRJbWFnZVVybChcIlwiKTtcbiAgfTtcblxuICAvLyBTY3JvbGwgYWwgw7psdGltbyBtZW5zYWplXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbWVzc2FnZXNFbmRSZWYuY3VycmVudD8uc2Nyb2xsSW50b1ZpZXcoeyBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcbiAgfSwgW21lc3NhZ2VzXSk7XG5cbiAgLy8gQWN0dWFsaXphciBlbCBlamVjdXRvciBkZSBjb21hbmRvcyBjdWFuZG8gY2FtYmllIGVsIHN0YXRlTWFuYWdlclxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbW1hbmRFeGVjdXRvci5jdXJyZW50ID0gY3JlYXRlVmlkZW9Db21tYW5kRXhlY3V0b3Ioc3RhdGVNYW5hZ2VyKTtcbiAgfSwgW3N0YXRlTWFuYWdlcl0pO1xuXG4gIC8vIE1hbmVqYXIgY2xpY2sgZW4gZWwgYm90w7NuIGRlIGltYWdlblxuICBjb25zdCBoYW5kbGVJbWFnZUNsaWNrID0gKCkgPT4ge1xuICAgIGZpbGVJbnB1dFJlZi5jdXJyZW50Py5jbGljaygpO1xuICB9O1xuXG4gIC8vIE1hbmVqYXIgc2VsZWNjacOzbiBkZSBhcmNoaXZvIGRlIGltYWdlblxuICBjb25zdCBoYW5kbGVGaWxlQ2hhbmdlID0gKGU6IFJlYWN0LkNoYW5nZUV2ZW50PEhUTUxJbnB1dEVsZW1lbnQ+KSA9PiB7XG4gICAgY29uc3QgZmlsZSA9IGUudGFyZ2V0LmZpbGVzPy5bMF07XG4gICAgaWYgKGZpbGUpIHtcbiAgICAgIHNldEltYWdlRmlsZShmaWxlKTtcbiAgICAgIGNvbnN0IHByZXZpZXdVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGZpbGUpO1xuICAgICAgc2V0SW1hZ2VQcmV2aWV3KHByZXZpZXdVcmwpO1xuICAgIH1cbiAgfTtcblxuICAvLyBFbGltaW5hciBsYSBpbWFnZW4gc2VsZWNjaW9uYWRhXG4gIGNvbnN0IGhhbmRsZVJlbW92ZUltYWdlID0gKCkgPT4ge1xuICAgIHNldEltYWdlRmlsZShudWxsKTtcbiAgICBzZXRJbWFnZVByZXZpZXcobnVsbCk7XG4gICAgaWYgKGZpbGVJbnB1dFJlZi5jdXJyZW50KSBmaWxlSW5wdXRSZWYuY3VycmVudC52YWx1ZSA9ICcnO1xuICB9O1xuXG4gIC8vIFN1YmlyIGltYWdlbiBhbCBzZXJ2aWRvclxuICBjb25zdCB1cGxvYWRJbWFnZSA9IGFzeW5jIChmaWxlOiBGaWxlKTogUHJvbWlzZTxzdHJpbmc+ID0+IHtcbiAgICB0cnkge1xuICAgICAgc2V0SXNVcGxvYWRpbmcodHJ1ZSk7XG4gICAgICAvLyBPYnRlbmVyIFVSTCBmaXJtYWRhIHBhcmEgc3ViaXIgbGEgaW1hZ2VuXG4gICAgICBjb25zdCB1cGxvYWREZXRhaWxzID0gYXdhaXQgY3JlYXRlVXBsb2Fkc0RldGFpbHMoZmlsZS5uYW1lLCBmaWxlKTtcblxuICAgICAgLy8gU2kgbm8gZXMgdW4gbW9jayBsb2NhbCwgcHJvY2VkZXIgY29uIGxhIGNhcmdhXG4gICAgICBpZiAodXBsb2FkRGV0YWlscy51cGxvYWRVcmwgIT09IFwibG9jYWwtbW9ja1wiKSB7XG4gICAgICAgIC8vIFN1YmlyIGxhIGltYWdlblxuICAgICAgICBhd2FpdCBmZXRjaCh1cGxvYWREZXRhaWxzLnVwbG9hZFVybCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXG4gICAgICAgICAgYm9keTogZmlsZSxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogZmlsZS50eXBlLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgLy8gTm8gc2UgbmVjZXNpdGEgaGFjZXIgZmV0Y2ggc2kgZXMgdW4gbW9jayBsb2NhbCAoZGF0YVVSTClcblxuICAgICAgLy8gUmV0b3JuYXIgbGEgVVJMIHDDumJsaWNhIGRlIGxhIGltYWdlblxuICAgICAgcmV0dXJuIHVwbG9hZERldGFpbHMudXJsO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWwgc3ViaXIgbGEgaW1hZ2VuOlwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBzZSBwdWRvIHN1YmlyIGxhIGltYWdlbi4gSW50w6ludGFsbyBkZSBudWV2by5cIik7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzVXBsb2FkaW5nKGZhbHNlKTtcbiAgICB9XG4gIH07XG5cbiAgLy8gRnVuY2nDs24gcGFyYSBlbnZpYXIgbWVuc2FqZVxuICBjb25zdCBoYW5kbGVTZW5kTWVzc2FnZSA9IGFzeW5jICgpID0+IHtcbiAgICBpZiAoKCFpbnB1dC50cmltKCkgJiYgIWltYWdlRmlsZSkgfHwgaXNMb2FkaW5nKSByZXR1cm47XG5cbiAgICBsZXQgdXNlck1lc3NhZ2U6IE1lc3NhZ2UgPSB7XG4gICAgICBpZDogRGF0ZS5ub3coKS50b1N0cmluZygpLFxuICAgICAgY29udGVudDogaW5wdXQsXG4gICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICB9O1xuXG4gICAgbGV0IHVwbG9hZGVkSW1hZ2VVcmwgPSBcIlwiO1xuICAgIC8vIFZhcmlhYmxlIHBhcmEgcmFzdHJlYXIgbGEgVVJMIGRlIGxhIGltYWdlbiBhY3R1YWwgcGFyYSBlc3RhIHNvbGljaXR1ZCBlc3BlY8OtZmljYVxuICAgIGxldCBjdXJyZW50SW1hZ2VVcmxGb3JUaGlzUmVxdWVzdCA9IFwiXCI7XG5cbiAgICAvLyBTaSBoYXkgdW5hIGltYWdlbiBwYXJhIHN1YmlyLCBwcm9jZXNhcmxhXG4gICAgaWYgKGltYWdlRmlsZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgdXBsb2FkZWRJbWFnZVVybCA9IGF3YWl0IHVwbG9hZEltYWdlKGltYWdlRmlsZSk7XG4gICAgICAgIHVzZXJNZXNzYWdlLmltYWdlVXJsID0gdXBsb2FkZWRJbWFnZVVybDtcbiAgICAgICAgLy8gR3VhcmRhciBsYSBVUkwgZGUgbGEgaW1hZ2VuIHBhcmEgcG9zaWJsZXMgcmVmZXJlbmNpYXMgZnV0dXJhc1xuICAgICAgICBzZXRMYXN0VXBsb2FkZWRJbWFnZVVybCh1cGxvYWRlZEltYWdlVXJsKTtcbiAgICAgICAgLy8gSW1wb3J0YW50ZTogR3VhcmRhciBsYSBVUkwgYWN0dWFsIHBhcmEgZXN0YSBzb2xpY2l0dWQgZXNwZWPDrWZpY2FcbiAgICAgICAgY3VycmVudEltYWdlVXJsRm9yVGhpc1JlcXVlc3QgPSB1cGxvYWRlZEltYWdlVXJsO1xuICAgICAgICBjb25zb2xlLmxvZyhcIkltYWdlbiBzdWJpZGEgZXhpdG9zYW1lbnRlOlwiLCB1cGxvYWRlZEltYWdlVXJsLnN1YnN0cmluZygwLCAxMDApICsgXCIuLi5cIik7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZW4gbGEgc3ViaWRhIGRlIGltYWdlbjpcIiwgZXJyb3IpO1xuICAgICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gW1xuICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6IChEYXRlLm5vdygpICsgMSkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwiRXJyb3IgYWwgc3ViaXIgbGEgaW1hZ2VuLiBQb3IgZmF2b3IsIGludMOpbnRhbG8gZGUgbnVldm8uIERldGFsbGVzOiBcIiArXG4gICAgICAgICAgICAgIChlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFwiRXJyb3IgZGVzY29ub2NpZG9cIiksXG4gICAgICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICAgIH0sXG4gICAgICAgIF0pO1xuICAgICAgICBzZXRJc0xvYWRpbmcoZmFsc2UpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gQcOxYWRpciBtZW5zYWplIGRlbCB1c3VhcmlvXG4gICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFsuLi5wcmV2LCB1c2VyTWVzc2FnZV0pO1xuICAgIHNldElucHV0KFwiXCIpO1xuICAgIHNldEltYWdlRmlsZShudWxsKTtcbiAgICBzZXRJbWFnZVByZXZpZXcobnVsbCk7XG4gICAgaWYgKGZpbGVJbnB1dFJlZi5jdXJyZW50KSBmaWxlSW5wdXRSZWYuY3VycmVudC52YWx1ZSA9ICcnO1xuICAgIHNldElzTG9hZGluZyh0cnVlKTtcblxuICAgIHRyeSB7XG4gICAgICAvLyBFbnZpYXIgYSBsYSBBUEkgcGFyYSBwcm9jZXNhbWllbnRvIGVuIGxlbmd1YWplIG5hdHVyYWxcbiAgICAgIGNvbnN0IGFwaU1lc3NhZ2VzID0gbWVzc2FnZXNcbiAgICAgICAgLmNvbmNhdCh1c2VyTWVzc2FnZSlcbiAgICAgICAgLm1hcChtc2cgPT4ge1xuICAgICAgICAgIC8vIFNpIGVsIG1lbnNhamUgdGllbmUgdW5hIGltYWdlbiwgY3JlYXIgdW4gZm9ybWF0byBlc3BlY2lhbCBwYXJhIGVsIGNvbnRlbmlkb1xuICAgICAgICAgIGlmIChtc2cuaW1hZ2VVcmwpIHtcbiAgICAgICAgICAgIC8vIFNpIGVzIHVuYSBVUkwgZGUgZGF0b3MgKGNvbWllbnphIGNvbiBkYXRhOiksIHVzYXIgdW4gbWFyY2Fkb3IgZXNwZWNpYWxcbiAgICAgICAgICAgIGNvbnN0IGlzRGF0YVVybCA9IG1zZy5pbWFnZVVybC5zdGFydHNXaXRoKCdkYXRhOicpO1xuICAgICAgICAgICAgY29uc3QgaW1hZ2VVcmxUb1NlbmQgPSBpc0RhdGFVcmxcbiAgICAgICAgICAgICAgPyAnW0lNQUdFTl9BREpVTlRBXSdcbiAgICAgICAgICAgICAgOiBgW0lNQUdFTjogJHttc2cuaW1hZ2VVcmx9XWA7XG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHJvbGU6IG1zZy5yb2xlLFxuICAgICAgICAgICAgICBjb250ZW50OiBgJHttc2cuY29udGVudCB8fCAnJ30gJHtpbWFnZVVybFRvU2VuZH1gXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByb2xlOiBtc2cucm9sZSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IG1zZy5jb250ZW50XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgIC8vIEHDsWFkaXIgY29udGV4dG8gZGVsIGVkaXRvciBwYXJhIGxhIElBIGV4dGVybmFcbiAgICAgIGNvbnN0IGNvbnRleHRNZXNzYWdlID0ge1xuICAgICAgICByb2xlOiAnc3lzdGVtJyxcbiAgICAgICAgY29udGVudDogYFxuQ29udGV4dG8gYWN0dWFsIGRlbCBlZGl0b3IgZGUgdmlkZW86XG4tIFBvc2ljacOzbiBhY3R1YWwgKHNlZ3VuZG9zKTogJHtwbGF5ZXJSZWY/LmN1cnJlbnQ/LmdldEN1cnJlbnRUaW1lID8gTWF0aC5mbG9vcigocGxheWVyUmVmLmN1cnJlbnQuZ2V0Q3VycmVudFRpbWUoKSB8fCAwKSAqIDEwMCkgLyAxMDAgOiAwfVxuLSBEdXJhY2nDs24gZGVsIHByb3llY3RvIChzZWd1bmRvcyk6ICR7dGltZWxpbmU/LmR1cmF0aW9uID8gTWF0aC5mbG9vcih0aW1lbGluZS5kdXJhdGlvbiAvIDEwMDApIDogMH1cbi0gTsO6bWVybyBkZSBlc2NlbmFzOiAke3NjZW5lcz8ubGVuZ3RoIHx8IDB9XG4tIE7Dum1lcm8gZGUgZWxlbWVudG9zIGVuIGVsIHRpbWVsaW5lOiAkeyh0aW1lbGluZT8uY2FudmFzPy5nZXRPYmplY3RzPy4oKSB8fCBbXSkubGVuZ3RoIC0gMSA+IDAgPyAodGltZWxpbmU/LmNhbnZhcz8uZ2V0T2JqZWN0cz8uKCkgfHwgW10pLmxlbmd0aCAtIDEgOiAwfVxuJHtsYXN0VXBsb2FkZWRJbWFnZVVybCA/IGAtIMOabHRpbWEgaW1hZ2VuIGNvbXBhcnRpZGEgcG9yIGVsIHVzdWFyaW8gZGlzcG9uaWJsZSBwYXJhIHVzYXJgIDogJyd9XG5cbkVsIHVzdWFyaW8gcHVlZGUgZXhwcmVzYXIgZW4gbGVuZ3VhamUgbmF0dXJhbCBsYSBuZWNlc2lkYWQgZGUgYWdyZWdhciBlbGVtZW50b3MgYWwgdmlkZW8uXG5FamVtcGxvczpcbi0gXCJQb24gdW4gdMOtdHVsbyBxdWUgZGlnYSAnQmllbnZlbmlkb3MnIGFsIGluaWNpb1wiXG4tIFwiUXVpZXJvIHVuIHRleHRvIGJsYW5jbyBxdWUgZGlnYSAnRmluJyBhbCBmaW5hbCBkZWwgdmlkZW9cIlxuLSBcIk5lY2VzaXRvIHVuYSBpbWFnZW4gZW4gZWwgc2VndW5kbyAxMFwiXG4tIFwiQ29sb2NhIHVuIHZpZGVvIGRlIGludHJvZHVjY2nDs24gYWwgcHJpbmNpcGlvXCJcblxuU2kgZWwgdXN1YXJpbyBhZGp1bnRhIHVuYSBpbWFnZW4gZW4gZWwgbWVuc2FqZSwgbGEgVVJMIGVzdGFyw6EgZW4gZm9ybWF0byBbSU1BR0VOOiB1cmxfZGVfbGFfaW1hZ2VuXS5cbkRlYmVzIGRldGVjdGFyIHNpIHF1aWVyZSBhZ3JlZ2FyIGVzdGEgaW1hZ2VuIGFsIHZpZGVvIHkgZW4gcXXDqSBtb21lbnRvIHRlbXBvcmFsLlxuYFxuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9haScsIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgbWVzc2FnZXM6IFtjb250ZXh0TWVzc2FnZSwgLi4uYXBpTWVzc2FnZXNdLFxuICAgICAgICAgICAgLy8gVXNhciBsYSBVUkwgZGUgbGEgaW1hZ2VuIGFjdHVhbCBwYXJhIGVzdGEgc29saWNpdHVkIHNpIGV4aXN0ZSxcbiAgICAgICAgICAgIC8vIGRlIGxvIGNvbnRyYXJpbyB1c2FyIGxhIMO6bHRpbWEgVVJMIGd1YXJkYWRhXG4gICAgICAgICAgICBsYXN0SW1hZ2VVcmw6IGN1cnJlbnRJbWFnZVVybEZvclRoaXNSZXF1ZXN0IHx8IGxhc3RVcGxvYWRlZEltYWdlVXJsIHx8IFwiXCJcbiAgICAgICAgICB9KSxcbiAgICAgICAgICAvLyBBZ3JlZ2FyIHRpbWVvdXQgcGFyYSBldml0YXIgZXNwZXJhcyBpbmZpbml0YXNcbiAgICAgICAgICBzaWduYWw6IEFib3J0U2lnbmFsLnRpbWVvdXQoMTUwMDApIC8vIDE1IHNlZ3VuZG9zIG3DoXhpbW9cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZGUgQVBJOiAke3Jlc3BvbnNlLnN0YXR1c30gJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcblxuICAgICAgICAvLyBBc2VndXJhcnNlIGRlIHF1ZSBkYXRhLm1lc3NhZ2UuY29udGVudCBleGlzdGVcbiAgICAgICAgY29uc3QgYWlSZXNwb25zZSA9IGRhdGE/Lm1lc3NhZ2U/LmNvbnRlbnQgfHwgXCJMbyBzaWVudG8sIG5vIHB1ZGUgZW50ZW5kZXIgdHUgc29saWNpdHVkLlwiO1xuXG4gICAgICAgIC8vIE9idGVuZXIgbG9zIGRhdG9zIGRlbCBlbGVtZW50byBzaSBleGlzdGVuIChjb24gdmVyaWZpY2FjacOzbiBzZWd1cmEpXG4gICAgICAgIGNvbnN0IGVsZW1lbnREYXRhID0gZGF0YT8uZWxlbWVudERhdGE7XG5cbiAgICAgICAgLy8gVmFyaWFibGUgcGFyYSBsYSByZXNwdWVzdGEgZmluYWxcbiAgICAgICAgbGV0IGZpbmFsUmVzcG9uc2UgPSBhaVJlc3BvbnNlO1xuICAgICAgICAvLyBDcmVhciB1bmEgcmVmZXJlbmNpYSBhIGxhIHJlc3B1ZXN0YSBmaW5hbCBwYXJhIHF1ZSBzZWEgYWNjZXNpYmxlIGVuIGxhIGZ1bmNpw7NuIHByb2Nlc2Fkb3JhXG4gICAgICAgIGNvbnN0IGZpbmFsUmVzcG9uc2VSZWYgPSB7IGN1cnJlbnQ6IGZpbmFsUmVzcG9uc2UgfTtcbiAgICAgICAgbGV0IGVsZW1lbnRBZGRlZCA9IGZhbHNlO1xuXG4gICAgICAgIC8vIFVzYXIgbGEgZnVuY2nDs24gZGUgcHJvY2VzYW1pZW50byBkZSBlbGVtZW50b3NcbiAgICAgICAgY29uc3QgcHJvY2Vzc1Jlc3VsdCA9IGF3YWl0IHByb2Nlc3NEZXRlY3RlZEVsZW1lbnQoXG4gICAgICAgICAgZWxlbWVudERhdGEsXG4gICAgICAgICAgY29tbWFuZEV4ZWN1dG9yLFxuICAgICAgICAgIGZpbmFsUmVzcG9uc2VSZWYsXG4gICAgICAgICAgdGltZWxpbmUsXG4gICAgICAgICAgbGFzdFVwbG9hZGVkSW1hZ2VVcmwsXG4gICAgICAgICAgY3VycmVudEltYWdlVXJsRm9yVGhpc1JlcXVlc3RcbiAgICAgICAgKTtcblxuICAgICAgICBmaW5hbFJlc3BvbnNlID0gcHJvY2Vzc1Jlc3VsdC5maW5hbFJlc3BvbnNlO1xuICAgICAgICBlbGVtZW50QWRkZWQgPSBwcm9jZXNzUmVzdWx0LmVsZW1lbnRBZGRlZDtcblxuICAgICAgICBjb25zdCBhc3Npc3RhbnRNZXNzYWdlOiBNZXNzYWdlID0ge1xuICAgICAgICAgIGlkOiAoRGF0ZS5ub3coKSArIDEpLnRvU3RyaW5nKCksXG4gICAgICAgICAgY29udGVudDogZmluYWxSZXNwb25zZSxcbiAgICAgICAgICByb2xlOiBcImFzc2lzdGFudFwiLFxuICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgfTtcblxuICAgICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gWy4uLnByZXYsIGFzc2lzdGFudE1lc3NhZ2VdKTtcbiAgICAgIH0gY2F0Y2ggKGFwaUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBlbiBsYSBjb211bmljYWNpw7NuIGNvbiBsYSBBUEk6XCIsIGFwaUVycm9yKTtcblxuICAgICAgICAvLyBNZW5zYWplIGRlIGVycm9yIGVzcGVjw61maWNvIGRlIEFQSVxuICAgICAgICBzZXRNZXNzYWdlcygocHJldikgPT4gW1xuICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6IChEYXRlLm5vdygpICsgMSkudG9TdHJpbmcoKSxcbiAgICAgICAgICAgIGNvbnRlbnQ6IFwiTG8gc2llbnRvLCBoYSBvY3VycmlkbyB1biBlcnJvciBhbCBjb211bmljYXJzZSBjb24gZWwgc2VydmljaW8gZGUgSUEuIFBvciBmYXZvciwgaW50ZW50YSBkZSBudWV2byBlbiB1bm9zIG1vbWVudG9zLlwiLFxuICAgICAgICAgICAgcm9sZTogXCJhc3Npc3RhbnRcIixcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9LFxuICAgICAgICBdKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGFsIHByb2Nlc2FyIGVsIG1lbnNhamU6XCIsIGVycm9yKTtcblxuICAgICAgLy8gRGV0ZXJtaW5hciBtZW5zYWplIGRlIGVycm9yIGFwcm9waWFkb1xuICAgICAgbGV0IGVycm9yTWVzc2FnZSA9IFwiTG8gc2llbnRvLCBoYSBvY3VycmlkbyB1biBlcnJvciBhbCBwcm9jZXNhciB0dSBtZW5zYWplLlwiO1xuXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgICBpZiAoZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcInRpbWVvdXRcIikgfHwgZXJyb3IubWVzc2FnZS5pbmNsdWRlcyhcImFib3J0XCIpKSB7XG4gICAgICAgICAgZXJyb3JNZXNzYWdlID0gXCJMYSBzb2xpY2l0dWQgaGEgdGFyZGFkbyBkZW1hc2lhZG8uIFBydWViYSBjb24gdW4gbWVuc2FqZSBtw6FzIGNvcnRvLlwiO1xuICAgICAgICB9IGVsc2UgaWYgKGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJuZXR3b3JrXCIpIHx8IGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoXCJmZXRjaFwiKSkge1xuICAgICAgICAgIGVycm9yTWVzc2FnZSA9IFwiUGFyZWNlIHF1ZSBoYXkgdW4gcHJvYmxlbWEgZGUgY29uZXhpw7NuLiBWZXJpZmljYSB0dSBjb25leGnDs24gYSBpbnRlcm5ldCBlIGludGVudGEgZGUgbnVldm8uXCI7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTWVuc2FqZSBkZSBlcnJvclxuICAgICAgc2V0TWVzc2FnZXMoKHByZXYpID0+IFtcbiAgICAgICAgLi4ucHJldixcbiAgICAgICAge1xuICAgICAgICAgIGlkOiAoRGF0ZS5ub3coKSArIDEpLnRvU3RyaW5nKCksXG4gICAgICAgICAgY29udGVudDogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgIHJvbGU6IFwiYXNzaXN0YW50XCIsXG4gICAgICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLFxuICAgICAgICB9LFxuICAgICAgXSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHNldElzTG9hZGluZyhmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGgtZnVsbCBmbGV4LWNvbCBib3JkZXItciBib3JkZXItYm9yZGVyLzgwIGJnLXNpZGViYXJcIj5cbiAgICAgIHsvKiBIZWFkZXIgZGVsIGNoYXQgc2ltcGxpZmljYWRvICovfVxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJiZy1bIzFhMTYyNV0gcC0zIGZsZXgganVzdGlmeS1iZXR3ZWVuIGl0ZW1zLWNlbnRlclwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJoLTggdy04IHJvdW5kZWQtZnVsbCBmbGV4IGl0ZW1zLWNlbnRlciBqdXN0aWZ5LWNlbnRlciBiZy1ncmFkaWVudC10by1iciBmcm9tLXB1cnBsZS02MDAgdG8taW5kaWdvLTcwMCB0ZXh0LXdoaXRlXCI+XG4gICAgICAgICAgICA8U3BhcmtsZXMgY2xhc3NOYW1lPVwiaC00IHctNFwiIC8+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGgzIGNsYXNzTmFtZT1cImZvbnQtbWVkaXVtIHRleHQtcHVycGxlLTUwXCI+QXNpc3RlbnRlIFdhbmRzPC9oMz5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxCdXR0b25cbiAgICAgICAgICB2YXJpYW50PVwiZ2hvc3RcIlxuICAgICAgICAgIHNpemU9XCJpY29uXCJcbiAgICAgICAgICBjbGFzc05hbWU9XCJoLTggdy04IHJvdW5kZWQtZnVsbCBob3ZlcjpiZy1wdXJwbGUtODAwLzQwXCJcbiAgICAgICAgICBvbkNsaWNrPXtyZXNldENoYXR9XG4gICAgICAgID5cbiAgICAgICAgICA8UmVmcmVzaEN3IGNsYXNzTmFtZT1cImgtNCB3LTQgdGV4dC1wdXJwbGUtMzAwXCIgLz5cbiAgICAgICAgPC9CdXR0b24+XG4gICAgICA8L2Rpdj5cblxuICAgICAgey8qIMOBcmVhIGRlIG1lbnNhamVzIHNpbXBsaWZpY2FkYSAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZmxleC0xIG92ZXJmbG93LWF1dG8gYmctWyMyMTFhMmNdIHAtNCBzcGFjZS15LTRcIj5cbiAgICAgICAge21lc3NhZ2VzLm1hcCgobWVzc2FnZSkgPT4gKFxuICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgIGtleT17bWVzc2FnZS5pZH1cbiAgICAgICAgICAgIGNsYXNzTmFtZT17YGZsZXggZmxleC1jb2wgJHtcbiAgICAgICAgICAgICAgbWVzc2FnZS5yb2xlID09PSBcImFzc2lzdGFudFwiID8gXCJpdGVtcy1zdGFydFwiIDogXCJpdGVtcy1lbmRcIlxuICAgICAgICAgICAgfWB9XG4gICAgICAgICAgPlxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2BtYXgtdy1bODUlXSByb3VuZGVkLWxnIHB4LTQgcHktMi41ICR7XG4gICAgICAgICAgICAgICAgbWVzc2FnZS5yb2xlID09PSBcImFzc2lzdGFudFwiXG4gICAgICAgICAgICAgICAgICA/IFwiYmctWyMyYTFmMzVdIHRleHQtcHVycGxlLTUwXCJcbiAgICAgICAgICAgICAgICAgIDogXCJiZy1ncmFkaWVudC10by1yIGZyb20tcHVycGxlLTYwMCB0by1pbmRpZ28tNzAwIHRleHQtd2hpdGVcIlxuICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3aGl0ZXNwYWNlLXByZS13cmFwXCI+e21lc3NhZ2UuY29udGVudH08L2Rpdj5cbiAgICAgICAgICAgICAge21lc3NhZ2UuaW1hZ2VVcmwgJiYgKFxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibXQtMlwiPlxuICAgICAgICAgICAgICAgICAgPGltZ1xuICAgICAgICAgICAgICAgICAgICBzcmM9e21lc3NhZ2UuaW1hZ2VVcmx9XG4gICAgICAgICAgICAgICAgICAgIGFsdD1cIkltYWdlbiBhZGp1bnRhXCJcbiAgICAgICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwibWF4LWgtNDggbWF4LXctZnVsbCByb3VuZGVkLW1kIG9iamVjdC1jb250YWluXCJcbiAgICAgICAgICAgICAgICAgIC8+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgKSl9XG4gICAgICAgIDxkaXYgcmVmPXttZXNzYWdlc0VuZFJlZn0gLz5cbiAgICAgIDwvZGl2PlxuXG4gICAgICB7Lyogw4FyZWEgZGUgdmlzdGEgcHJldmlhIGRlIGltYWdlbiBzaW1wbGlmaWNhZGEgKi99XG4gICAgICB7aW1hZ2VQcmV2aWV3ICYmIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJyZWxhdGl2ZSBteC00IG10LTEgbWItMiBoLTI0IGJnLVsjMmExZjM1XSBwLTIgZmxleCBpdGVtcy1jZW50ZXIganVzdGlmeS1jZW50ZXJcIj5cbiAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICB2YXJpYW50PVwiZ2hvc3RcIlxuICAgICAgICAgICAgc2l6ZT1cImljb25cIlxuICAgICAgICAgICAgY2xhc3NOYW1lPVwiYWJzb2x1dGUgcmlnaHQtMSB0b3AtMSB6LTEwIGgtNSB3LTUgcm91bmRlZC1mdWxsIGJnLVsjMjExYTJjXS84MCBob3ZlcjpiZy1yZWQtODAwLzgwXCJcbiAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVJlbW92ZUltYWdlfVxuICAgICAgICAgID5cbiAgICAgICAgICAgIDxYIGNsYXNzTmFtZT1cImgtMyB3LTMgdGV4dC13aGl0ZVwiIC8+XG4gICAgICAgICAgPC9CdXR0b24+XG4gICAgICAgICAgPGltZ1xuICAgICAgICAgICAgc3JjPXtpbWFnZVByZXZpZXd9XG4gICAgICAgICAgICBhbHQ9XCJWaXN0YSBwcmV2aWFcIlxuICAgICAgICAgICAgY2xhc3NOYW1lPVwibWF4LWgtZnVsbCBtYXgtdy1mdWxsIG9iamVjdC1jb250YWluXCJcbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG5cbiAgICAgIHsvKiDDgXJlYSBkZSBlbnRyYWRhIHNpbXBsaWZpY2FkYSAqL31cbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYmctWyMxYTE2MjVdIHAtM1wiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZsZXggaXRlbXMtY2VudGVyIGdhcC0yXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJmbGV4IGJnLVsjMmExZjM1XSByb3VuZGVkLW1kIGZsZXgtMSBvdmVyZmxvdy1oaWRkZW5cIj5cbiAgICAgICAgICAgIDxCdXR0b25cbiAgICAgICAgICAgICAgdmFyaWFudD1cImdob3N0XCJcbiAgICAgICAgICAgICAgc2l6ZT1cImljb25cIlxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoLTEwIHctMTAgYmctdHJhbnNwYXJlbnQgaG92ZXI6YmctcHVycGxlLTgwMC8zMFwiXG4gICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZUltYWdlQ2xpY2t9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxJbWFnZUljb24gY2xhc3NOYW1lPVwiaC01IHctNSB0ZXh0LXB1cnBsZS0zMDBcIiAvPlxuICAgICAgICAgICAgPC9CdXR0b24+XG5cbiAgICAgICAgICAgIDxJbnB1dFxuICAgICAgICAgICAgICB2YWx1ZT17aW5wdXR9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXsoZSkgPT4gc2V0SW5wdXQoZS50YXJnZXQudmFsdWUpfVxuICAgICAgICAgICAgICBvbktleURvd249eyhlKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGUua2V5ID09PSBcIkVudGVyXCIgJiYgIWUuc2hpZnRLZXkpIHtcbiAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgIGhhbmRsZVNlbmRNZXNzYWdlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9fVxuICAgICAgICAgICAgICBwbGFjZWhvbGRlcj1cIkVzY3JpYmUgdHUgbWVuc2FqZS4uLlwiXG4gICAgICAgICAgICAgIGRpc2FibGVkPXtpc0xvYWRpbmd9XG4gICAgICAgICAgICAgIGNsYXNzTmFtZT1cImZsZXgtMSBib3JkZXItMCBiZy10cmFuc3BhcmVudCBoLTEwIGZvY3VzOnJpbmctMCBmb2N1cy12aXNpYmxlOnJpbmctMCB0ZXh0LXB1cnBsZS01MFwiXG4gICAgICAgICAgICAvPlxuXG4gICAgICAgICAgICA8QnV0dG9uXG4gICAgICAgICAgICAgIG9uQ2xpY2s9e2hhbmRsZVNlbmRNZXNzYWdlfVxuICAgICAgICAgICAgICBkaXNhYmxlZD17KCFpbnB1dC50cmltKCkgJiYgIWltYWdlRmlsZSkgfHwgaXNMb2FkaW5nfVxuICAgICAgICAgICAgICBjbGFzc05hbWU9XCJoLTEwIGJnLXRyYW5zcGFyZW50IGhvdmVyOmJnLXB1cnBsZS04MDAvODAgYmctcHVycGxlLTgwMC80MCB0ZXh0LXB1cnBsZS0zMDBcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICB7aXNMb2FkaW5nIHx8IGlzVXBsb2FkaW5nID8gKFxuICAgICAgICAgICAgICAgIDxMb2FkZXIyIGNsYXNzTmFtZT1cImgtNSB3LTUgYW5pbWF0ZS1zcGluXCIgLz5cbiAgICAgICAgICAgICAgKSA6IChcbiAgICAgICAgICAgICAgICA8U2VuZCBjbGFzc05hbWU9XCJoLTQgdy00XCIgLz5cbiAgICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIDwvQnV0dG9uPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuXG4gICAgICA8aW5wdXRcbiAgICAgICAgdHlwZT1cImZpbGVcIlxuICAgICAgICByZWY9e2ZpbGVJbnB1dFJlZn1cbiAgICAgICAgb25DaGFuZ2U9e2hhbmRsZUZpbGVDaGFuZ2V9XG4gICAgICAgIGFjY2VwdD1cImltYWdlLypcIlxuICAgICAgICBjbGFzc05hbWU9XCJoaWRkZW5cIlxuICAgICAgICBkaXNhYmxlZD17aXNMb2FkaW5nfVxuICAgICAgLz5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbiJdLCJuYW1lcyI6WyJ1c2VTdGF0ZSIsInVzZVJlZiIsInVzZUVmZmVjdCIsIkJ1dHRvbiIsIklucHV0IiwiU2VuZCIsIkxvYWRlcjIiLCJJbWFnZUljb24iLCJYIiwiU3BhcmtsZXMiLCJSZWZyZXNoQ3ciLCJ1c2VEYXRhU3RhdGUiLCJ1c2VTdGF0ZU1hbmFnZXIiLCJjcmVhdGVWaWRlb0NvbW1hbmRFeGVjdXRvciIsImNyZWF0ZVVwbG9hZHNEZXRhaWxzIiwiZXh0cmFjdEltYWdlVGltZXNGcm9tTWVzc2FnZSIsIm1lc3NhZ2VDb250ZW50Iiwic3RhcnRUaW1lIiwiZW5kVGltZSIsInN0YXJ0VGltZVBhdHRlcm5zIiwiZW5kVGltZVBhdHRlcm5zIiwiaXNBdFN0YXJ0IiwidGVzdCIsImlzQXRFbmQiLCJwYXR0ZXJuIiwibWF0Y2giLCJ0b1N0cmluZyIsImluY2x1ZGVzIiwicGFyc2VJbnQiLCJwcm9jZXNzRGV0ZWN0ZWRFbGVtZW50IiwiZWxlbWVudERhdGEiLCJjb21tYW5kRXhlY3V0b3IiLCJmaW5hbFJlc3BvbnNlUmVmIiwidGltZWxpbmUiLCJsYXN0VXBsb2FkZWRJbWFnZVVybCIsImN1cnJlbnRJbWFnZVVybEZvclRoaXNSZXF1ZXN0IiwiZWxlbWVudEFkZGVkIiwiZmluYWxSZXNwb25zZSIsImN1cnJlbnQiLCJkZXRlY3RlZCIsImNvbmZpZGVuY2UiLCJlbGVtZW50IiwidHlwZSIsImNvbnRlbnQiLCJ0ZXh0T3B0aW9ucyIsImNvbG9yIiwidG9Mb3dlckNhc2UiLCJhZGRUZXh0IiwiaW1hZ2VPcHRpb25zIiwicG9zaXRpb24iLCJ4IiwieSIsImNvbnNvbGUiLCJsb2ciLCJ2aWRlb0R1cmF0aW9uIiwiZHVyYXRpb24iLCJNYXRoIiwiZmxvb3IiLCJtYXgiLCJpc0dlbmVyaWNVcmwiLCJ1cmwiLCJpc0xvY2FsSW1hZ2UiLCJzdGFydHNXaXRoIiwiaW1hZ2VVcmwiLCJhZGRJbWFnZSIsInZpZGVvT3B0aW9ucyIsInZpZGVvVXJsIiwiYWRkVmlkZW8iLCJzdWJ0aXRsZU9wdGlvbnMiLCJncm91cFdvcmRzIiwidW5kZWZpbmVkIiwiYWRkU3VidGl0bGVzIiwiQXJyYXkiLCJpc0FycmF5Iiwic2VnbWVudHMiLCJsZW5ndGgiLCJtYXAiLCJzZWdtZW50Iiwic2VnbWVudHNGb3JtYXR0ZWQiLCJzIiwiam9pbiIsInJlc3VsdCIsInJlbW92ZVNlZ21lbnRzIiwiZXJyb3IiLCJtZXNzYWdlIiwiY29tcGFjdFRpbWVsaW5lIiwic21hcnRUcmltIiwiQUlDaGF0IiwibWVzc2FnZXMiLCJzZXRNZXNzYWdlcyIsImlkIiwicm9sZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJpbnB1dCIsInNldElucHV0IiwiaXNMb2FkaW5nIiwic2V0SXNMb2FkaW5nIiwiaW1hZ2VGaWxlIiwic2V0SW1hZ2VGaWxlIiwiaW1hZ2VQcmV2aWV3Iiwic2V0SW1hZ2VQcmV2aWV3IiwiaXNVcGxvYWRpbmciLCJzZXRJc1VwbG9hZGluZyIsInNldExhc3RVcGxvYWRlZEltYWdlVXJsIiwiZmlsZUlucHV0UmVmIiwibWVzc2FnZXNFbmRSZWYiLCJzdGF0ZU1hbmFnZXIiLCJzY2VuZXMiLCJwbGF5ZXJSZWYiLCJyZXNldENoYXQiLCJub3ciLCJzY3JvbGxJbnRvVmlldyIsImJlaGF2aW9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImNsaWNrIiwiaGFuZGxlRmlsZUNoYW5nZSIsImUiLCJmaWxlIiwidGFyZ2V0IiwiZmlsZXMiLCJwcmV2aWV3VXJsIiwiVVJMIiwiY3JlYXRlT2JqZWN0VVJMIiwiaGFuZGxlUmVtb3ZlSW1hZ2UiLCJ2YWx1ZSIsInVwbG9hZEltYWdlIiwidXBsb2FkRGV0YWlscyIsIm5hbWUiLCJ1cGxvYWRVcmwiLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJoZWFkZXJzIiwiRXJyb3IiLCJoYW5kbGVTZW5kTWVzc2FnZSIsInRyaW0iLCJ1c2VyTWVzc2FnZSIsInVwbG9hZGVkSW1hZ2VVcmwiLCJzdWJzdHJpbmciLCJwcmV2IiwiYXBpTWVzc2FnZXMiLCJjb25jYXQiLCJtc2ciLCJpc0RhdGFVcmwiLCJpbWFnZVVybFRvU2VuZCIsImNvbnRleHRNZXNzYWdlIiwiZ2V0Q3VycmVudFRpbWUiLCJjYW52YXMiLCJnZXRPYmplY3RzIiwiZGF0YSIsInJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImxhc3RJbWFnZVVybCIsInNpZ25hbCIsIkFib3J0U2lnbmFsIiwidGltZW91dCIsIm9rIiwic3RhdHVzIiwic3RhdHVzVGV4dCIsImpzb24iLCJhaVJlc3BvbnNlIiwicHJvY2Vzc1Jlc3VsdCIsImFzc2lzdGFudE1lc3NhZ2UiLCJhcGlFcnJvciIsImVycm9yTWVzc2FnZSIsImRpdiIsImNsYXNzTmFtZSIsImgzIiwidmFyaWFudCIsInNpemUiLCJvbkNsaWNrIiwiaW1nIiwic3JjIiwiYWx0IiwicmVmIiwiZGlzYWJsZWQiLCJvbkNoYW5nZSIsIm9uS2V5RG93biIsImtleSIsInNoaWZ0S2V5IiwicHJldmVudERlZmF1bHQiLCJwbGFjZWhvbGRlciIsImFjY2VwdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./components/ai-chat/index.tsx\n"));

/***/ })

});