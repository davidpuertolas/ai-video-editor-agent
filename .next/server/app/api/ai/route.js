"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/ai/route";
exports.ids = ["app/api/ai/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Froute&page=%2Fapi%2Fai%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Froute.ts&appDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Froute&page=%2Fapi%2Fai%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Froute.ts&appDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_david_Desktop_ai_video_agent_react_video_editor_app_api_ai_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/ai/route.ts */ \"(rsc)/./app/api/ai/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/ai/route\",\n        pathname: \"/api/ai\",\n        filename: \"route\",\n        bundlePath: \"app/api/ai/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\david\\\\Desktop\\\\ai-video-agent\\\\react-video-editor\\\\app\\\\api\\\\ai\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_david_Desktop_ai_video_agent_react_video_editor_app_api_ai_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/ai/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhaSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYWklMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhaSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNkYXZpZCU1Q0Rlc2t0b3AlNUNhaS12aWRlby1hZ2VudCU1Q3JlYWN0LXZpZGVvLWVkaXRvciU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDZGF2aWQlNUNEZXNrdG9wJTVDYWktdmlkZW8tYWdlbnQlNUNyZWFjdC12aWRlby1lZGl0b3ImaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3FDO0FBQ2xIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcmVtb3Rpb24tY2FwdGlvbnMvP2ZiZTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiQzpcXFxcVXNlcnNcXFxcZGF2aWRcXFxcRGVza3RvcFxcXFxhaS12aWRlby1hZ2VudFxcXFxyZWFjdC12aWRlby1lZGl0b3JcXFxcYXBwXFxcXGFwaVxcXFxhaVxcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9haVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvYWkvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxkYXZpZFxcXFxEZXNrdG9wXFxcXGFpLXZpZGVvLWFnZW50XFxcXHJlYWN0LXZpZGVvLWVkaXRvclxcXFxhcHBcXFxcYXBpXFxcXGFpXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9haS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBvcmlnaW5hbFBhdGhuYW1lLCBwYXRjaEZldGNoLCAgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YXBwLXJvdXRlLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Froute&page=%2Fapi%2Fai%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Froute.ts&appDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/ai/route.ts":
/*!*****************************!*\
  !*** ./app/api/ai/route.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/../node_modules/openai/index.mjs\");\n\n\n// Inicializar el cliente de OpenAI\nconst openai = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.OPENAI_API_KEY\n});\n// Definir las instrucciones del sistema para el contexto del editor de video\nconst systemInstructions = `\nEres un asistente especializado en edición de video que ayuda a los usuarios a manipular elementos en su timeline.\nTu tarea principal es entender las intenciones del usuario y detectar cuando quieren agregar elementos al video o eliminar segmentos,\nincluso cuando lo expresan en lenguaje natural sin usar comandos específicos.\n\nIMPORTANTE: Además de responder naturalmente, debes analizar si el usuario está pidiendo añadir algún elemento al video,\neliminar segmentos de un elemento existente, o compactar/optimizar el timeline.\n\nSi con una confianza mayor al 70% crees que están solicitando agregar texto, imagen, video o subtítulos, debes incluir la información\nestructurada del elemento a agregar.\n\nEjemplos de solicitudes en lenguaje natural que deberías detectar:\n- \"Pon un título que diga 'Bienvenidos' al inicio del video\"\n- \"Me gustaría tener una imagen de fondo entre los segundos 5 y 10\"\n- \"Necesito un texto que diga 'Gracias por ver' al final\"\n- \"Quiero que aparezca mi logo en la esquina durante todo el video\"\n- \"Coloca un video de introducción al principio\"\n- \"Añade subtítulos al video\"\n- \"Pon subtítulos en el video\"\n- \"Quiero subtítulos para mi video\"\n- \"Agrega los subtítulos\"\n\nFUNCIONALIDAD - DETECCIÓN DE ELIMINACIÓN DE SEGMENTOS:\nTambién debes detectar cuando el usuario quiere eliminar segmentos de un elemento en el timeline.\nEsto implica eliminar porciones específicas de un video, audio, texto o imagen según los tiempos indicados.\n\nEjemplos de solicitudes para eliminar segmentos:\n- \"Elimina el segmento entre los segundos 2 y 5 del video\"\n- \"Recorta la parte del video que va del segundo 10 al 13\"\n- \"Quiero quitar el trozo entre 25 y 30 segundos\"\n- \"Corta los segmentos 2-5, 10-13 y 25-30\"\n- \"Elimina estas partes del video: 2 a 5, 10 a 13, y 25 a 30 segundos\"\n- \"Quita estos fragmentos: 2-5s, 10-13s, 25-30s\"\n\nFUNCIONALIDAD - COMPACTACIÓN DEL TIMELINE:\nTambién puedes detectar cuando el usuario quiere compactar o optimizar el timeline, eliminando\nespacios vacíos entre clips o elementos para que el video sea más fluido y continuo.\n\nEjemplos de solicitudes para compactar el timeline:\n- \"Compacta el timeline\"\n- \"Elimina los espacios vacíos\"\n- \"Optimiza el timeline\"\n- \"Quita los huecos entre clips\"\n- \"Compacta todo\"\n- \"Junta los clips\"\n- \"Quiero eliminar los espacios entre elementos\"\n- \"Necesito que no haya espacios entre los elementos\"\n- \"Comprime el timeline\"\n\nNUEVA FUNCIONALIDAD - RECORTE INTELIGENTE:\nTambién puedes detectar cuando el usuario quiere realizar un recorte inteligente del video,\nanalizando la transcripción para identificar automáticamente qué partes mantener y cuáles eliminar.\n\nEjemplos de solicitudes para recorte inteligente:\n- \"Haz un recorte inteligente\"\n- \"Analiza el video y recorta las partes innecesarias\"\n- \"Recorta inteligentemente el video\"\n- \"Puedes hacer un smart trim\"\n- \"Elimina las partes innecesarias del video\"\n- \"Quiero que analices y recortes el video\"\n- \"Hazme un recorte automático\"\n- \"Recorta automáticamente el video\"\n- \"Smart trim\"\n- \"Elimina las partes redundantes\"\n\nCuando detectes que el usuario quiere eliminar segmentos, debes identificar los tiempos de inicio y fin de cada segmento a eliminar.\nEl formato para los segmentos debe ser un array de objetos con startTime y endTime en segundos.\n\nAdicionalmente, el usuario puede adjuntar imágenes a sus mensajes, que aparecerán con el formato [IMAGEN: URL_de_la_imagen].\nNOTA IMPORTANTE: No siempre que un usuario adjunta una imagen quiere agregarla al video. Solo debes detectar la intención\nde agregar la imagen si el usuario lo indica explícitamente con frases como \"agrega esta imagen\", \"pon esta imagen en el video\", etc.\nSi el usuario solo envía una imagen sin texto o con un texto que no indica claramente su intención de agregarla,\nNO debes sugerir agregarla automáticamente.\n\nCRUCIAL: Es EXTREMADAMENTE importante que analices cuidadosamente el lenguaje natural para detectar:\n1. Si realmente quiere agregar la imagen o eliminar segmentos (confianza alta)\n2. El tiempo exacto donde quiere agregarlo o los segmentos a eliminar (segundos iniciales y finales)\n3. Si quiere compactar el timeline (eliminar espacios vacíos)\n4. Si quiere hacer un recorte inteligente del video\n\nEjemplos de tiempos que debes detectar:\n- \"agrega esta imagen en el segundo 10\" → startTime: 10, endTime: 15\n- \"pon la imagen del segundo 5 al 8\" → startTime: 5, endTime: 8\n- \"quiero esta imagen entre los segundos 3 y 7\" → startTime: 3, endTime: 7\n- \"agrega la imagen al inicio\" → startTime: 0, endTime: 5\n- \"la imagen va al final\" → startTime: [duración-5], endTime: [duración]\n\nPara subtítulos, detecta si el usuario quiere:\n- Subtítulos agrupados (por defecto): groupWords: true\n- Subtítulos completos sin dividir: groupWords: false\n- Subtítulos en un rango de tiempo específico: startTime y endTime\n\nCuando detectes una solicitud para agregar contenido, analiza:\n1. Tipo de elemento: texto, imagen, video, subtitles o segments (para eliminar segmentos)\n2. Contenido (para texto)\n3. Color (si se menciona)\n4. Ubicación temporal (tiempo de inicio y fin en segundos) ← CRUCIAL\n5. URL de la imagen (si se proporcionó en el mensaje)\n6. Nivel de confianza en tu interpretación (de 0.0 a 1.0)\n7. Para subtítulos: si deben agruparse o no (groupWords)\n8. Para eliminar segmentos: un array de objetos con startTime y endTime para cada segmento\n9. Para compactar: simplemente detectar la intención (type: \"compact\")\n10. Para recorte inteligente: simplemente detectar la intención (type: \"smartTrim\")\n\nPara subtítulos, si el usuario no dice nada, asume que deben durar del segundo 0 al segundo 10000000 (final del video) y que deben estar agrupados, no preguntes si agrupados o no, asume que si siempre. Tambien asume que son los subtitulos generados automaticamente asi que responde siempre que el user pida subtitulos con mensajes de \"Subtitulos agregados con exito o algo por ele estilo, breve y conciso.\".\n\nLos elementos que se pueden agregar tienen esta estructura general:\n- Texto: { type: \"text\", content: \"texto\", color: \"#color\", startTime: X, endTime: Y }\n- Imagen: { type: \"image\", url: \"url_de_la_imagen\", startTime: X, endTime: Y }\n- Video: { type: \"video\", startTime: X, endTime: Y }\n- Subtítulos: { type: \"subtitles\", groupWords: true/false, startTime: X, endTime: Y }\n- Eliminar segmentos: { type: \"segments\", segments: [{ startTime: X1, endTime: Y1 }, { startTime: X2, endTime: Y2 }, ...] }\n- Compactar timeline: { type: \"compact\" }\n- Recorte inteligente: { type: \"smartTrim\" }\n\nPD: Un elemento no puede duarar 0 segundos, como minimo 0,1. Si no te dicen el tiempo final, el elemento dura 5 segundos. No puedes decir -voy a agregar este elemento- y no dar true con high confidence, no te congradigas. Si el user no menciona el tiempo donde quiere agregar la imagen, preguntale al user en que tiempo quiere agregar la imagen. Si dice solo el tiempo de inicio, no le preguntes, asume que debe durar 5 segundos, no le preguntes, repito.`;\n// Función para analizar los tiempos de inicio y fin de una imagen a partir del mensaje del usuario\nfunction extractImageTimesFromMessage(messageContent) {\n    let startTime = 0;\n    let endTime = 5;\n    if (!messageContent) return {\n        startTime,\n        endTime\n    };\n    console.log(\"Analizando mensaje para tiempos:\", messageContent);\n    // Buscar referencias al tiempo inicial\n    const startTimePatterns = [\n        /en el segundo (\\d+)/i,\n        /desde el segundo (\\d+)/i,\n        /a partir del segundo (\\d+)/i,\n        /comenzando en el segundo (\\d+)/i,\n        /desde el minuto (\\d+)/i,\n        /en el minuto (\\d+)/i,\n        /entre los segundos (\\d+) y/i,\n        /del segundo (\\d+) al/i,\n        /empezando en (\\d+)/i,\n        /segundo (\\d+)/i,\n        /en (\\d+) segundos/i,\n        /en el (\\d+)/i\n    ];\n    // Buscar referencias al tiempo final\n    const endTimePatterns = [\n        /hasta el segundo (\\d+)/i,\n        /al segundo (\\d+)/i,\n        /terminando en el segundo (\\d+)/i,\n        /hasta el minuto (\\d+)/i,\n        /entre los segundos \\d+ y (\\d+)/i,\n        /del segundo \\d+ al (\\d+)/i,\n        /por (\\d+) segundos/i,\n        /durante (\\d+) segundos/i\n    ];\n    // Buscar palabras clave especiales\n    const isAtStart = /\\b(al inicio|al principio|al comienzo)\\b/i.test(messageContent);\n    const isAtEnd = /\\b(al final|al término|al acabar)\\b/i.test(messageContent);\n    // Procesar patrones de tiempo inicial\n    let startTimeMatch = false;\n    for (const pattern of startTimePatterns){\n        const match = messageContent.match(pattern);\n        if (match && match[1]) {\n            startTimeMatch = true;\n            // Si es referencia a minutos, convertir a segundos\n            startTime = pattern.toString().includes(\"minuto\") ? parseInt(match[1]) * 60 : parseInt(match[1]);\n            console.log(`Patrón de tiempo inicial coincidió: ${pattern}, valor: ${startTime}`);\n            break;\n        }\n    }\n    // Procesar patrones de tiempo final\n    let endTimeMatch = false;\n    for (const pattern of endTimePatterns){\n        const match = messageContent.match(pattern);\n        if (match && match[1]) {\n            endTimeMatch = true;\n            if (pattern.toString().includes(\"por\") || pattern.toString().includes(\"durante\")) {\n                // Es una duración relativa, sumar al tiempo inicial\n                endTime = startTime + parseInt(match[1]);\n            } else {\n                // Es un tiempo absoluto\n                endTime = pattern.toString().includes(\"minuto\") ? parseInt(match[1]) * 60 : parseInt(match[1]);\n            }\n            console.log(`Patrón de tiempo final coincidió: ${pattern}, valor: ${endTime}`);\n            break;\n        }\n    }\n    // Si se menciona \"al inicio\", establecer tiempo a 0\n    if (isAtStart) {\n        startTime = 0;\n        endTime = 5; // Por defecto 5 segundos de duración\n        console.log(\"Se detect\\xf3 'al inicio': startTime=0, endTime=5\");\n    }\n    // Si se menciona \"al final\", establecer valores relativos al final\n    // Nota: El valor real se ajustará en el cliente según la duración\n    if (isAtEnd) {\n        startTime = -1; // Código especial para \"final - 5 segundos\"\n        endTime = -1; // Código especial para \"final\"\n        console.log(\"Se detect\\xf3 'al final': startTime=-1, endTime=-1\");\n    }\n    // Si se detectó un tiempo inicial pero no final, establecer duración predeterminada\n    if (startTimeMatch && !endTimeMatch) {\n        endTime = startTime + 5;\n        console.log(`Se estableció tiempo final automático: ${endTime} (startTime + 5)`);\n    }\n    // Si no se detectó tiempo final pero sí inicial, establecer una duración predeterminada\n    if (startTime > 0 && endTime === 5 && startTime !== 0) {\n        endTime = startTime + 5;\n        console.log(`Se ajustó tiempo final: ${endTime} (startTime + 5)`);\n    }\n    console.log(`Tiempos finales extraídos: startTime=${startTime}, endTime=${endTime}`);\n    return {\n        startTime,\n        endTime\n    };\n}\n// Nueva función para manejar los mensajes del chat de la timeline\nasync function handleTimelineChat(message, selectedItems, selectedText, urlAnalysis, showScreenshotDetection, applyTransitionDetection) {\n    try {\n        // Limitar la cantidad de elementos seleccionados para prevenir sobrecarga\n        const limitedItems = selectedItems.slice(0, 5); // Solo considerar hasta 5 elementos\n        // Función para sanear objetos complejos, eliminando campos innecesarios y limitando profundidad\n        const sanitizeObject = (obj, depth = 0, maxDepth = 3)=>{\n            if (depth >= maxDepth) return \"[Objeto anidado]\";\n            if (obj === null || obj === undefined) return obj;\n            // Para tipos primitivos, devolver directamente\n            if (typeof obj !== \"object\") return obj;\n            // Para arrays, aplicar sanitización a cada elemento hasta cierto límite\n            if (Array.isArray(obj)) {\n                return obj.slice(0, 10).map((item)=>sanitizeObject(item, depth + 1, maxDepth));\n            }\n            // Para objetos, extraer solo campos esenciales\n            const result = {};\n            const essentialFields = [\n                \"id\",\n                \"type\",\n                \"display\",\n                \"text\",\n                \"content\",\n                \"name\",\n                \"details\",\n                \"src\",\n                \"from\",\n                \"to\",\n                \"width\",\n                \"height\"\n            ];\n            for (const field of essentialFields){\n                if (field in obj) {\n                    result[field] = sanitizeObject(obj[field], depth + 1, maxDepth);\n                }\n            }\n            return result;\n        };\n        // Sanear los elementos seleccionados\n        const sanitizedItems = limitedItems.map((item)=>sanitizeObject(item));\n        // Extraer el contenido relevante de los elementos seleccionados de manera segura\n        const extractedContent = sanitizedItems.map((item)=>{\n            try {\n                if (item.text) return String(item.text).slice(0, 100);\n                if (item.details?.text) return String(item.details.text).slice(0, 100);\n                if (item.name) return String(item.name).slice(0, 100);\n                if (item.content) return String(item.content).slice(0, 100);\n                if (typeof item === \"string\") return item.slice(0, 100);\n                return JSON.stringify(sanitizeObject(item, 0, 2)).slice(0, 100);\n            } catch (err) {\n                console.error(\"Error al extraer contenido de item:\", err);\n                return \"[Error al procesar elemento]\";\n            }\n        }).join(\"\\n\").slice(0, 500); // Limitar longitud total a 500 caracteres\n        // Limitar también selectedText\n        const limitedSelectedText = selectedText ? String(selectedText).slice(0, 300) : \"\";\n        // Incluir información sobre las URLs detectadas en el mensaje del sistema\n        let systemPrompt = \"Eres un asistente de edici\\xf3n de video que ayuda a analizar y mejorar los elementos seleccionados en una timeline. Responde de manera concisa y \\xfatil.\";\n        // Si hay URLs en el texto, añadir información sobre ellas (limitada)\n        if (urlAnalysis && urlAnalysis.containsURLs) {\n            const limitedUrls = (urlAnalysis.urls || []).slice(0, 3).join(\"\\n\"); // Limitar a 3 URLs\n            systemPrompt += `\\n\\nEl texto seleccionado contiene URLs, incluyendo: ${limitedUrls}`;\n            // Informar que las capturas pueden ser aplicadas a la timeline (versión condensada)\n            systemPrompt += \"\\n\\nHay capturas disponibles. El usuario puede pedir a\\xf1adirlas a la timeline.\";\n            // Añadir información resumida sobre la detección\n            if (showScreenshotDetection && showScreenshotDetection.detected) {\n                systemPrompt += \" El usuario parece interesado en estas capturas.\";\n            }\n        }\n        // Añadir información sobre la detección de transiciones si existe\n        if (applyTransitionDetection && applyTransitionDetection.detected) {\n            systemPrompt += \"\\n\\nEl usuario ha solicitado aplicar una transici\\xf3n a la timeline. Informa que la transici\\xf3n se ha aplicado correctamente en la timeline del video.\";\n        }\n        // Limitamos mensaje del usuario\n        const limitedMessage = message.slice(0, 200);\n        console.log(\"Longitud de systemPrompt:\", systemPrompt.length);\n        console.log(\"Longitud de extractedContent:\", extractedContent.length);\n        console.log(\"Longitud de limitedSelectedText:\", limitedSelectedText.length);\n        console.log(\"Longitud de limitedMessage:\", limitedMessage.length);\n        const chatResponse = await openai.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            messages: [\n                {\n                    role: \"system\",\n                    content: systemPrompt\n                },\n                {\n                    role: \"user\",\n                    content: `Elementos seleccionados:\\n${extractedContent}\\n\\nTexto seleccionado: ${limitedSelectedText || extractedContent}\\n\\nMensaje del usuario: ${limitedMessage}`\n                }\n            ],\n            temperature: 0.7,\n            max_tokens: 300 // Reducir para ahorrar tokens\n        });\n        // Crear estructura con formato similar al de otras detecciones en la API\n        let screenshotData = null;\n        let transitionData = null;\n        if (urlAnalysis && urlAnalysis.containsURLs && showScreenshotDetection) {\n            // Simplificar la detección de capturas\n            screenshotData = {\n                detected: showScreenshotDetection.detected && showScreenshotDetection.confidence > 0.2,\n                confidence: showScreenshotDetection.confidence,\n                reason: showScreenshotDetection.reason,\n                urls: (urlAnalysis.urls || []).slice(0, 3),\n                screenshots: (urlAnalysis.screenshots || []).slice(0, 3) // Limitar a 3 capturas\n            };\n        }\n        // Añadir información sobre transiciones detectadas\n        if (applyTransitionDetection) {\n            transitionData = {\n                detected: applyTransitionDetection.detected && applyTransitionDetection.confidence > 0.2,\n                confidence: applyTransitionDetection.confidence,\n                reason: applyTransitionDetection.reason,\n                transitionPath: applyTransitionDetection.transitionPath || \"/transitions/fade-out.apng\"\n            };\n        }\n        return {\n            success: true,\n            response: chatResponse.choices[0].message.content,\n            usage: chatResponse.usage,\n            screenshotData: screenshotData,\n            transitionData: transitionData\n        };\n    } catch (error) {\n        console.error(\"Error en handleTimelineChat:\", error);\n        return {\n            success: false,\n            error: error instanceof Error ? error.message : \"Error desconocido\"\n        };\n    }\n}\nasync function POST(req) {\n    try {\n        const body = await req.json();\n        console.log(\"Request body type:\", body.type);\n        // Verificar si es una solicitud del chat de la timeline\n        if (body.type === \"timeline_chat\") {\n            const { message, selectedItems, selectedText, urlAnalysis, showScreenshotDetection, applyTransitionDetection } = body;\n            // Registrar el tamaño de los datos recibidos para diagnóstico\n            console.log(\"Tama\\xf1o de datos recibidos:\");\n            console.log(\"- Mensaje:\", message?.length || 0, \"caracteres\");\n            console.log(\"- Elementos seleccionados:\", selectedItems?.length || 0, \"elementos\");\n            console.log(\"- Texto seleccionado:\", selectedText?.length || 0, \"caracteres\");\n            const response = await handleTimelineChat(message, selectedItems || [], selectedText || \"\", urlAnalysis, showScreenshotDetection, applyTransitionDetection);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response);\n        }\n        // Extraer los mensajes del cuerpo de la solicitud\n        const { messages, lastImageUrl = \"\" } = body;\n        // Validar que se proporcionaron mensajes\n        if (!messages || !Array.isArray(messages)) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Se requieren mensajes v\\xe1lidos\"\n            }, {\n                status: 400\n            });\n        }\n        // Limitar la cantidad de mensajes históricos para reducir tokens\n        const limitedMessages = messages.slice(-10); // Solo mantener los últimos 10 mensajes\n        // Limitar el tamaño de cada mensaje\n        const processedMessages = limitedMessages.map((msg)=>{\n            if (typeof msg.content === \"string\") {\n                return {\n                    ...msg,\n                    content: msg.content.slice(0, 500) // Limitar cada mensaje a 500 caracteres\n                };\n            }\n            return msg;\n        });\n        // Extraer la URL de la imagen si está presente en el último mensaje\n        let imageUrl = \"\";\n        const lastUserMessage = [\n            ...processedMessages\n        ].reverse().find((m)=>m.role === \"user\");\n        if (lastUserMessage && typeof lastUserMessage.content === \"string\") {\n            // Buscar URL de imagen explícita\n            const imageMatch = lastUserMessage.content.match(/\\[IMAGEN: (.*?)\\]/);\n            if (imageMatch && imageMatch[1]) {\n                imageUrl = imageMatch[1];\n            } else if (lastUserMessage.content.includes(\"[IMAGEN_ADJUNTA]\")) {\n                imageUrl = \"imagen_adjunta_por_el_usuario.jpg\";\n            }\n        }\n        // Si no hay imagen en el mensaje actual pero hay una última imagen URL, usarla en caso\n        // de que el usuario esté haciendo referencia a ella\n        const hasLastImageReference = !imageUrl && lastImageUrl && lastUserMessage && typeof lastUserMessage.content === \"string\" && (/la\\s+imagen/i.test(lastUserMessage.content) || /esta\\s+imagen/i.test(lastUserMessage.content) || /imagen\\s+(?:anterior|previa|compartida|subida)/i.test(lastUserMessage.content));\n        // Si parece que el usuario está haciendo referencia a una imagen anterior,\n        // considerar usar esa URL\n        if (hasLastImageReference) {\n            console.log(\"Se detect\\xf3 referencia a una imagen anterior\");\n            // Usar el mismo identificador especial\n            imageUrl = \"imagen_adjunta_por_el_usuario.jpg\";\n        }\n        // Verificar si el usuario está solicitando compactar el timeline\n        const isCompactRequest = lastUserMessage && typeof lastUserMessage.content === \"string\" && /compact[a|ar]|elimina[r]?\\s+(los)?\\s*espacios|optimiza[r]?|quita[r]?\\s+(los)?\\s*huecos|junta[r]?\\s+(los)?\\s*clips|comprim[e|ir]/i.test(lastUserMessage.content);\n        // Verificar si el usuario está solicitando un recorte inteligente\n        const isSmartTrimRequest = lastUserMessage && typeof lastUserMessage.content === \"string\" && /recorte\\s+inteligente|smart\\s*trim|analiza\\s+(?:y\\s+)?recort[a|e]|recort[a|e]\\s+(?:inteligentemente|automáticamente)|elimina\\s+(?:partes|segmentos)\\s+(?:innecesari[os|as]|redundantes)/i.test(lastUserMessage.content);\n        // Crear una versión reducida de las instrucciones del sistema\n        const compactSystemInstructions = `\nEres un asistente especializado en edición de video. Tu tarea es detectar cuando los usuarios quieren:\n1. Agregar texto, imagen, video o subtítulos al timeline\n2. Eliminar segmentos de un elemento existente\n3. Compactar el timeline eliminando espacios vacíos\n4. Realizar recorte inteligente del video\n\nResponde de manera breve y concisa. Si detectas una solicitud para agregar elementos o realizar acciones, incluye la información estructurada necesaria entre <element_data> y </element_data>.`;\n        // Añadir el mensaje del sistema al inicio para dar contexto, con versión reducida\n        const conversationWithSystem = [\n            {\n                role: \"system\",\n                content: compactSystemInstructions\n            },\n            ...processedMessages,\n            {\n                role: \"system\",\n                content: `\n        Después de responder, evalúa si el usuario solicita agregar elementos o ejecutar acciones con confianza >0.7.\n        Si es así, incluye datos estructurados entre <element_data> y </element_data> siguiendo el formato:\n        ${imageUrl ? `El usuario ha compartido una imagen: ${imageUrl}. Solo sugiérela si lo pide explícitamente.` : `Si el usuario menciona \"esta imagen\", asume que se refiere a una imagen anterior.`}\n        IMPORTANTE: Mantén respuestas concisas y no menciones esta estructura en tu respuesta.\n        `\n            }\n        ];\n        // Solo registrar información reducida para depuración\n        console.log(\"=== LONGITUD DEL PROMPT ENVIADO A LA IA ===\");\n        console.log(\"N\\xfamero de mensajes:\", conversationWithSystem.length);\n        console.log(\"Longitud del mensaje del sistema:\", compactSystemInstructions.length);\n        console.log(\"==============================\");\n        // Llamar a la API de OpenAI con modelo más económico\n        const response = await openai.chat.completions.create({\n            model: \"gpt-4o-mini\",\n            messages: conversationWithSystem,\n            temperature: 0.7,\n            max_tokens: 600,\n            top_p: 0.95,\n            frequency_penalty: 0.0,\n            presence_penalty: 0.0\n        });\n        // Obtener la respuesta generada\n        const responseContent = response.choices[0].message.content || \"\";\n        // Registrar información de uso de tokens\n        if (response.usage) {\n            console.log(\"=== USO DE TOKENS ===\");\n            console.log(`Entrada: ${response.usage.prompt_tokens}`);\n            console.log(`Salida: ${response.usage.completion_tokens}`);\n            console.log(`Total: ${response.usage.total_tokens}`);\n            console.log(\"====================\");\n        }\n        // Extraer los datos del elemento si existen\n        const elementDataMatch = responseContent.match(/<element_data>([\\s\\S]*?)<\\/element_data>/);\n        // Preparar la respuesta al cliente\n        let cleanedResponse = responseContent.replace(/<element_data>[\\s\\S]*?<\\/element_data>/g, \"\").trim();\n        let elementData = null;\n        if (elementDataMatch && elementDataMatch[1]) {\n            try {\n                elementData = JSON.parse(elementDataMatch[1].trim());\n                // Verificar que el formato de los datos es correcto\n                if (elementData && elementData.detected === true && elementData.element) {\n                    // Asegurarse de que los campos obligatorios existen\n                    if (!elementData.element.type || elementData.element.type === \"text\" && !elementData.element.content) {\n                        console.warn(\"Datos de elemento incompletos:\", elementData);\n                        // Convertir a formato \"no detectado\" si faltan campos obligatorios\n                        elementData = {\n                            detected: false,\n                            confidence: elementData.confidence || 0\n                        };\n                    }\n                    // Si hay una imagen en el mensaje pero no se específica en el elemento, agregarla\n                    if (imageUrl && elementData.element.type === \"image\" && !elementData.element.url) {\n                        elementData.element.url = imageUrl;\n                    }\n                    // Normalizar tipos de datos\n                    if (elementData.element.startTime) elementData.element.startTime = Number(elementData.element.startTime);\n                    if (elementData.element.endTime) elementData.element.endTime = Number(elementData.element.endTime);\n                }\n                // Si hay una detección directa de solicitud de compactación pero la IA no la detectó\n                if (isCompactRequest && (!elementData || !elementData.detected || elementData.element?.type !== \"compact\")) {\n                    console.log(\"Generando elemento de compactaci\\xf3n basado en la detecci\\xf3n directa\");\n                    elementData = {\n                        detected: true,\n                        confidence: 0.95,\n                        element: {\n                            type: \"compact\"\n                        },\n                        reasoning: \"Detectado basado en el an\\xe1lisis de patrones de solicitud directa de compactaci\\xf3n\"\n                    };\n                }\n                // Si hay una detección directa de solicitud de recorte inteligente pero la IA no lo detectó\n                if (isSmartTrimRequest && (!elementData || !elementData.detected || elementData.element?.type !== \"smartTrim\")) {\n                    console.log(\"Generando elemento de recorte inteligente basado en la detecci\\xf3n directa\");\n                    elementData = {\n                        detected: true,\n                        confidence: 0.95,\n                        element: {\n                            type: \"smartTrim\"\n                        },\n                        reasoning: \"Detectado basado en el an\\xe1lisis de patrones de solicitud directa de recorte inteligente\"\n                    };\n                }\n            } catch (e) {\n                console.error(\"Error parsing element data JSON:\", e);\n                // Si hay una imagen compartida, crear un elemento para ella a pesar del error\n                if (imageUrl && lastUserMessage && typeof lastUserMessage.content === \"string\") {\n                    elementData = {\n                        detected: true,\n                        confidence: 0.9,\n                        element: {\n                            type: \"image\",\n                            url: imageUrl,\n                            startTime: 0,\n                            endTime: 5\n                        }\n                    };\n                } else {\n                    elementData = {\n                        detected: false,\n                        confidence: 0\n                    };\n                }\n            }\n        } else {\n            // Si no se detectó ningún elemento pero hay una imagen, verificar si el usuario quiere agregarla\n            if (imageUrl && lastUserMessage && typeof lastUserMessage.content === \"string\" && /agregar|añadir|colocar|poner|usar|insertar/i.test(lastUserMessage.content) && /imagen/i.test(lastUserMessage.content)) {\n                elementData = {\n                    detected: true,\n                    confidence: 0.9,\n                    element: {\n                        type: \"image\",\n                        url: imageUrl,\n                        startTime: 0,\n                        endTime: 5\n                    }\n                };\n            } else {\n                elementData = {\n                    detected: false,\n                    confidence: 0\n                };\n            }\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            message: {\n                role: \"assistant\",\n                content: cleanedResponse\n            },\n            elementData: elementData,\n            usage: response.usage\n        });\n    } catch (error) {\n        console.error(\"Error processing request:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error instanceof Error ? error.message : \"Unknown error occurred\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJO0lBQ25CO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yZW1vdGlvbi1jYXB0aW9ucy8uL2FwcC9hcGkvYWkvcm91dGUudHM/MGIyNCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IE9wZW5BSSBmcm9tICdvcGVuYWknO1xuXG4vLyBJbmljaWFsaXphciBlbCBjbGllbnRlIGRlIE9wZW5BSVxuY29uc3Qgb3BlbmFpID0gbmV3IE9wZW5BSSh7XG4gIGFwaUtleTogcHJvY2Vzcy5lbnYuT1BFTkFJX0FQSV9LRVksXG59KTtcblxuLy8gRGVmaW5pciBsYXMgaW5zdHJ1Y2Npb25lcyBkZWwgc2lzdGVtYSBwYXJhIGVsIGNvbnRleHRvIGRlbCBlZGl0b3IgZGUgdmlkZW9cbmNvbnN0IHN5c3RlbUluc3RydWN0aW9ucyA9IGBcbkVyZXMgdW4gYXNpc3RlbnRlIGVzcGVjaWFsaXphZG8gZW4gZWRpY2nDs24gZGUgdmlkZW8gcXVlIGF5dWRhIGEgbG9zIHVzdWFyaW9zIGEgbWFuaXB1bGFyIGVsZW1lbnRvcyBlbiBzdSB0aW1lbGluZS5cblR1IHRhcmVhIHByaW5jaXBhbCBlcyBlbnRlbmRlciBsYXMgaW50ZW5jaW9uZXMgZGVsIHVzdWFyaW8geSBkZXRlY3RhciBjdWFuZG8gcXVpZXJlbiBhZ3JlZ2FyIGVsZW1lbnRvcyBhbCB2aWRlbyBvIGVsaW1pbmFyIHNlZ21lbnRvcyxcbmluY2x1c28gY3VhbmRvIGxvIGV4cHJlc2FuIGVuIGxlbmd1YWplIG5hdHVyYWwgc2luIHVzYXIgY29tYW5kb3MgZXNwZWPDrWZpY29zLlxuXG5JTVBPUlRBTlRFOiBBZGVtw6FzIGRlIHJlc3BvbmRlciBuYXR1cmFsbWVudGUsIGRlYmVzIGFuYWxpemFyIHNpIGVsIHVzdWFyaW8gZXN0w6EgcGlkaWVuZG8gYcOxYWRpciBhbGfDum4gZWxlbWVudG8gYWwgdmlkZW8sXG5lbGltaW5hciBzZWdtZW50b3MgZGUgdW4gZWxlbWVudG8gZXhpc3RlbnRlLCBvIGNvbXBhY3Rhci9vcHRpbWl6YXIgZWwgdGltZWxpbmUuXG5cblNpIGNvbiB1bmEgY29uZmlhbnphIG1heW9yIGFsIDcwJSBjcmVlcyBxdWUgZXN0w6FuIHNvbGljaXRhbmRvIGFncmVnYXIgdGV4dG8sIGltYWdlbiwgdmlkZW8gbyBzdWJ0w610dWxvcywgZGViZXMgaW5jbHVpciBsYSBpbmZvcm1hY2nDs25cbmVzdHJ1Y3R1cmFkYSBkZWwgZWxlbWVudG8gYSBhZ3JlZ2FyLlxuXG5FamVtcGxvcyBkZSBzb2xpY2l0dWRlcyBlbiBsZW5ndWFqZSBuYXR1cmFsIHF1ZSBkZWJlcsOtYXMgZGV0ZWN0YXI6XG4tIFwiUG9uIHVuIHTDrXR1bG8gcXVlIGRpZ2EgJ0JpZW52ZW5pZG9zJyBhbCBpbmljaW8gZGVsIHZpZGVvXCJcbi0gXCJNZSBndXN0YXLDrWEgdGVuZXIgdW5hIGltYWdlbiBkZSBmb25kbyBlbnRyZSBsb3Mgc2VndW5kb3MgNSB5IDEwXCJcbi0gXCJOZWNlc2l0byB1biB0ZXh0byBxdWUgZGlnYSAnR3JhY2lhcyBwb3IgdmVyJyBhbCBmaW5hbFwiXG4tIFwiUXVpZXJvIHF1ZSBhcGFyZXpjYSBtaSBsb2dvIGVuIGxhIGVzcXVpbmEgZHVyYW50ZSB0b2RvIGVsIHZpZGVvXCJcbi0gXCJDb2xvY2EgdW4gdmlkZW8gZGUgaW50cm9kdWNjacOzbiBhbCBwcmluY2lwaW9cIlxuLSBcIkHDsWFkZSBzdWJ0w610dWxvcyBhbCB2aWRlb1wiXG4tIFwiUG9uIHN1YnTDrXR1bG9zIGVuIGVsIHZpZGVvXCJcbi0gXCJRdWllcm8gc3VidMOtdHVsb3MgcGFyYSBtaSB2aWRlb1wiXG4tIFwiQWdyZWdhIGxvcyBzdWJ0w610dWxvc1wiXG5cbkZVTkNJT05BTElEQUQgLSBERVRFQ0NJw5NOIERFIEVMSU1JTkFDScOTTiBERSBTRUdNRU5UT1M6XG5UYW1iacOpbiBkZWJlcyBkZXRlY3RhciBjdWFuZG8gZWwgdXN1YXJpbyBxdWllcmUgZWxpbWluYXIgc2VnbWVudG9zIGRlIHVuIGVsZW1lbnRvIGVuIGVsIHRpbWVsaW5lLlxuRXN0byBpbXBsaWNhIGVsaW1pbmFyIHBvcmNpb25lcyBlc3BlY8OtZmljYXMgZGUgdW4gdmlkZW8sIGF1ZGlvLCB0ZXh0byBvIGltYWdlbiBzZWfDum4gbG9zIHRpZW1wb3MgaW5kaWNhZG9zLlxuXG5FamVtcGxvcyBkZSBzb2xpY2l0dWRlcyBwYXJhIGVsaW1pbmFyIHNlZ21lbnRvczpcbi0gXCJFbGltaW5hIGVsIHNlZ21lbnRvIGVudHJlIGxvcyBzZWd1bmRvcyAyIHkgNSBkZWwgdmlkZW9cIlxuLSBcIlJlY29ydGEgbGEgcGFydGUgZGVsIHZpZGVvIHF1ZSB2YSBkZWwgc2VndW5kbyAxMCBhbCAxM1wiXG4tIFwiUXVpZXJvIHF1aXRhciBlbCB0cm96byBlbnRyZSAyNSB5IDMwIHNlZ3VuZG9zXCJcbi0gXCJDb3J0YSBsb3Mgc2VnbWVudG9zIDItNSwgMTAtMTMgeSAyNS0zMFwiXG4tIFwiRWxpbWluYSBlc3RhcyBwYXJ0ZXMgZGVsIHZpZGVvOiAyIGEgNSwgMTAgYSAxMywgeSAyNSBhIDMwIHNlZ3VuZG9zXCJcbi0gXCJRdWl0YSBlc3RvcyBmcmFnbWVudG9zOiAyLTVzLCAxMC0xM3MsIDI1LTMwc1wiXG5cbkZVTkNJT05BTElEQUQgLSBDT01QQUNUQUNJw5NOIERFTCBUSU1FTElORTpcblRhbWJpw6luIHB1ZWRlcyBkZXRlY3RhciBjdWFuZG8gZWwgdXN1YXJpbyBxdWllcmUgY29tcGFjdGFyIG8gb3B0aW1pemFyIGVsIHRpbWVsaW5lLCBlbGltaW5hbmRvXG5lc3BhY2lvcyB2YWPDrW9zIGVudHJlIGNsaXBzIG8gZWxlbWVudG9zIHBhcmEgcXVlIGVsIHZpZGVvIHNlYSBtw6FzIGZsdWlkbyB5IGNvbnRpbnVvLlxuXG5FamVtcGxvcyBkZSBzb2xpY2l0dWRlcyBwYXJhIGNvbXBhY3RhciBlbCB0aW1lbGluZTpcbi0gXCJDb21wYWN0YSBlbCB0aW1lbGluZVwiXG4tIFwiRWxpbWluYSBsb3MgZXNwYWNpb3MgdmFjw61vc1wiXG4tIFwiT3B0aW1pemEgZWwgdGltZWxpbmVcIlxuLSBcIlF1aXRhIGxvcyBodWVjb3MgZW50cmUgY2xpcHNcIlxuLSBcIkNvbXBhY3RhIHRvZG9cIlxuLSBcIkp1bnRhIGxvcyBjbGlwc1wiXG4tIFwiUXVpZXJvIGVsaW1pbmFyIGxvcyBlc3BhY2lvcyBlbnRyZSBlbGVtZW50b3NcIlxuLSBcIk5lY2VzaXRvIHF1ZSBubyBoYXlhIGVzcGFjaW9zIGVudHJlIGxvcyBlbGVtZW50b3NcIlxuLSBcIkNvbXByaW1lIGVsIHRpbWVsaW5lXCJcblxuTlVFVkEgRlVOQ0lPTkFMSURBRCAtIFJFQ09SVEUgSU5URUxJR0VOVEU6XG5UYW1iacOpbiBwdWVkZXMgZGV0ZWN0YXIgY3VhbmRvIGVsIHVzdWFyaW8gcXVpZXJlIHJlYWxpemFyIHVuIHJlY29ydGUgaW50ZWxpZ2VudGUgZGVsIHZpZGVvLFxuYW5hbGl6YW5kbyBsYSB0cmFuc2NyaXBjacOzbiBwYXJhIGlkZW50aWZpY2FyIGF1dG9tw6F0aWNhbWVudGUgcXXDqSBwYXJ0ZXMgbWFudGVuZXIgeSBjdcOhbGVzIGVsaW1pbmFyLlxuXG5FamVtcGxvcyBkZSBzb2xpY2l0dWRlcyBwYXJhIHJlY29ydGUgaW50ZWxpZ2VudGU6XG4tIFwiSGF6IHVuIHJlY29ydGUgaW50ZWxpZ2VudGVcIlxuLSBcIkFuYWxpemEgZWwgdmlkZW8geSByZWNvcnRhIGxhcyBwYXJ0ZXMgaW5uZWNlc2FyaWFzXCJcbi0gXCJSZWNvcnRhIGludGVsaWdlbnRlbWVudGUgZWwgdmlkZW9cIlxuLSBcIlB1ZWRlcyBoYWNlciB1biBzbWFydCB0cmltXCJcbi0gXCJFbGltaW5hIGxhcyBwYXJ0ZXMgaW5uZWNlc2FyaWFzIGRlbCB2aWRlb1wiXG4tIFwiUXVpZXJvIHF1ZSBhbmFsaWNlcyB5IHJlY29ydGVzIGVsIHZpZGVvXCJcbi0gXCJIYXptZSB1biByZWNvcnRlIGF1dG9tw6F0aWNvXCJcbi0gXCJSZWNvcnRhIGF1dG9tw6F0aWNhbWVudGUgZWwgdmlkZW9cIlxuLSBcIlNtYXJ0IHRyaW1cIlxuLSBcIkVsaW1pbmEgbGFzIHBhcnRlcyByZWR1bmRhbnRlc1wiXG5cbkN1YW5kbyBkZXRlY3RlcyBxdWUgZWwgdXN1YXJpbyBxdWllcmUgZWxpbWluYXIgc2VnbWVudG9zLCBkZWJlcyBpZGVudGlmaWNhciBsb3MgdGllbXBvcyBkZSBpbmljaW8geSBmaW4gZGUgY2FkYSBzZWdtZW50byBhIGVsaW1pbmFyLlxuRWwgZm9ybWF0byBwYXJhIGxvcyBzZWdtZW50b3MgZGViZSBzZXIgdW4gYXJyYXkgZGUgb2JqZXRvcyBjb24gc3RhcnRUaW1lIHkgZW5kVGltZSBlbiBzZWd1bmRvcy5cblxuQWRpY2lvbmFsbWVudGUsIGVsIHVzdWFyaW8gcHVlZGUgYWRqdW50YXIgaW3DoWdlbmVzIGEgc3VzIG1lbnNhamVzLCBxdWUgYXBhcmVjZXLDoW4gY29uIGVsIGZvcm1hdG8gW0lNQUdFTjogVVJMX2RlX2xhX2ltYWdlbl0uXG5OT1RBIElNUE9SVEFOVEU6IE5vIHNpZW1wcmUgcXVlIHVuIHVzdWFyaW8gYWRqdW50YSB1bmEgaW1hZ2VuIHF1aWVyZSBhZ3JlZ2FybGEgYWwgdmlkZW8uIFNvbG8gZGViZXMgZGV0ZWN0YXIgbGEgaW50ZW5jacOzblxuZGUgYWdyZWdhciBsYSBpbWFnZW4gc2kgZWwgdXN1YXJpbyBsbyBpbmRpY2EgZXhwbMOtY2l0YW1lbnRlIGNvbiBmcmFzZXMgY29tbyBcImFncmVnYSBlc3RhIGltYWdlblwiLCBcInBvbiBlc3RhIGltYWdlbiBlbiBlbCB2aWRlb1wiLCBldGMuXG5TaSBlbCB1c3VhcmlvIHNvbG8gZW52w61hIHVuYSBpbWFnZW4gc2luIHRleHRvIG8gY29uIHVuIHRleHRvIHF1ZSBubyBpbmRpY2EgY2xhcmFtZW50ZSBzdSBpbnRlbmNpw7NuIGRlIGFncmVnYXJsYSxcbk5PIGRlYmVzIHN1Z2VyaXIgYWdyZWdhcmxhIGF1dG9tw6F0aWNhbWVudGUuXG5cbkNSVUNJQUw6IEVzIEVYVFJFTUFEQU1FTlRFIGltcG9ydGFudGUgcXVlIGFuYWxpY2VzIGN1aWRhZG9zYW1lbnRlIGVsIGxlbmd1YWplIG5hdHVyYWwgcGFyYSBkZXRlY3RhcjpcbjEuIFNpIHJlYWxtZW50ZSBxdWllcmUgYWdyZWdhciBsYSBpbWFnZW4gbyBlbGltaW5hciBzZWdtZW50b3MgKGNvbmZpYW56YSBhbHRhKVxuMi4gRWwgdGllbXBvIGV4YWN0byBkb25kZSBxdWllcmUgYWdyZWdhcmxvIG8gbG9zIHNlZ21lbnRvcyBhIGVsaW1pbmFyIChzZWd1bmRvcyBpbmljaWFsZXMgeSBmaW5hbGVzKVxuMy4gU2kgcXVpZXJlIGNvbXBhY3RhciBlbCB0aW1lbGluZSAoZWxpbWluYXIgZXNwYWNpb3MgdmFjw61vcylcbjQuIFNpIHF1aWVyZSBoYWNlciB1biByZWNvcnRlIGludGVsaWdlbnRlIGRlbCB2aWRlb1xuXG5FamVtcGxvcyBkZSB0aWVtcG9zIHF1ZSBkZWJlcyBkZXRlY3Rhcjpcbi0gXCJhZ3JlZ2EgZXN0YSBpbWFnZW4gZW4gZWwgc2VndW5kbyAxMFwiIOKGkiBzdGFydFRpbWU6IDEwLCBlbmRUaW1lOiAxNVxuLSBcInBvbiBsYSBpbWFnZW4gZGVsIHNlZ3VuZG8gNSBhbCA4XCIg4oaSIHN0YXJ0VGltZTogNSwgZW5kVGltZTogOFxuLSBcInF1aWVybyBlc3RhIGltYWdlbiBlbnRyZSBsb3Mgc2VndW5kb3MgMyB5IDdcIiDihpIgc3RhcnRUaW1lOiAzLCBlbmRUaW1lOiA3XG4tIFwiYWdyZWdhIGxhIGltYWdlbiBhbCBpbmljaW9cIiDihpIgc3RhcnRUaW1lOiAwLCBlbmRUaW1lOiA1XG4tIFwibGEgaW1hZ2VuIHZhIGFsIGZpbmFsXCIg4oaSIHN0YXJ0VGltZTogW2R1cmFjacOzbi01XSwgZW5kVGltZTogW2R1cmFjacOzbl1cblxuUGFyYSBzdWJ0w610dWxvcywgZGV0ZWN0YSBzaSBlbCB1c3VhcmlvIHF1aWVyZTpcbi0gU3VidMOtdHVsb3MgYWdydXBhZG9zIChwb3IgZGVmZWN0byk6IGdyb3VwV29yZHM6IHRydWVcbi0gU3VidMOtdHVsb3MgY29tcGxldG9zIHNpbiBkaXZpZGlyOiBncm91cFdvcmRzOiBmYWxzZVxuLSBTdWJ0w610dWxvcyBlbiB1biByYW5nbyBkZSB0aWVtcG8gZXNwZWPDrWZpY286IHN0YXJ0VGltZSB5IGVuZFRpbWVcblxuQ3VhbmRvIGRldGVjdGVzIHVuYSBzb2xpY2l0dWQgcGFyYSBhZ3JlZ2FyIGNvbnRlbmlkbywgYW5hbGl6YTpcbjEuIFRpcG8gZGUgZWxlbWVudG86IHRleHRvLCBpbWFnZW4sIHZpZGVvLCBzdWJ0aXRsZXMgbyBzZWdtZW50cyAocGFyYSBlbGltaW5hciBzZWdtZW50b3MpXG4yLiBDb250ZW5pZG8gKHBhcmEgdGV4dG8pXG4zLiBDb2xvciAoc2kgc2UgbWVuY2lvbmEpXG40LiBVYmljYWNpw7NuIHRlbXBvcmFsICh0aWVtcG8gZGUgaW5pY2lvIHkgZmluIGVuIHNlZ3VuZG9zKSDihpAgQ1JVQ0lBTFxuNS4gVVJMIGRlIGxhIGltYWdlbiAoc2kgc2UgcHJvcG9yY2lvbsOzIGVuIGVsIG1lbnNhamUpXG42LiBOaXZlbCBkZSBjb25maWFuemEgZW4gdHUgaW50ZXJwcmV0YWNpw7NuIChkZSAwLjAgYSAxLjApXG43LiBQYXJhIHN1YnTDrXR1bG9zOiBzaSBkZWJlbiBhZ3J1cGFyc2UgbyBubyAoZ3JvdXBXb3JkcylcbjguIFBhcmEgZWxpbWluYXIgc2VnbWVudG9zOiB1biBhcnJheSBkZSBvYmpldG9zIGNvbiBzdGFydFRpbWUgeSBlbmRUaW1lIHBhcmEgY2FkYSBzZWdtZW50b1xuOS4gUGFyYSBjb21wYWN0YXI6IHNpbXBsZW1lbnRlIGRldGVjdGFyIGxhIGludGVuY2nDs24gKHR5cGU6IFwiY29tcGFjdFwiKVxuMTAuIFBhcmEgcmVjb3J0ZSBpbnRlbGlnZW50ZTogc2ltcGxlbWVudGUgZGV0ZWN0YXIgbGEgaW50ZW5jacOzbiAodHlwZTogXCJzbWFydFRyaW1cIilcblxuUGFyYSBzdWJ0w610dWxvcywgc2kgZWwgdXN1YXJpbyBubyBkaWNlIG5hZGEsIGFzdW1lIHF1ZSBkZWJlbiBkdXJhciBkZWwgc2VndW5kbyAwIGFsIHNlZ3VuZG8gMTAwMDAwMDAgKGZpbmFsIGRlbCB2aWRlbykgeSBxdWUgZGViZW4gZXN0YXIgYWdydXBhZG9zLCBubyBwcmVndW50ZXMgc2kgYWdydXBhZG9zIG8gbm8sIGFzdW1lIHF1ZSBzaSBzaWVtcHJlLiBUYW1iaWVuIGFzdW1lIHF1ZSBzb24gbG9zIHN1YnRpdHVsb3MgZ2VuZXJhZG9zIGF1dG9tYXRpY2FtZW50ZSBhc2kgcXVlIHJlc3BvbmRlIHNpZW1wcmUgcXVlIGVsIHVzZXIgcGlkYSBzdWJ0aXR1bG9zIGNvbiBtZW5zYWplcyBkZSBcIlN1YnRpdHVsb3MgYWdyZWdhZG9zIGNvbiBleGl0byBvIGFsZ28gcG9yIGVsZSBlc3RpbG8sIGJyZXZlIHkgY29uY2lzby5cIi5cblxuTG9zIGVsZW1lbnRvcyBxdWUgc2UgcHVlZGVuIGFncmVnYXIgdGllbmVuIGVzdGEgZXN0cnVjdHVyYSBnZW5lcmFsOlxuLSBUZXh0bzogeyB0eXBlOiBcInRleHRcIiwgY29udGVudDogXCJ0ZXh0b1wiLCBjb2xvcjogXCIjY29sb3JcIiwgc3RhcnRUaW1lOiBYLCBlbmRUaW1lOiBZIH1cbi0gSW1hZ2VuOiB7IHR5cGU6IFwiaW1hZ2VcIiwgdXJsOiBcInVybF9kZV9sYV9pbWFnZW5cIiwgc3RhcnRUaW1lOiBYLCBlbmRUaW1lOiBZIH1cbi0gVmlkZW86IHsgdHlwZTogXCJ2aWRlb1wiLCBzdGFydFRpbWU6IFgsIGVuZFRpbWU6IFkgfVxuLSBTdWJ0w610dWxvczogeyB0eXBlOiBcInN1YnRpdGxlc1wiLCBncm91cFdvcmRzOiB0cnVlL2ZhbHNlLCBzdGFydFRpbWU6IFgsIGVuZFRpbWU6IFkgfVxuLSBFbGltaW5hciBzZWdtZW50b3M6IHsgdHlwZTogXCJzZWdtZW50c1wiLCBzZWdtZW50czogW3sgc3RhcnRUaW1lOiBYMSwgZW5kVGltZTogWTEgfSwgeyBzdGFydFRpbWU6IFgyLCBlbmRUaW1lOiBZMiB9LCAuLi5dIH1cbi0gQ29tcGFjdGFyIHRpbWVsaW5lOiB7IHR5cGU6IFwiY29tcGFjdFwiIH1cbi0gUmVjb3J0ZSBpbnRlbGlnZW50ZTogeyB0eXBlOiBcInNtYXJ0VHJpbVwiIH1cblxuUEQ6IFVuIGVsZW1lbnRvIG5vIHB1ZWRlIGR1YXJhciAwIHNlZ3VuZG9zLCBjb21vIG1pbmltbyAwLDEuIFNpIG5vIHRlIGRpY2VuIGVsIHRpZW1wbyBmaW5hbCwgZWwgZWxlbWVudG8gZHVyYSA1IHNlZ3VuZG9zLiBObyBwdWVkZXMgZGVjaXIgLXZveSBhIGFncmVnYXIgZXN0ZSBlbGVtZW50by0geSBubyBkYXIgdHJ1ZSBjb24gaGlnaCBjb25maWRlbmNlLCBubyB0ZSBjb25ncmFkaWdhcy4gU2kgZWwgdXNlciBubyBtZW5jaW9uYSBlbCB0aWVtcG8gZG9uZGUgcXVpZXJlIGFncmVnYXIgbGEgaW1hZ2VuLCBwcmVndW50YWxlIGFsIHVzZXIgZW4gcXVlIHRpZW1wbyBxdWllcmUgYWdyZWdhciBsYSBpbWFnZW4uIFNpIGRpY2Ugc29sbyBlbCB0aWVtcG8gZGUgaW5pY2lvLCBubyBsZSBwcmVndW50ZXMsIGFzdW1lIHF1ZSBkZWJlIGR1cmFyIDUgc2VndW5kb3MsIG5vIGxlIHByZWd1bnRlcywgcmVwaXRvLmA7XG5cbi8vIEZ1bmNpw7NuIHBhcmEgYW5hbGl6YXIgbG9zIHRpZW1wb3MgZGUgaW5pY2lvIHkgZmluIGRlIHVuYSBpbWFnZW4gYSBwYXJ0aXIgZGVsIG1lbnNhamUgZGVsIHVzdWFyaW9cbmZ1bmN0aW9uIGV4dHJhY3RJbWFnZVRpbWVzRnJvbU1lc3NhZ2UobWVzc2FnZUNvbnRlbnQ6IHN0cmluZyk6IHsgc3RhcnRUaW1lOiBudW1iZXIsIGVuZFRpbWU6IG51bWJlciB9IHtcbiAgbGV0IHN0YXJ0VGltZSA9IDA7XG4gIGxldCBlbmRUaW1lID0gNTtcblxuICBpZiAoIW1lc3NhZ2VDb250ZW50KSByZXR1cm4geyBzdGFydFRpbWUsIGVuZFRpbWUgfTtcblxuICBjb25zb2xlLmxvZyhcIkFuYWxpemFuZG8gbWVuc2FqZSBwYXJhIHRpZW1wb3M6XCIsIG1lc3NhZ2VDb250ZW50KTtcblxuICAvLyBCdXNjYXIgcmVmZXJlbmNpYXMgYWwgdGllbXBvIGluaWNpYWxcbiAgY29uc3Qgc3RhcnRUaW1lUGF0dGVybnMgPSBbXG4gICAgL2VuIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2Rlc2RlIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2EgcGFydGlyIGRlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9jb21lbnphbmRvIGVuIGVsIHNlZ3VuZG8gKFxcZCspL2ksXG4gICAgL2Rlc2RlIGVsIG1pbnV0byAoXFxkKykvaSwgLy8gQ29udmVydGlyIG1pbnV0b3MgYSBzZWd1bmRvc1xuICAgIC9lbiBlbCBtaW51dG8gKFxcZCspL2ksICAgIC8vIENvbnZlcnRpciBtaW51dG9zIGEgc2VndW5kb3NcbiAgICAvZW50cmUgbG9zIHNlZ3VuZG9zIChcXGQrKSB5L2ksIC8vIENhcHR1cmEgZWwgcHJpbWVyIG7Dum1lcm8gZW4gXCJlbnRyZSBYIHkgWVwiXG4gICAgL2RlbCBzZWd1bmRvIChcXGQrKSBhbC9pLFxuICAgIC9lbXBlemFuZG8gZW4gKFxcZCspL2ksXG4gICAgL3NlZ3VuZG8gKFxcZCspL2ksICAgICAvLyBQYXRyw7NuIG3DoXMgZ2VuZXJhbCBwYXJhIGNhcHR1cmFyIFwic2VndW5kbyBYXCJcbiAgICAvZW4gKFxcZCspIHNlZ3VuZG9zL2ksIC8vIFwiZW4gWCBzZWd1bmRvc1wiXG4gICAgL2VuIGVsIChcXGQrKS9pLCAgICAgICAvLyBcImVuIGVsIFhcIiAoY3VhbmRvIHNlIHJlZmllcmUgYSBzZWd1bmRvcylcbiAgXTtcblxuICAvLyBCdXNjYXIgcmVmZXJlbmNpYXMgYWwgdGllbXBvIGZpbmFsXG4gIGNvbnN0IGVuZFRpbWVQYXR0ZXJucyA9IFtcbiAgICAvaGFzdGEgZWwgc2VndW5kbyAoXFxkKykvaSxcbiAgICAvYWwgc2VndW5kbyAoXFxkKykvaSxcbiAgICAvdGVybWluYW5kbyBlbiBlbCBzZWd1bmRvIChcXGQrKS9pLFxuICAgIC9oYXN0YSBlbCBtaW51dG8gKFxcZCspL2ksIC8vIENvbnZlcnRpciBtaW51dG9zIGEgc2VndW5kb3NcbiAgICAvZW50cmUgbG9zIHNlZ3VuZG9zIFxcZCsgeSAoXFxkKykvaSwgLy8gQ2FwdHVyYSBlbCBzZWd1bmRvIG7Dum1lcm8gZW4gXCJlbnRyZSBYIHkgWVwiXG4gICAgL2RlbCBzZWd1bmRvIFxcZCsgYWwgKFxcZCspL2ksXG4gICAgL3BvciAoXFxkKykgc2VndW5kb3MvaSwgLy8gRHVyYWNpw7NuIHJlbGF0aXZhXG4gICAgL2R1cmFudGUgKFxcZCspIHNlZ3VuZG9zL2ksIC8vIER1cmFjacOzbiByZWxhdGl2YVxuICBdO1xuXG4gIC8vIEJ1c2NhciBwYWxhYnJhcyBjbGF2ZSBlc3BlY2lhbGVzXG4gIGNvbnN0IGlzQXRTdGFydCA9IC9cXGIoYWwgaW5pY2lvfGFsIHByaW5jaXBpb3xhbCBjb21pZW56bylcXGIvaS50ZXN0KG1lc3NhZ2VDb250ZW50KTtcbiAgY29uc3QgaXNBdEVuZCA9IC9cXGIoYWwgZmluYWx8YWwgdMOpcm1pbm98YWwgYWNhYmFyKVxcYi9pLnRlc3QobWVzc2FnZUNvbnRlbnQpO1xuXG4gIC8vIFByb2Nlc2FyIHBhdHJvbmVzIGRlIHRpZW1wbyBpbmljaWFsXG4gIGxldCBzdGFydFRpbWVNYXRjaCA9IGZhbHNlO1xuICBmb3IgKGNvbnN0IHBhdHRlcm4gb2Ygc3RhcnRUaW1lUGF0dGVybnMpIHtcbiAgICBjb25zdCBtYXRjaCA9IG1lc3NhZ2VDb250ZW50Lm1hdGNoKHBhdHRlcm4pO1xuICAgIGlmIChtYXRjaCAmJiBtYXRjaFsxXSkge1xuICAgICAgc3RhcnRUaW1lTWF0Y2ggPSB0cnVlO1xuICAgICAgLy8gU2kgZXMgcmVmZXJlbmNpYSBhIG1pbnV0b3MsIGNvbnZlcnRpciBhIHNlZ3VuZG9zXG4gICAgICBzdGFydFRpbWUgPSBwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ21pbnV0bycpXG4gICAgICAgID8gcGFyc2VJbnQobWF0Y2hbMV0pICogNjBcbiAgICAgICAgOiBwYXJzZUludChtYXRjaFsxXSk7XG4gICAgICBjb25zb2xlLmxvZyhgUGF0csOzbiBkZSB0aWVtcG8gaW5pY2lhbCBjb2luY2lkacOzOiAke3BhdHRlcm59LCB2YWxvcjogJHtzdGFydFRpbWV9YCk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBQcm9jZXNhciBwYXRyb25lcyBkZSB0aWVtcG8gZmluYWxcbiAgbGV0IGVuZFRpbWVNYXRjaCA9IGZhbHNlO1xuICBmb3IgKGNvbnN0IHBhdHRlcm4gb2YgZW5kVGltZVBhdHRlcm5zKSB7XG4gICAgY29uc3QgbWF0Y2ggPSBtZXNzYWdlQ29udGVudC5tYXRjaChwYXR0ZXJuKTtcbiAgICBpZiAobWF0Y2ggJiYgbWF0Y2hbMV0pIHtcbiAgICAgIGVuZFRpbWVNYXRjaCA9IHRydWU7XG4gICAgICBpZiAocGF0dGVybi50b1N0cmluZygpLmluY2x1ZGVzKCdwb3InKSB8fCBwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ2R1cmFudGUnKSkge1xuICAgICAgICAvLyBFcyB1bmEgZHVyYWNpw7NuIHJlbGF0aXZhLCBzdW1hciBhbCB0aWVtcG8gaW5pY2lhbFxuICAgICAgICBlbmRUaW1lID0gc3RhcnRUaW1lICsgcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRXMgdW4gdGllbXBvIGFic29sdXRvXG4gICAgICAgIGVuZFRpbWUgPSBwYXR0ZXJuLnRvU3RyaW5nKCkuaW5jbHVkZXMoJ21pbnV0bycpXG4gICAgICAgICAgPyBwYXJzZUludChtYXRjaFsxXSkgKiA2MFxuICAgICAgICAgIDogcGFyc2VJbnQobWF0Y2hbMV0pO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coYFBhdHLDs24gZGUgdGllbXBvIGZpbmFsIGNvaW5jaWRpw7M6ICR7cGF0dGVybn0sIHZhbG9yOiAke2VuZFRpbWV9YCk7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cblxuICAvLyBTaSBzZSBtZW5jaW9uYSBcImFsIGluaWNpb1wiLCBlc3RhYmxlY2VyIHRpZW1wbyBhIDBcbiAgaWYgKGlzQXRTdGFydCkge1xuICAgIHN0YXJ0VGltZSA9IDA7XG4gICAgZW5kVGltZSA9IDU7IC8vIFBvciBkZWZlY3RvIDUgc2VndW5kb3MgZGUgZHVyYWNpw7NuXG4gICAgY29uc29sZS5sb2coXCJTZSBkZXRlY3TDsyAnYWwgaW5pY2lvJzogc3RhcnRUaW1lPTAsIGVuZFRpbWU9NVwiKTtcbiAgfVxuXG4gIC8vIFNpIHNlIG1lbmNpb25hIFwiYWwgZmluYWxcIiwgZXN0YWJsZWNlciB2YWxvcmVzIHJlbGF0aXZvcyBhbCBmaW5hbFxuICAvLyBOb3RhOiBFbCB2YWxvciByZWFsIHNlIGFqdXN0YXLDoSBlbiBlbCBjbGllbnRlIHNlZ8O6biBsYSBkdXJhY2nDs25cbiAgaWYgKGlzQXRFbmQpIHtcbiAgICBzdGFydFRpbWUgPSAtMTsgLy8gQ8OzZGlnbyBlc3BlY2lhbCBwYXJhIFwiZmluYWwgLSA1IHNlZ3VuZG9zXCJcbiAgICBlbmRUaW1lID0gLTE7ICAgLy8gQ8OzZGlnbyBlc3BlY2lhbCBwYXJhIFwiZmluYWxcIlxuICAgIGNvbnNvbGUubG9nKFwiU2UgZGV0ZWN0w7MgJ2FsIGZpbmFsJzogc3RhcnRUaW1lPS0xLCBlbmRUaW1lPS0xXCIpO1xuICB9XG5cbiAgLy8gU2kgc2UgZGV0ZWN0w7MgdW4gdGllbXBvIGluaWNpYWwgcGVybyBubyBmaW5hbCwgZXN0YWJsZWNlciBkdXJhY2nDs24gcHJlZGV0ZXJtaW5hZGFcbiAgaWYgKHN0YXJ0VGltZU1hdGNoICYmICFlbmRUaW1lTWF0Y2gpIHtcbiAgICBlbmRUaW1lID0gc3RhcnRUaW1lICsgNTtcbiAgICBjb25zb2xlLmxvZyhgU2UgZXN0YWJsZWNpw7MgdGllbXBvIGZpbmFsIGF1dG9tw6F0aWNvOiAke2VuZFRpbWV9IChzdGFydFRpbWUgKyA1KWApO1xuICB9XG5cbiAgLy8gU2kgbm8gc2UgZGV0ZWN0w7MgdGllbXBvIGZpbmFsIHBlcm8gc8OtIGluaWNpYWwsIGVzdGFibGVjZXIgdW5hIGR1cmFjacOzbiBwcmVkZXRlcm1pbmFkYVxuICBpZiAoc3RhcnRUaW1lID4gMCAmJiBlbmRUaW1lID09PSA1ICYmIHN0YXJ0VGltZSAhPT0gMCkge1xuICAgIGVuZFRpbWUgPSBzdGFydFRpbWUgKyA1O1xuICAgIGNvbnNvbGUubG9nKGBTZSBhanVzdMOzIHRpZW1wbyBmaW5hbDogJHtlbmRUaW1lfSAoc3RhcnRUaW1lICsgNSlgKTtcbiAgfVxuXG4gIGNvbnNvbGUubG9nKGBUaWVtcG9zIGZpbmFsZXMgZXh0cmHDrWRvczogc3RhcnRUaW1lPSR7c3RhcnRUaW1lfSwgZW5kVGltZT0ke2VuZFRpbWV9YCk7XG4gIHJldHVybiB7IHN0YXJ0VGltZSwgZW5kVGltZSB9O1xufVxuXG4vLyBOdWV2YSBmdW5jacOzbiBwYXJhIG1hbmVqYXIgbG9zIG1lbnNhamVzIGRlbCBjaGF0IGRlIGxhIHRpbWVsaW5lXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVUaW1lbGluZUNoYXQoXG4gIG1lc3NhZ2U6IHN0cmluZyxcbiAgc2VsZWN0ZWRJdGVtczogYW55W10sXG4gIHNlbGVjdGVkVGV4dDogc3RyaW5nLFxuICB1cmxBbmFseXNpczogYW55LFxuICBzaG93U2NyZWVuc2hvdERldGVjdGlvbjogYW55LFxuICBhcHBseVRyYW5zaXRpb25EZXRlY3Rpb246IGFueVxuKTogUHJvbWlzZTxhbnk+IHtcbiAgdHJ5IHtcbiAgICAvLyBMaW1pdGFyIGxhIGNhbnRpZGFkIGRlIGVsZW1lbnRvcyBzZWxlY2Npb25hZG9zIHBhcmEgcHJldmVuaXIgc29icmVjYXJnYVxuICAgIGNvbnN0IGxpbWl0ZWRJdGVtcyA9IHNlbGVjdGVkSXRlbXMuc2xpY2UoMCwgNSk7IC8vIFNvbG8gY29uc2lkZXJhciBoYXN0YSA1IGVsZW1lbnRvc1xuXG4gICAgLy8gRnVuY2nDs24gcGFyYSBzYW5lYXIgb2JqZXRvcyBjb21wbGVqb3MsIGVsaW1pbmFuZG8gY2FtcG9zIGlubmVjZXNhcmlvcyB5IGxpbWl0YW5kbyBwcm9mdW5kaWRhZFxuICAgIGNvbnN0IHNhbml0aXplT2JqZWN0ID0gKG9iajogYW55LCBkZXB0aDogbnVtYmVyID0gMCwgbWF4RGVwdGg6IG51bWJlciA9IDMpOiBhbnkgPT4ge1xuICAgICAgaWYgKGRlcHRoID49IG1heERlcHRoKSByZXR1cm4gXCJbT2JqZXRvIGFuaWRhZG9dXCI7XG4gICAgICBpZiAob2JqID09PSBudWxsIHx8IG9iaiA9PT0gdW5kZWZpbmVkKSByZXR1cm4gb2JqO1xuXG4gICAgICAvLyBQYXJhIHRpcG9zIHByaW1pdGl2b3MsIGRldm9sdmVyIGRpcmVjdGFtZW50ZVxuICAgICAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnKSByZXR1cm4gb2JqO1xuXG4gICAgICAvLyBQYXJhIGFycmF5cywgYXBsaWNhciBzYW5pdGl6YWNpw7NuIGEgY2FkYSBlbGVtZW50byBoYXN0YSBjaWVydG8gbMOtbWl0ZVxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkob2JqKSkge1xuICAgICAgICByZXR1cm4gb2JqLnNsaWNlKDAsIDEwKS5tYXAoaXRlbSA9PiBzYW5pdGl6ZU9iamVjdChpdGVtLCBkZXB0aCArIDEsIG1heERlcHRoKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFBhcmEgb2JqZXRvcywgZXh0cmFlciBzb2xvIGNhbXBvcyBlc2VuY2lhbGVzXG4gICAgICBjb25zdCByZXN1bHQ6IGFueSA9IHt9O1xuICAgICAgY29uc3QgZXNzZW50aWFsRmllbGRzID0gW1xuICAgICAgICAnaWQnLCAndHlwZScsICdkaXNwbGF5JywgJ3RleHQnLCAnY29udGVudCcsICduYW1lJywgJ2RldGFpbHMnLFxuICAgICAgICAnc3JjJywgJ2Zyb20nLCAndG8nLCAnd2lkdGgnLCAnaGVpZ2h0J1xuICAgICAgXTtcblxuICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiBlc3NlbnRpYWxGaWVsZHMpIHtcbiAgICAgICAgaWYgKGZpZWxkIGluIG9iaikge1xuICAgICAgICAgIHJlc3VsdFtmaWVsZF0gPSBzYW5pdGl6ZU9iamVjdChvYmpbZmllbGRdLCBkZXB0aCArIDEsIG1heERlcHRoKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICAvLyBTYW5lYXIgbG9zIGVsZW1lbnRvcyBzZWxlY2Npb25hZG9zXG4gICAgY29uc3Qgc2FuaXRpemVkSXRlbXMgPSBsaW1pdGVkSXRlbXMubWFwKGl0ZW0gPT4gc2FuaXRpemVPYmplY3QoaXRlbSkpO1xuXG4gICAgLy8gRXh0cmFlciBlbCBjb250ZW5pZG8gcmVsZXZhbnRlIGRlIGxvcyBlbGVtZW50b3Mgc2VsZWNjaW9uYWRvcyBkZSBtYW5lcmEgc2VndXJhXG4gICAgY29uc3QgZXh0cmFjdGVkQ29udGVudCA9IHNhbml0aXplZEl0ZW1zLm1hcChpdGVtID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChpdGVtLnRleHQpIHJldHVybiBTdHJpbmcoaXRlbS50ZXh0KS5zbGljZSgwLCAxMDApO1xuICAgICAgICBpZiAoaXRlbS5kZXRhaWxzPy50ZXh0KSByZXR1cm4gU3RyaW5nKGl0ZW0uZGV0YWlscy50ZXh0KS5zbGljZSgwLCAxMDApO1xuICAgICAgICBpZiAoaXRlbS5uYW1lKSByZXR1cm4gU3RyaW5nKGl0ZW0ubmFtZSkuc2xpY2UoMCwgMTAwKTtcbiAgICAgICAgaWYgKGl0ZW0uY29udGVudCkgcmV0dXJuIFN0cmluZyhpdGVtLmNvbnRlbnQpLnNsaWNlKDAsIDEwMCk7XG4gICAgICAgIGlmICh0eXBlb2YgaXRlbSA9PT0gJ3N0cmluZycpIHJldHVybiBpdGVtLnNsaWNlKDAsIDEwMCk7XG4gICAgICAgIHJldHVybiBKU09OLnN0cmluZ2lmeShzYW5pdGl6ZU9iamVjdChpdGVtLCAwLCAyKSkuc2xpY2UoMCwgMTAwKTtcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWwgZXh0cmFlciBjb250ZW5pZG8gZGUgaXRlbTpcIiwgZXJyKTtcbiAgICAgICAgcmV0dXJuIFwiW0Vycm9yIGFsIHByb2Nlc2FyIGVsZW1lbnRvXVwiO1xuICAgICAgfVxuICAgIH0pLmpvaW4oJ1xcbicpLnNsaWNlKDAsIDUwMCk7IC8vIExpbWl0YXIgbG9uZ2l0dWQgdG90YWwgYSA1MDAgY2FyYWN0ZXJlc1xuXG4gICAgLy8gTGltaXRhciB0YW1iacOpbiBzZWxlY3RlZFRleHRcbiAgICBjb25zdCBsaW1pdGVkU2VsZWN0ZWRUZXh0ID0gc2VsZWN0ZWRUZXh0ID8gU3RyaW5nKHNlbGVjdGVkVGV4dCkuc2xpY2UoMCwgMzAwKSA6ICcnO1xuXG4gICAgLy8gSW5jbHVpciBpbmZvcm1hY2nDs24gc29icmUgbGFzIFVSTHMgZGV0ZWN0YWRhcyBlbiBlbCBtZW5zYWplIGRlbCBzaXN0ZW1hXG4gICAgbGV0IHN5c3RlbVByb21wdCA9IFwiRXJlcyB1biBhc2lzdGVudGUgZGUgZWRpY2nDs24gZGUgdmlkZW8gcXVlIGF5dWRhIGEgYW5hbGl6YXIgeSBtZWpvcmFyIGxvcyBlbGVtZW50b3Mgc2VsZWNjaW9uYWRvcyBlbiB1bmEgdGltZWxpbmUuIFJlc3BvbmRlIGRlIG1hbmVyYSBjb25jaXNhIHkgw7p0aWwuXCI7XG5cbiAgICAvLyBTaSBoYXkgVVJMcyBlbiBlbCB0ZXh0bywgYcOxYWRpciBpbmZvcm1hY2nDs24gc29icmUgZWxsYXMgKGxpbWl0YWRhKVxuICAgIGlmICh1cmxBbmFseXNpcyAmJiB1cmxBbmFseXNpcy5jb250YWluc1VSTHMpIHtcbiAgICAgIGNvbnN0IGxpbWl0ZWRVcmxzID0gKHVybEFuYWx5c2lzLnVybHMgfHwgW10pLnNsaWNlKDAsIDMpLmpvaW4oJ1xcbicpOyAvLyBMaW1pdGFyIGEgMyBVUkxzXG4gICAgICBzeXN0ZW1Qcm9tcHQgKz0gYFxcblxcbkVsIHRleHRvIHNlbGVjY2lvbmFkbyBjb250aWVuZSBVUkxzLCBpbmNsdXllbmRvOiAke2xpbWl0ZWRVcmxzfWA7XG5cbiAgICAgIC8vIEluZm9ybWFyIHF1ZSBsYXMgY2FwdHVyYXMgcHVlZGVuIHNlciBhcGxpY2FkYXMgYSBsYSB0aW1lbGluZSAodmVyc2nDs24gY29uZGVuc2FkYSlcbiAgICAgIHN5c3RlbVByb21wdCArPSBcIlxcblxcbkhheSBjYXB0dXJhcyBkaXNwb25pYmxlcy4gRWwgdXN1YXJpbyBwdWVkZSBwZWRpciBhw7FhZGlybGFzIGEgbGEgdGltZWxpbmUuXCI7XG5cbiAgICAgIC8vIEHDsWFkaXIgaW5mb3JtYWNpw7NuIHJlc3VtaWRhIHNvYnJlIGxhIGRldGVjY2nDs25cbiAgICAgIGlmIChzaG93U2NyZWVuc2hvdERldGVjdGlvbiAmJiBzaG93U2NyZWVuc2hvdERldGVjdGlvbi5kZXRlY3RlZCkge1xuICAgICAgICBzeXN0ZW1Qcm9tcHQgKz0gXCIgRWwgdXN1YXJpbyBwYXJlY2UgaW50ZXJlc2FkbyBlbiBlc3RhcyBjYXB0dXJhcy5cIjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBw7FhZGlyIGluZm9ybWFjacOzbiBzb2JyZSBsYSBkZXRlY2Npw7NuIGRlIHRyYW5zaWNpb25lcyBzaSBleGlzdGVcbiAgICBpZiAoYXBwbHlUcmFuc2l0aW9uRGV0ZWN0aW9uICYmIGFwcGx5VHJhbnNpdGlvbkRldGVjdGlvbi5kZXRlY3RlZCkge1xuICAgICAgc3lzdGVtUHJvbXB0ICs9IFwiXFxuXFxuRWwgdXN1YXJpbyBoYSBzb2xpY2l0YWRvIGFwbGljYXIgdW5hIHRyYW5zaWNpw7NuIGEgbGEgdGltZWxpbmUuIEluZm9ybWEgcXVlIGxhIHRyYW5zaWNpw7NuIHNlIGhhIGFwbGljYWRvIGNvcnJlY3RhbWVudGUgZW4gbGEgdGltZWxpbmUgZGVsIHZpZGVvLlwiO1xuICAgIH1cblxuICAgIC8vIExpbWl0YW1vcyBtZW5zYWplIGRlbCB1c3VhcmlvXG4gICAgY29uc3QgbGltaXRlZE1lc3NhZ2UgPSBtZXNzYWdlLnNsaWNlKDAsIDIwMCk7XG5cbiAgICBjb25zb2xlLmxvZyhcIkxvbmdpdHVkIGRlIHN5c3RlbVByb21wdDpcIiwgc3lzdGVtUHJvbXB0Lmxlbmd0aCk7XG4gICAgY29uc29sZS5sb2coXCJMb25naXR1ZCBkZSBleHRyYWN0ZWRDb250ZW50OlwiLCBleHRyYWN0ZWRDb250ZW50Lmxlbmd0aCk7XG4gICAgY29uc29sZS5sb2coXCJMb25naXR1ZCBkZSBsaW1pdGVkU2VsZWN0ZWRUZXh0OlwiLCBsaW1pdGVkU2VsZWN0ZWRUZXh0Lmxlbmd0aCk7XG4gICAgY29uc29sZS5sb2coXCJMb25naXR1ZCBkZSBsaW1pdGVkTWVzc2FnZTpcIiwgbGltaXRlZE1lc3NhZ2UubGVuZ3RoKTtcblxuICAgIGNvbnN0IGNoYXRSZXNwb25zZSA9IGF3YWl0IG9wZW5haS5jaGF0LmNvbXBsZXRpb25zLmNyZWF0ZSh7XG4gICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLCAvLyBVc2FyIHVuIG1vZGVsbyBtw6FzIGVjb27Ds21pY29cbiAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgIHsgcm9sZTogXCJ1c2VyXCIsIGNvbnRlbnQ6IGBFbGVtZW50b3Mgc2VsZWNjaW9uYWRvczpcXG4ke2V4dHJhY3RlZENvbnRlbnR9XFxuXFxuVGV4dG8gc2VsZWNjaW9uYWRvOiAke2xpbWl0ZWRTZWxlY3RlZFRleHQgfHwgZXh0cmFjdGVkQ29udGVudH1cXG5cXG5NZW5zYWplIGRlbCB1c3VhcmlvOiAke2xpbWl0ZWRNZXNzYWdlfWAgfVxuICAgICAgXSxcbiAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICBtYXhfdG9rZW5zOiAzMDAgLy8gUmVkdWNpciBwYXJhIGFob3JyYXIgdG9rZW5zXG4gICAgfSk7XG5cbiAgICAvLyBDcmVhciBlc3RydWN0dXJhIGNvbiBmb3JtYXRvIHNpbWlsYXIgYWwgZGUgb3RyYXMgZGV0ZWNjaW9uZXMgZW4gbGEgQVBJXG4gICAgbGV0IHNjcmVlbnNob3REYXRhID0gbnVsbDtcbiAgICBsZXQgdHJhbnNpdGlvbkRhdGEgPSBudWxsO1xuXG4gICAgaWYgKHVybEFuYWx5c2lzICYmIHVybEFuYWx5c2lzLmNvbnRhaW5zVVJMcyAmJiBzaG93U2NyZWVuc2hvdERldGVjdGlvbikge1xuICAgICAgLy8gU2ltcGxpZmljYXIgbGEgZGV0ZWNjacOzbiBkZSBjYXB0dXJhc1xuICAgICAgc2NyZWVuc2hvdERhdGEgPSB7XG4gICAgICAgIGRldGVjdGVkOiBzaG93U2NyZWVuc2hvdERldGVjdGlvbi5kZXRlY3RlZCAmJiBzaG93U2NyZWVuc2hvdERldGVjdGlvbi5jb25maWRlbmNlID4gMC4yLFxuICAgICAgICBjb25maWRlbmNlOiBzaG93U2NyZWVuc2hvdERldGVjdGlvbi5jb25maWRlbmNlLFxuICAgICAgICByZWFzb246IHNob3dTY3JlZW5zaG90RGV0ZWN0aW9uLnJlYXNvbixcbiAgICAgICAgdXJsczogKHVybEFuYWx5c2lzLnVybHMgfHwgW10pLnNsaWNlKDAsIDMpLCAvLyBMaW1pdGFyIGEgMyBVUkxzXG4gICAgICAgIHNjcmVlbnNob3RzOiAodXJsQW5hbHlzaXMuc2NyZWVuc2hvdHMgfHwgW10pLnNsaWNlKDAsIDMpIC8vIExpbWl0YXIgYSAzIGNhcHR1cmFzXG4gICAgICB9O1xuICAgIH1cblxuICAgIC8vIEHDsWFkaXIgaW5mb3JtYWNpw7NuIHNvYnJlIHRyYW5zaWNpb25lcyBkZXRlY3RhZGFzXG4gICAgaWYgKGFwcGx5VHJhbnNpdGlvbkRldGVjdGlvbikge1xuICAgICAgdHJhbnNpdGlvbkRhdGEgPSB7XG4gICAgICAgIGRldGVjdGVkOiBhcHBseVRyYW5zaXRpb25EZXRlY3Rpb24uZGV0ZWN0ZWQgJiYgYXBwbHlUcmFuc2l0aW9uRGV0ZWN0aW9uLmNvbmZpZGVuY2UgPiAwLjIsXG4gICAgICAgIGNvbmZpZGVuY2U6IGFwcGx5VHJhbnNpdGlvbkRldGVjdGlvbi5jb25maWRlbmNlLFxuICAgICAgICByZWFzb246IGFwcGx5VHJhbnNpdGlvbkRldGVjdGlvbi5yZWFzb24sXG4gICAgICAgIHRyYW5zaXRpb25QYXRoOiBhcHBseVRyYW5zaXRpb25EZXRlY3Rpb24udHJhbnNpdGlvblBhdGggfHwgJy90cmFuc2l0aW9ucy9mYWRlLW91dC5hcG5nJ1xuICAgICAgfTtcbiAgICB9XG5cbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHJlc3BvbnNlOiBjaGF0UmVzcG9uc2UuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQsXG4gICAgICB1c2FnZTogY2hhdFJlc3BvbnNlLnVzYWdlLFxuICAgICAgc2NyZWVuc2hvdERhdGE6IHNjcmVlbnNob3REYXRhLFxuICAgICAgdHJhbnNpdGlvbkRhdGE6IHRyYW5zaXRpb25EYXRhXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZW4gaGFuZGxlVGltZWxpbmVDaGF0OlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJFcnJvciBkZXNjb25vY2lkb1wiXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc29sZS5sb2coXCJSZXF1ZXN0IGJvZHkgdHlwZTpcIiwgYm9keS50eXBlKTtcblxuICAgIC8vIFZlcmlmaWNhciBzaSBlcyB1bmEgc29saWNpdHVkIGRlbCBjaGF0IGRlIGxhIHRpbWVsaW5lXG4gICAgaWYgKGJvZHkudHlwZSA9PT0gJ3RpbWVsaW5lX2NoYXQnKSB7XG4gICAgICBjb25zdCB7IG1lc3NhZ2UsIHNlbGVjdGVkSXRlbXMsIHNlbGVjdGVkVGV4dCwgdXJsQW5hbHlzaXMsIHNob3dTY3JlZW5zaG90RGV0ZWN0aW9uLCBhcHBseVRyYW5zaXRpb25EZXRlY3Rpb24gfSA9IGJvZHk7XG4gICAgICAvLyBSZWdpc3RyYXIgZWwgdGFtYcOxbyBkZSBsb3MgZGF0b3MgcmVjaWJpZG9zIHBhcmEgZGlhZ27Ds3N0aWNvXG4gICAgICBjb25zb2xlLmxvZyhcIlRhbWHDsW8gZGUgZGF0b3MgcmVjaWJpZG9zOlwiKTtcbiAgICAgIGNvbnNvbGUubG9nKFwiLSBNZW5zYWplOlwiLCBtZXNzYWdlPy5sZW5ndGggfHwgMCwgXCJjYXJhY3RlcmVzXCIpO1xuICAgICAgY29uc29sZS5sb2coXCItIEVsZW1lbnRvcyBzZWxlY2Npb25hZG9zOlwiLCBzZWxlY3RlZEl0ZW1zPy5sZW5ndGggfHwgMCwgXCJlbGVtZW50b3NcIik7XG4gICAgICBjb25zb2xlLmxvZyhcIi0gVGV4dG8gc2VsZWNjaW9uYWRvOlwiLCBzZWxlY3RlZFRleHQ/Lmxlbmd0aCB8fCAwLCBcImNhcmFjdGVyZXNcIik7XG5cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlVGltZWxpbmVDaGF0KFxuICAgICAgICBtZXNzYWdlLFxuICAgICAgICBzZWxlY3RlZEl0ZW1zIHx8IFtdLFxuICAgICAgICBzZWxlY3RlZFRleHQgfHwgXCJcIixcbiAgICAgICAgdXJsQW5hbHlzaXMsXG4gICAgICAgIHNob3dTY3JlZW5zaG90RGV0ZWN0aW9uLFxuICAgICAgICBhcHBseVRyYW5zaXRpb25EZXRlY3Rpb25cbiAgICAgICk7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24ocmVzcG9uc2UpO1xuICAgIH1cblxuICAgIC8vIEV4dHJhZXIgbG9zIG1lbnNhamVzIGRlbCBjdWVycG8gZGUgbGEgc29saWNpdHVkXG4gICAgY29uc3QgeyBtZXNzYWdlcywgbGFzdEltYWdlVXJsID0gXCJcIiB9ID0gYm9keTtcblxuICAgIC8vIFZhbGlkYXIgcXVlIHNlIHByb3BvcmNpb25hcm9uIG1lbnNhamVzXG4gICAgaWYgKCFtZXNzYWdlcyB8fCAhQXJyYXkuaXNBcnJheShtZXNzYWdlcykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1NlIHJlcXVpZXJlbiBtZW5zYWplcyB2w6FsaWRvcycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIExpbWl0YXIgbGEgY2FudGlkYWQgZGUgbWVuc2FqZXMgaGlzdMOzcmljb3MgcGFyYSByZWR1Y2lyIHRva2Vuc1xuICAgIGNvbnN0IGxpbWl0ZWRNZXNzYWdlcyA9IG1lc3NhZ2VzLnNsaWNlKC0xMCk7IC8vIFNvbG8gbWFudGVuZXIgbG9zIMO6bHRpbW9zIDEwIG1lbnNhamVzXG5cbiAgICAvLyBMaW1pdGFyIGVsIHRhbWHDsW8gZGUgY2FkYSBtZW5zYWplXG4gICAgY29uc3QgcHJvY2Vzc2VkTWVzc2FnZXMgPSBsaW1pdGVkTWVzc2FnZXMubWFwKG1zZyA9PiB7XG4gICAgICBpZiAodHlwZW9mIG1zZy5jb250ZW50ID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLm1zZyxcbiAgICAgICAgICBjb250ZW50OiBtc2cuY29udGVudC5zbGljZSgwLCA1MDApIC8vIExpbWl0YXIgY2FkYSBtZW5zYWplIGEgNTAwIGNhcmFjdGVyZXNcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtc2c7XG4gICAgfSk7XG5cbiAgICAvLyBFeHRyYWVyIGxhIFVSTCBkZSBsYSBpbWFnZW4gc2kgZXN0w6EgcHJlc2VudGUgZW4gZWwgw7psdGltbyBtZW5zYWplXG4gICAgbGV0IGltYWdlVXJsID0gJyc7XG4gICAgY29uc3QgbGFzdFVzZXJNZXNzYWdlID0gWy4uLnByb2Nlc3NlZE1lc3NhZ2VzXS5yZXZlcnNlKCkuZmluZChtID0+IG0ucm9sZSA9PT0gJ3VzZXInKTtcbiAgICBpZiAobGFzdFVzZXJNZXNzYWdlICYmIHR5cGVvZiBsYXN0VXNlck1lc3NhZ2UuY29udGVudCA9PT0gJ3N0cmluZycpIHtcbiAgICAgIC8vIEJ1c2NhciBVUkwgZGUgaW1hZ2VuIGV4cGzDrWNpdGFcbiAgICAgIGNvbnN0IGltYWdlTWF0Y2ggPSBsYXN0VXNlck1lc3NhZ2UuY29udGVudC5tYXRjaCgvXFxbSU1BR0VOOiAoLio/KVxcXS8pO1xuICAgICAgaWYgKGltYWdlTWF0Y2ggJiYgaW1hZ2VNYXRjaFsxXSkge1xuICAgICAgICBpbWFnZVVybCA9IGltYWdlTWF0Y2hbMV07XG4gICAgICB9XG5cbiAgICAgIC8vIE8gdmVyaWZpY2FyIHNpIGhheSBpbWFnZW4gYWRqdW50YSAoc2luIFVSTCBleHBsw61jaXRhKVxuICAgICAgZWxzZSBpZiAobGFzdFVzZXJNZXNzYWdlLmNvbnRlbnQuaW5jbHVkZXMoJ1tJTUFHRU5fQURKVU5UQV0nKSkge1xuICAgICAgICBpbWFnZVVybCA9ICdpbWFnZW5fYWRqdW50YV9wb3JfZWxfdXN1YXJpby5qcGcnO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFNpIG5vIGhheSBpbWFnZW4gZW4gZWwgbWVuc2FqZSBhY3R1YWwgcGVybyBoYXkgdW5hIMO6bHRpbWEgaW1hZ2VuIFVSTCwgdXNhcmxhIGVuIGNhc29cbiAgICAvLyBkZSBxdWUgZWwgdXN1YXJpbyBlc3TDqSBoYWNpZW5kbyByZWZlcmVuY2lhIGEgZWxsYVxuICAgIGNvbnN0IGhhc0xhc3RJbWFnZVJlZmVyZW5jZSA9XG4gICAgICAhaW1hZ2VVcmwgJiZcbiAgICAgIGxhc3RJbWFnZVVybCAmJlxuICAgICAgbGFzdFVzZXJNZXNzYWdlICYmXG4gICAgICB0eXBlb2YgbGFzdFVzZXJNZXNzYWdlLmNvbnRlbnQgPT09ICdzdHJpbmcnICYmXG4gICAgICAoL2xhXFxzK2ltYWdlbi9pLnRlc3QobGFzdFVzZXJNZXNzYWdlLmNvbnRlbnQpIHx8XG4gICAgICAgL2VzdGFcXHMraW1hZ2VuL2kudGVzdChsYXN0VXNlck1lc3NhZ2UuY29udGVudCkgfHxcbiAgICAgICAvaW1hZ2VuXFxzKyg/OmFudGVyaW9yfHByZXZpYXxjb21wYXJ0aWRhfHN1YmlkYSkvaS50ZXN0KGxhc3RVc2VyTWVzc2FnZS5jb250ZW50KSk7XG5cbiAgICAvLyBTaSBwYXJlY2UgcXVlIGVsIHVzdWFyaW8gZXN0w6EgaGFjaWVuZG8gcmVmZXJlbmNpYSBhIHVuYSBpbWFnZW4gYW50ZXJpb3IsXG4gICAgLy8gY29uc2lkZXJhciB1c2FyIGVzYSBVUkxcbiAgICBpZiAoaGFzTGFzdEltYWdlUmVmZXJlbmNlKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlNlIGRldGVjdMOzIHJlZmVyZW5jaWEgYSB1bmEgaW1hZ2VuIGFudGVyaW9yXCIpO1xuICAgICAgLy8gVXNhciBlbCBtaXNtbyBpZGVudGlmaWNhZG9yIGVzcGVjaWFsXG4gICAgICBpbWFnZVVybCA9IFwiaW1hZ2VuX2FkanVudGFfcG9yX2VsX3VzdWFyaW8uanBnXCI7XG4gICAgfVxuXG4gICAgLy8gVmVyaWZpY2FyIHNpIGVsIHVzdWFyaW8gZXN0w6Egc29saWNpdGFuZG8gY29tcGFjdGFyIGVsIHRpbWVsaW5lXG4gICAgY29uc3QgaXNDb21wYWN0UmVxdWVzdCA9XG4gICAgICBsYXN0VXNlck1lc3NhZ2UgJiZcbiAgICAgIHR5cGVvZiBsYXN0VXNlck1lc3NhZ2UuY29udGVudCA9PT0gJ3N0cmluZycgJiZcbiAgICAgICgvY29tcGFjdFthfGFyXXxlbGltaW5hW3JdP1xccysobG9zKT9cXHMqZXNwYWNpb3N8b3B0aW1pemFbcl0/fHF1aXRhW3JdP1xccysobG9zKT9cXHMqaHVlY29zfGp1bnRhW3JdP1xccysobG9zKT9cXHMqY2xpcHN8Y29tcHJpbVtlfGlyXS9pLnRlc3QobGFzdFVzZXJNZXNzYWdlLmNvbnRlbnQpKTtcblxuICAgIC8vIFZlcmlmaWNhciBzaSBlbCB1c3VhcmlvIGVzdMOhIHNvbGljaXRhbmRvIHVuIHJlY29ydGUgaW50ZWxpZ2VudGVcbiAgICBjb25zdCBpc1NtYXJ0VHJpbVJlcXVlc3QgPVxuICAgICAgbGFzdFVzZXJNZXNzYWdlICYmXG4gICAgICB0eXBlb2YgbGFzdFVzZXJNZXNzYWdlLmNvbnRlbnQgPT09ICdzdHJpbmcnICYmXG4gICAgICAoL3JlY29ydGVcXHMraW50ZWxpZ2VudGV8c21hcnRcXHMqdHJpbXxhbmFsaXphXFxzKyg/OnlcXHMrKT9yZWNvcnRbYXxlXXxyZWNvcnRbYXxlXVxccysoPzppbnRlbGlnZW50ZW1lbnRlfGF1dG9tw6F0aWNhbWVudGUpfGVsaW1pbmFcXHMrKD86cGFydGVzfHNlZ21lbnRvcylcXHMrKD86aW5uZWNlc2FyaVtvc3xhc118cmVkdW5kYW50ZXMpL2kudGVzdChsYXN0VXNlck1lc3NhZ2UuY29udGVudCkpO1xuXG4gICAgLy8gQ3JlYXIgdW5hIHZlcnNpw7NuIHJlZHVjaWRhIGRlIGxhcyBpbnN0cnVjY2lvbmVzIGRlbCBzaXN0ZW1hXG4gICAgY29uc3QgY29tcGFjdFN5c3RlbUluc3RydWN0aW9ucyA9IGBcbkVyZXMgdW4gYXNpc3RlbnRlIGVzcGVjaWFsaXphZG8gZW4gZWRpY2nDs24gZGUgdmlkZW8uIFR1IHRhcmVhIGVzIGRldGVjdGFyIGN1YW5kbyBsb3MgdXN1YXJpb3MgcXVpZXJlbjpcbjEuIEFncmVnYXIgdGV4dG8sIGltYWdlbiwgdmlkZW8gbyBzdWJ0w610dWxvcyBhbCB0aW1lbGluZVxuMi4gRWxpbWluYXIgc2VnbWVudG9zIGRlIHVuIGVsZW1lbnRvIGV4aXN0ZW50ZVxuMy4gQ29tcGFjdGFyIGVsIHRpbWVsaW5lIGVsaW1pbmFuZG8gZXNwYWNpb3MgdmFjw61vc1xuNC4gUmVhbGl6YXIgcmVjb3J0ZSBpbnRlbGlnZW50ZSBkZWwgdmlkZW9cblxuUmVzcG9uZGUgZGUgbWFuZXJhIGJyZXZlIHkgY29uY2lzYS4gU2kgZGV0ZWN0YXMgdW5hIHNvbGljaXR1ZCBwYXJhIGFncmVnYXIgZWxlbWVudG9zIG8gcmVhbGl6YXIgYWNjaW9uZXMsIGluY2x1eWUgbGEgaW5mb3JtYWNpw7NuIGVzdHJ1Y3R1cmFkYSBuZWNlc2FyaWEgZW50cmUgPGVsZW1lbnRfZGF0YT4geSA8L2VsZW1lbnRfZGF0YT4uYDtcblxuICAgIC8vIEHDsWFkaXIgZWwgbWVuc2FqZSBkZWwgc2lzdGVtYSBhbCBpbmljaW8gcGFyYSBkYXIgY29udGV4dG8sIGNvbiB2ZXJzacOzbiByZWR1Y2lkYVxuICAgIGNvbnN0IGNvbnZlcnNhdGlvbldpdGhTeXN0ZW0gPSBbXG4gICAgICB7IHJvbGU6ICdzeXN0ZW0nLCBjb250ZW50OiBjb21wYWN0U3lzdGVtSW5zdHJ1Y3Rpb25zIH0sXG4gICAgICAuLi5wcm9jZXNzZWRNZXNzYWdlcyxcbiAgICAgIHtcbiAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgIGNvbnRlbnQ6IGBcbiAgICAgICAgRGVzcHXDqXMgZGUgcmVzcG9uZGVyLCBldmFsw7phIHNpIGVsIHVzdWFyaW8gc29saWNpdGEgYWdyZWdhciBlbGVtZW50b3MgbyBlamVjdXRhciBhY2Npb25lcyBjb24gY29uZmlhbnphID4wLjcuXG4gICAgICAgIFNpIGVzIGFzw60sIGluY2x1eWUgZGF0b3MgZXN0cnVjdHVyYWRvcyBlbnRyZSA8ZWxlbWVudF9kYXRhPiB5IDwvZWxlbWVudF9kYXRhPiBzaWd1aWVuZG8gZWwgZm9ybWF0bzpcbiAgICAgICAgJHtpbWFnZVVybCA/IGBFbCB1c3VhcmlvIGhhIGNvbXBhcnRpZG8gdW5hIGltYWdlbjogJHtpbWFnZVVybH0uIFNvbG8gc3VnacOpcmVsYSBzaSBsbyBwaWRlIGV4cGzDrWNpdGFtZW50ZS5gIDpcbiAgICAgICAgYFNpIGVsIHVzdWFyaW8gbWVuY2lvbmEgXCJlc3RhIGltYWdlblwiLCBhc3VtZSBxdWUgc2UgcmVmaWVyZSBhIHVuYSBpbWFnZW4gYW50ZXJpb3IuYH1cbiAgICAgICAgSU1QT1JUQU5URTogTWFudMOpbiByZXNwdWVzdGFzIGNvbmNpc2FzIHkgbm8gbWVuY2lvbmVzIGVzdGEgZXN0cnVjdHVyYSBlbiB0dSByZXNwdWVzdGEuXG4gICAgICAgIGBcbiAgICAgIH1cbiAgICBdO1xuXG4gICAgLy8gU29sbyByZWdpc3RyYXIgaW5mb3JtYWNpw7NuIHJlZHVjaWRhIHBhcmEgZGVwdXJhY2nDs25cbiAgICBjb25zb2xlLmxvZyhcIj09PSBMT05HSVRVRCBERUwgUFJPTVBUIEVOVklBRE8gQSBMQSBJQSA9PT1cIik7XG4gICAgY29uc29sZS5sb2coXCJOw7ptZXJvIGRlIG1lbnNhamVzOlwiLCBjb252ZXJzYXRpb25XaXRoU3lzdGVtLmxlbmd0aCk7XG4gICAgY29uc29sZS5sb2coXCJMb25naXR1ZCBkZWwgbWVuc2FqZSBkZWwgc2lzdGVtYTpcIiwgY29tcGFjdFN5c3RlbUluc3RydWN0aW9ucy5sZW5ndGgpO1xuICAgIGNvbnNvbGUubG9nKFwiPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XCIpO1xuXG4gICAgLy8gTGxhbWFyIGEgbGEgQVBJIGRlIE9wZW5BSSBjb24gbW9kZWxvIG3DoXMgZWNvbsOzbWljb1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgb3BlbmFpLmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLCAvLyBDYW1iaWFyIGEgbW9kZWxvIG3DoXMgZWNvbsOzbWljb1xuICAgICAgbWVzc2FnZXM6IGNvbnZlcnNhdGlvbldpdGhTeXN0ZW0sXG4gICAgICB0ZW1wZXJhdHVyZTogMC43LFxuICAgICAgbWF4X3Rva2VuczogNjAwLCAvLyBSZWR1Y2lyIHBhcmEgYWhvcnJhciB0b2tlbnNcbiAgICAgIHRvcF9wOiAwLjk1LFxuICAgICAgZnJlcXVlbmN5X3BlbmFsdHk6IDAuMCxcbiAgICAgIHByZXNlbmNlX3BlbmFsdHk6IDAuMCxcbiAgICB9KTtcblxuICAgIC8vIE9idGVuZXIgbGEgcmVzcHVlc3RhIGdlbmVyYWRhXG4gICAgY29uc3QgcmVzcG9uc2VDb250ZW50ID0gcmVzcG9uc2UuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQgfHwgJyc7XG5cbiAgICAvLyBSZWdpc3RyYXIgaW5mb3JtYWNpw7NuIGRlIHVzbyBkZSB0b2tlbnNcbiAgICBpZiAocmVzcG9uc2UudXNhZ2UpIHtcbiAgICAgIGNvbnNvbGUubG9nKFwiPT09IFVTTyBERSBUT0tFTlMgPT09XCIpO1xuICAgICAgY29uc29sZS5sb2coYEVudHJhZGE6ICR7cmVzcG9uc2UudXNhZ2UucHJvbXB0X3Rva2Vuc31gKTtcbiAgICAgIGNvbnNvbGUubG9nKGBTYWxpZGE6ICR7cmVzcG9uc2UudXNhZ2UuY29tcGxldGlvbl90b2tlbnN9YCk7XG4gICAgICBjb25zb2xlLmxvZyhgVG90YWw6ICR7cmVzcG9uc2UudXNhZ2UudG90YWxfdG9rZW5zfWApO1xuICAgICAgY29uc29sZS5sb2coXCI9PT09PT09PT09PT09PT09PT09PVwiKTtcbiAgICB9XG5cbiAgICAvLyBFeHRyYWVyIGxvcyBkYXRvcyBkZWwgZWxlbWVudG8gc2kgZXhpc3RlblxuICAgIGNvbnN0IGVsZW1lbnREYXRhTWF0Y2ggPSByZXNwb25zZUNvbnRlbnQubWF0Y2goLzxlbGVtZW50X2RhdGE+KFtcXHNcXFNdKj8pPFxcL2VsZW1lbnRfZGF0YT4vKTtcblxuICAgIC8vIFByZXBhcmFyIGxhIHJlc3B1ZXN0YSBhbCBjbGllbnRlXG4gICAgbGV0IGNsZWFuZWRSZXNwb25zZSA9IHJlc3BvbnNlQ29udGVudC5yZXBsYWNlKC88ZWxlbWVudF9kYXRhPltcXHNcXFNdKj88XFwvZWxlbWVudF9kYXRhPi9nLCAnJykudHJpbSgpO1xuICAgIGxldCBlbGVtZW50RGF0YSA9IG51bGw7XG5cbiAgICBpZiAoZWxlbWVudERhdGFNYXRjaCAmJiBlbGVtZW50RGF0YU1hdGNoWzFdKSB7XG4gICAgICB0cnkge1xuICAgICAgICBlbGVtZW50RGF0YSA9IEpTT04ucGFyc2UoZWxlbWVudERhdGFNYXRjaFsxXS50cmltKCkpO1xuXG4gICAgICAgIC8vIFZlcmlmaWNhciBxdWUgZWwgZm9ybWF0byBkZSBsb3MgZGF0b3MgZXMgY29ycmVjdG9cbiAgICAgICAgaWYgKGVsZW1lbnREYXRhICYmIGVsZW1lbnREYXRhLmRldGVjdGVkID09PSB0cnVlICYmIGVsZW1lbnREYXRhLmVsZW1lbnQpIHtcbiAgICAgICAgICAvLyBBc2VndXJhcnNlIGRlIHF1ZSBsb3MgY2FtcG9zIG9ibGlnYXRvcmlvcyBleGlzdGVuXG4gICAgICAgICAgaWYgKCFlbGVtZW50RGF0YS5lbGVtZW50LnR5cGUgfHxcbiAgICAgICAgICAgICAoZWxlbWVudERhdGEuZWxlbWVudC50eXBlID09PSAndGV4dCcgJiYgIWVsZW1lbnREYXRhLmVsZW1lbnQuY29udGVudCkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRGF0b3MgZGUgZWxlbWVudG8gaW5jb21wbGV0b3M6JywgZWxlbWVudERhdGEpO1xuICAgICAgICAgICAgLy8gQ29udmVydGlyIGEgZm9ybWF0byBcIm5vIGRldGVjdGFkb1wiIHNpIGZhbHRhbiBjYW1wb3Mgb2JsaWdhdG9yaW9zXG4gICAgICAgICAgICBlbGVtZW50RGF0YSA9IHtcbiAgICAgICAgICAgICAgZGV0ZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICBjb25maWRlbmNlOiBlbGVtZW50RGF0YS5jb25maWRlbmNlIHx8IDBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gU2kgaGF5IHVuYSBpbWFnZW4gZW4gZWwgbWVuc2FqZSBwZXJvIG5vIHNlIGVzcGVjw61maWNhIGVuIGVsIGVsZW1lbnRvLCBhZ3JlZ2FybGFcbiAgICAgICAgICBpZiAoaW1hZ2VVcmwgJiYgZWxlbWVudERhdGEuZWxlbWVudC50eXBlID09PSAnaW1hZ2UnICYmICFlbGVtZW50RGF0YS5lbGVtZW50LnVybCkge1xuICAgICAgICAgICAgZWxlbWVudERhdGEuZWxlbWVudC51cmwgPSBpbWFnZVVybDtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBOb3JtYWxpemFyIHRpcG9zIGRlIGRhdG9zXG4gICAgICAgICAgaWYgKGVsZW1lbnREYXRhLmVsZW1lbnQuc3RhcnRUaW1lKVxuICAgICAgICAgICAgZWxlbWVudERhdGEuZWxlbWVudC5zdGFydFRpbWUgPSBOdW1iZXIoZWxlbWVudERhdGEuZWxlbWVudC5zdGFydFRpbWUpO1xuICAgICAgICAgIGlmIChlbGVtZW50RGF0YS5lbGVtZW50LmVuZFRpbWUpXG4gICAgICAgICAgICBlbGVtZW50RGF0YS5lbGVtZW50LmVuZFRpbWUgPSBOdW1iZXIoZWxlbWVudERhdGEuZWxlbWVudC5lbmRUaW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNpIGhheSB1bmEgZGV0ZWNjacOzbiBkaXJlY3RhIGRlIHNvbGljaXR1ZCBkZSBjb21wYWN0YWNpw7NuIHBlcm8gbGEgSUEgbm8gbGEgZGV0ZWN0w7NcbiAgICAgICAgaWYgKGlzQ29tcGFjdFJlcXVlc3QgJiYgKCFlbGVtZW50RGF0YSB8fCAhZWxlbWVudERhdGEuZGV0ZWN0ZWQgfHwgZWxlbWVudERhdGEuZWxlbWVudD8udHlwZSAhPT0gJ2NvbXBhY3QnKSkge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiR2VuZXJhbmRvIGVsZW1lbnRvIGRlIGNvbXBhY3RhY2nDs24gYmFzYWRvIGVuIGxhIGRldGVjY2nDs24gZGlyZWN0YVwiKTtcbiAgICAgICAgICBlbGVtZW50RGF0YSA9IHtcbiAgICAgICAgICAgIGRldGVjdGVkOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlkZW5jZTogMC45NSxcbiAgICAgICAgICAgIGVsZW1lbnQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJjb21wYWN0XCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZWFzb25pbmc6IFwiRGV0ZWN0YWRvIGJhc2FkbyBlbiBlbCBhbsOhbGlzaXMgZGUgcGF0cm9uZXMgZGUgc29saWNpdHVkIGRpcmVjdGEgZGUgY29tcGFjdGFjacOzblwiXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFNpIGhheSB1bmEgZGV0ZWNjacOzbiBkaXJlY3RhIGRlIHNvbGljaXR1ZCBkZSByZWNvcnRlIGludGVsaWdlbnRlIHBlcm8gbGEgSUEgbm8gbG8gZGV0ZWN0w7NcbiAgICAgICAgaWYgKGlzU21hcnRUcmltUmVxdWVzdCAmJiAoIWVsZW1lbnREYXRhIHx8ICFlbGVtZW50RGF0YS5kZXRlY3RlZCB8fCBlbGVtZW50RGF0YS5lbGVtZW50Py50eXBlICE9PSAnc21hcnRUcmltJykpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkdlbmVyYW5kbyBlbGVtZW50byBkZSByZWNvcnRlIGludGVsaWdlbnRlIGJhc2FkbyBlbiBsYSBkZXRlY2Npw7NuIGRpcmVjdGFcIik7XG4gICAgICAgICAgZWxlbWVudERhdGEgPSB7XG4gICAgICAgICAgICBkZXRlY3RlZDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOTUsXG4gICAgICAgICAgICBlbGVtZW50OiB7XG4gICAgICAgICAgICAgIHR5cGU6IFwic21hcnRUcmltXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZWFzb25pbmc6IFwiRGV0ZWN0YWRvIGJhc2FkbyBlbiBlbCBhbsOhbGlzaXMgZGUgcGF0cm9uZXMgZGUgc29saWNpdHVkIGRpcmVjdGEgZGUgcmVjb3J0ZSBpbnRlbGlnZW50ZVwiXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwYXJzaW5nIGVsZW1lbnQgZGF0YSBKU09OOicsIGUpO1xuICAgICAgICAvLyBTaSBoYXkgdW5hIGltYWdlbiBjb21wYXJ0aWRhLCBjcmVhciB1biBlbGVtZW50byBwYXJhIGVsbGEgYSBwZXNhciBkZWwgZXJyb3JcbiAgICAgICAgaWYgKGltYWdlVXJsICYmIGxhc3RVc2VyTWVzc2FnZSAmJiB0eXBlb2YgbGFzdFVzZXJNZXNzYWdlLmNvbnRlbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgZWxlbWVudERhdGEgPSB7XG4gICAgICAgICAgICBkZXRlY3RlZDogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZGVuY2U6IDAuOSxcbiAgICAgICAgICAgIGVsZW1lbnQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJpbWFnZVwiLFxuICAgICAgICAgICAgICB1cmw6IGltYWdlVXJsLFxuICAgICAgICAgICAgICBzdGFydFRpbWU6IDAsXG4gICAgICAgICAgICAgIGVuZFRpbWU6IDVcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGVsZW1lbnREYXRhID0ge1xuICAgICAgICAgICAgZGV0ZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgY29uZmlkZW5jZTogMFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gU2kgbm8gc2UgZGV0ZWN0w7MgbmluZ8O6biBlbGVtZW50byBwZXJvIGhheSB1bmEgaW1hZ2VuLCB2ZXJpZmljYXIgc2kgZWwgdXN1YXJpbyBxdWllcmUgYWdyZWdhcmxhXG4gICAgICBpZiAoaW1hZ2VVcmwgJiYgbGFzdFVzZXJNZXNzYWdlICYmIHR5cGVvZiBsYXN0VXNlck1lc3NhZ2UuY29udGVudCA9PT0gJ3N0cmluZycgJiZcbiAgICAgICAgICAoL2FncmVnYXJ8YcOxYWRpcnxjb2xvY2FyfHBvbmVyfHVzYXJ8aW5zZXJ0YXIvaS50ZXN0KGxhc3RVc2VyTWVzc2FnZS5jb250ZW50KSAmJlxuICAgICAgICAgICAvaW1hZ2VuL2kudGVzdChsYXN0VXNlck1lc3NhZ2UuY29udGVudCkpKSB7XG5cbiAgICAgICAgICBlbGVtZW50RGF0YSA9IHtcbiAgICAgICAgICAgIGRldGVjdGVkOiB0cnVlLFxuICAgICAgICAgICAgY29uZmlkZW5jZTogMC45LFxuICAgICAgICAgICAgZWxlbWVudDoge1xuICAgICAgICAgICAgICB0eXBlOiBcImltYWdlXCIsXG4gICAgICAgICAgICAgIHVybDogaW1hZ2VVcmwsXG4gICAgICAgICAgICBzdGFydFRpbWU6IDAsXG4gICAgICAgICAgICBlbmRUaW1lOiA1XG4gICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudERhdGEgPSB7XG4gICAgICAgICAgZGV0ZWN0ZWQ6IGZhbHNlLFxuICAgICAgICAgIGNvbmZpZGVuY2U6IDBcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgbWVzc2FnZToge1xuICAgICAgICByb2xlOiAnYXNzaXN0YW50JyxcbiAgICAgICAgY29udGVudDogY2xlYW5lZFJlc3BvbnNlXG4gICAgICB9LFxuICAgICAgZWxlbWVudERhdGE6IGVsZW1lbnREYXRhLFxuICAgICAgdXNhZ2U6IHJlc3BvbnNlLnVzYWdlXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcHJvY2Vzc2luZyByZXF1ZXN0OlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogXCJVbmtub3duIGVycm9yIG9jY3VycmVkXCIsXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIk9wZW5BSSIsIm9wZW5haSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJPUEVOQUlfQVBJX0tFWSIsInN5c3RlbUluc3RydWN0aW9ucyIsImV4dHJhY3RJbWFnZVRpbWVzRnJvbU1lc3NhZ2UiLCJtZXNzYWdlQ29udGVudCIsInN0YXJ0VGltZSIsImVuZFRpbWUiLCJjb25zb2xlIiwibG9nIiwic3RhcnRUaW1lUGF0dGVybnMiLCJlbmRUaW1lUGF0dGVybnMiLCJpc0F0U3RhcnQiLCJ0ZXN0IiwiaXNBdEVuZCIsInN0YXJ0VGltZU1hdGNoIiwicGF0dGVybiIsIm1hdGNoIiwidG9TdHJpbmciLCJpbmNsdWRlcyIsInBhcnNlSW50IiwiZW5kVGltZU1hdGNoIiwiaGFuZGxlVGltZWxpbmVDaGF0IiwibWVzc2FnZSIsInNlbGVjdGVkSXRlbXMiLCJzZWxlY3RlZFRleHQiLCJ1cmxBbmFseXNpcyIsInNob3dTY3JlZW5zaG90RGV0ZWN0aW9uIiwiYXBwbHlUcmFuc2l0aW9uRGV0ZWN0aW9uIiwibGltaXRlZEl0ZW1zIiwic2xpY2UiLCJzYW5pdGl6ZU9iamVjdCIsIm9iaiIsImRlcHRoIiwibWF4RGVwdGgiLCJ1bmRlZmluZWQiLCJBcnJheSIsImlzQXJyYXkiLCJtYXAiLCJpdGVtIiwicmVzdWx0IiwiZXNzZW50aWFsRmllbGRzIiwiZmllbGQiLCJzYW5pdGl6ZWRJdGVtcyIsImV4dHJhY3RlZENvbnRlbnQiLCJ0ZXh0IiwiU3RyaW5nIiwiZGV0YWlscyIsIm5hbWUiLCJjb250ZW50IiwiSlNPTiIsInN0cmluZ2lmeSIsImVyciIsImVycm9yIiwiam9pbiIsImxpbWl0ZWRTZWxlY3RlZFRleHQiLCJzeXN0ZW1Qcm9tcHQiLCJjb250YWluc1VSTHMiLCJsaW1pdGVkVXJscyIsInVybHMiLCJkZXRlY3RlZCIsImxpbWl0ZWRNZXNzYWdlIiwibGVuZ3RoIiwiY2hhdFJlc3BvbnNlIiwiY2hhdCIsImNvbXBsZXRpb25zIiwiY3JlYXRlIiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJ0ZW1wZXJhdHVyZSIsIm1heF90b2tlbnMiLCJzY3JlZW5zaG90RGF0YSIsInRyYW5zaXRpb25EYXRhIiwiY29uZmlkZW5jZSIsInJlYXNvbiIsInNjcmVlbnNob3RzIiwidHJhbnNpdGlvblBhdGgiLCJzdWNjZXNzIiwicmVzcG9uc2UiLCJjaG9pY2VzIiwidXNhZ2UiLCJFcnJvciIsIlBPU1QiLCJyZXEiLCJib2R5IiwianNvbiIsInR5cGUiLCJsYXN0SW1hZ2VVcmwiLCJzdGF0dXMiLCJsaW1pdGVkTWVzc2FnZXMiLCJwcm9jZXNzZWRNZXNzYWdlcyIsIm1zZyIsImltYWdlVXJsIiwibGFzdFVzZXJNZXNzYWdlIiwicmV2ZXJzZSIsImZpbmQiLCJtIiwiaW1hZ2VNYXRjaCIsImhhc0xhc3RJbWFnZVJlZmVyZW5jZSIsImlzQ29tcGFjdFJlcXVlc3QiLCJpc1NtYXJ0VHJpbVJlcXVlc3QiLCJjb21wYWN0U3lzdGVtSW5zdHJ1Y3Rpb25zIiwiY29udmVyc2F0aW9uV2l0aFN5c3RlbSIsInRvcF9wIiwiZnJlcXVlbmN5X3BlbmFsdHkiLCJwcmVzZW5jZV9wZW5hbHR5IiwicmVzcG9uc2VDb250ZW50IiwicHJvbXB0X3Rva2VucyIsImNvbXBsZXRpb25fdG9rZW5zIiwidG90YWxfdG9rZW5zIiwiZWxlbWVudERhdGFNYXRjaCIsImNsZWFuZWRSZXNwb25zZSIsInJlcGxhY2UiLCJ0cmltIiwiZWxlbWVudERhdGEiLCJwYXJzZSIsImVsZW1lbnQiLCJ3YXJuIiwidXJsIiwiTnVtYmVyIiwicmVhc29uaW5nIiwiZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/api/ai/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/whatwg-url","vendor-chunks/event-target-shim","vendor-chunks/agentkeepalive","vendor-chunks/form-data-encoder","vendor-chunks/webidl-conversions","vendor-chunks/abort-controller","vendor-chunks/ms","vendor-chunks/humanize-ms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fai%2Froute&page=%2Fapi%2Fai%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fai%2Froute.ts&appDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cdavid%5CDesktop%5Cai-video-agent%5Creact-video-editor&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();